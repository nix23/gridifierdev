/*! gridifier 2015-02-23 */
var SizesResolver={getComputedCSS:null,propertiesToGet:{forOuterWidth:["paddingLeft","paddingRight","marginLeft","marginRight","borderLeftWidth","borderRightWidth"],forOuterHeight:["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],forPositionLeft:["marginLeft"],forPositionTop:["marginTop"]},maybePrefixedProperties:{boxSizing:null},borderBoxSizingStrategy:null,borderBoxSizingStrategies:{OUTER:0,INNER:1},percentageCSSValuesCalcStrategy:null,percentageCSSValuesCalcStrategies:{BROWSER_NATIVE:0,RECALCULATE:1},recalculatePercentageWidthFunction:function(a,b,c,d){return this.outerWidth(a,b,c,d)},recalculatePercentageHeightFunction:function(a,b,c,d){return this.outerHeight(a,b,c,d)},lastRecalculatedDOMElRawWidth:null,lastRecalculatedDOMElRawHeight:null,lastRecalculatedDOMElBorderWidth:null,lastRecalculatedDOMElBorderHeight:null,hasLastRecalculatedDOMElBorderBoxBS:false,init:function(){this.getComputedCSS=this.getComputedCSSFunction();this.determineMaybePrefixedProperties();this.determineBorderBoxComputedSizesCalculationStrategy();this.determinePercentageCSSValuesCalcStrategy()},clearRecursiveSubcallsData:function(){this.lastRecalculatedDOMElRawWidth=null;this.lastRecalculatedDOMElRawHeight=null;this.lastRecalculatedDOMElBorderWidth=null;this.lastRecalculatedDOMElBorderHeight=null;this.hasLastRecalculatedDOMElBorderBoxBS=false},isBrowserNativePercentageCSSValuesCalcStrategy:function(){return this.percentageCSSValuesCalcStrategy==this.percentageCSSValuesCalcStrategies.BROWSER_NATIVE},isRecalculatePercentageCSSValuesCalcStrategy:function(){return this.percentageCSSValuesCalcStrategy==this.percentageCSSValuesCalcStrategies.RECALCULATE},_isPercentageCSSValue:function(a){var b=new RegExp("(.*\\d)%$");if(b.test(a))return true;return false},getComputedCSSWithMaybePercentageSizes:function(a){return this._getComputedCSSWithMaybePercentageSizes(a)},_getComputedCSSWithMaybePercentageSizes:function(a){var b=a.parentNode.cloneNode();var c=a.cloneNode();b.appendChild(c);b.style.display="none";if(a.parentNode.nodeName=="HTML")var d=a.parentNode;else var d=a.parentNode.parentNode;d.appendChild(b);var e=this.getComputedCSS(c);var f={};var g=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","width","height"];for(var h=0;h<g.length;h++){f[g[h]]=e[g[h]]}d.removeChild(b);return f},_ensureHasParentNode:function(a){if(a.parentNode==null||!Dom.hasDOMElemOwnProperty(a.parentNode,"innerHTML")){var b="";b+="SizesResolver error: ";b+="Can't resolve element parentNode per element: ";b+=a;throw new Error(b)}},_ensureComputedCSSHasProperty:function(a,b){if(!(b in a)){var c="";c+="SizesResolver error: ";c+="Can't find property '"+b+"' in elementComputedCSS. ";c+="Element computed CSS: ";c+=a;throw new Error(c)}},hasPercentageCSSValue:function(a,b,c){this._ensureHasParentNode(b);var c=c||this._getComputedCSSWithMaybePercentageSizes(b);this._ensureComputedCSSHasProperty(c,a);return this._isPercentageCSSValue(c[a])},getPercentageCSSValue:function(a,b,c){this._ensureHasParentNode(b);var c=c||this._getComputedCSSWithMaybePercentageSizes(b);this._ensureComputedCSSHasProperty(c,a);return c[a]},_recalculateTwoSidePropertyWithPercentageValues:function(a,b,c,d,e,f){if(f=="horizontal"){var g="Left";var h="Right"}else if(f=="vertical"){var g="Top";var h="Bottom"}else{throw new Error("SizesResolver error: wrong direction in twoSideProperty recalculation.")}if(e!="margin"&&e!="padding"){throw new Error("SizesResolver error: unknown CSSProperty in twoSideProperty recalculation.")}var i=e+g;var j=e+h;var k=c[i];var l=c[j];if(this.hasPercentageCSSValue(i,a,d)){var m=parseFloat(this.getPercentageCSSValue(i,a,d));k=b/100*m}if(this.hasPercentageCSSValue(j,a,d)){var n=parseFloat(this.getPercentageCSSValue(j,a,d));l=b/100*n}return k+l},_recalculateWidthWithPercentageValue:function(a,b,c){var d=parseFloat(this.getPercentageCSSValue("width",a,c));return b/100*d},_recalculateHeightWithPercentageValue:function(a,b,c){var d=parseFloat(this.getPercentageCSSValue("height",a,c));return b/100*d},positionLeft:function(a){var b=this.getComputedCSS(a);if(b.display=="none")return 0;var c=this.getComputedProperties("forPositionLeft",b,a);return a.offsetLeft-Math.round(c.marginLeft)},positionTop:function(a){var b=this.getComputedCSS(a);if(b.display=="none")return 0;var c=this.getComputedProperties("forPositionTop",b,a);return a.offsetTop-Math.round(c.marginTop)},offsetLeft:function(a){var b=a.getBoundingClientRect();var c=window.pageXOffset||document.documentElement.scrollLeft;return b.left+c},offsetTop:function(a){var b=a.getBoundingClientRect();var c=window.pageYOffset||document.documentElement.scrollTop;return b.top+c},getComputedProperty:function(a,b){var c=this.getComputedCSS(a);return c[b]},isBoxSizingBorderBox:function(a){var b=this.maybePrefixedProperties.boxSizing;if(b&&a[b]&&a[b]==="border-box")return true;return false},isOuterBorderBoxSizing:function(){return this.borderBoxSizingStrategy===this.borderBoxSizingStrategies.OUTER?true:false},isCascadedCSSValue:function(a){return window.getComputedStyle||a.indexOf("px")!==-1?false:true},transformFromCascadedToComputedStyle:function(a,b,c){var d=new RegExp("(?=.*\\d)");if(!d.test(b))return b;var e=a.style;var f=a.runtimeStyle;var g=e.left;var h=f&&f.left;if(h)f.left=c.left;e.left=b;b=e.pixelLeft;e.left=g;if(h)f.left=h;return b},normalizeComputedCSSSizeValue:function(a){var b=parseFloat(a);var c=a.indexOf("%")===-1&&!isNaN(b);return c?b:false},getComputedProperties:function(a,b,c){var d={};for(var e=0;e<this.propertiesToGet[a].length;e++){var f=this.propertiesToGet[a][e];var g=b[f];if(this.isCascadedCSSValue(g))g=this.transformFromCascadedToComputedStyle(c,g,b);g=parseFloat(g);g=isNaN(g)?0:g;d[f]=g}return d}};SizesResolver.getComputedCSSFunction=function(){if(window.getComputedStyle){return function(a){return window.getComputedStyle(a,null)}}else{return function(a){return a.currentStyle}}};SizesResolver.determineMaybePrefixedProperties=function(){this.maybePrefixedProperties.boxSizing=Prefixer.get("boxSizing")};SizesResolver.determineBorderBoxComputedSizesCalculationStrategy=function(){var a=document.createElement("div");a.style.width="100px";a.style.padding="10px 20px";a.style.borderWidth="10px 20px";a.style.borderStyle="solid";var b=this.maybePrefixedProperties.boxSizing;a.style[b]="border-box";var c=document.body||document.documentElement;c.appendChild(a);var d=this.getComputedCSS(a);if(this.normalizeComputedCSSSizeValue(d.width)===100)this.borderBoxSizingStrategy=this.borderBoxSizingStrategies.OUTER;else this.borderBoxSizingStrategy=this.borderBoxSizingStrategies.INNER;c.removeChild(a)};SizesResolver.determinePercentageCSSValuesCalcStrategy=function(){var a=document.createElement("div");a.style.width="1178px";a.style.height="300px";a.style.position="absolute";a.style.left="-9000px";a.style.top="0px";a.style.visibility="hidden";var b=document.body||document.documentElement;b.appendChild(a);var c=document.createElement("div");c.style.width="10%";c.style.height="200px";a.appendChild(c);var d=117.796875;var e=parseFloat(this.outerWidth(c,true));if(d.toFixed(1)==e.toFixed(1))this.percentageCSSValuesCalcStrategy=this.percentageCSSValuesCalcStrategies.BROWSER_NATIVE;else this.percentageCSSValuesCalcStrategy=this.percentageCSSValuesCalcStrategies.RECALCULATE;b.removeChild(a)};SizesResolver.outerWidth=function(a,b,c,d){var b=b||false;var c=c||false;var d=d||false;var e=this.getComputedCSS(a);if(c)var f=false;else if(this.isBrowserNativePercentageCSSValuesCalcStrategy())var f=false;else if(this.isRecalculatePercentageCSSValuesCalcStrategy()){this._ensureHasParentNode(a);if(this.hasPercentageCSSValue("width",a))var f=true;else var f=false}if(e.display==="none")return 0;var g=this.getComputedProperties("forOuterWidth",e,a);var h=g.paddingLeft+g.paddingRight;var i=g.marginLeft+g.marginRight;var j=g.borderLeftWidth+g.borderRightWidth;var k=0;var l=this.normalizeComputedCSSSizeValue(e.width);if(l!==false)k=l;var m=null;var n=null;if(f){m=this._getComputedCSSWithMaybePercentageSizes(a);if(a.parentNode.nodeName=="HTML")var o=true;else var o=false;n=this.recalculatePercentageWidthFunction.call(this,a.parentNode,false,o,true);if(this.hasLastRecalculatedDOMElBorderBoxBS&&this.hasPercentageCSSValue("width",a,m)){n-=this.lastRecalculatedDOMElBorderWidth}}if(f&&(this.hasPercentageCSSValue("paddingLeft",a,m)||this.hasPercentageCSSValue("paddingRight",a,m))){h=this._recalculateTwoSidePropertyWithPercentageValues(a,n,g,m,"padding","horizontal")}if(f&&this.hasPercentageCSSValue("width",a,m)){k=this._recalculateWidthWithPercentageValue(a,n,m)}if(!this.isBoxSizingBorderBox(e)||this.isBoxSizingBorderBox(e)&&!this.isOuterBorderBoxSizing()){this.lastRecalculatedDOMElRawWidth=k;k+=h;if(!d)k+=j;this.hasLastRecalculatedDOMElBorderBoxBS=false}else{this.hasLastRecalculatedDOMElBorderBoxBS=true;this.lastRecalculatedDOMElRawWidth=k;this.lastRecalculatedDOMElBorderWidth=j}if(b){if(f&&(this.hasPercentageCSSValue("marginLeft",a,m)||this.hasPercentageCSSValue("marginRight",a,m))){i=this._recalculateTwoSidePropertyWithPercentageValues(a,n,g,m,"margin","horizontal")}k+=i}return k};SizesResolver.outerHeight=function(a,b,c,d){var b=b||false;var c=c||false;var d=d||false;var e=this.getComputedCSS(a);if(c)var f=false;else if(this.isBrowserNativePercentageCSSValuesCalcStrategy())var f=false;else if(this.isRecalculatePercentageCSSValuesCalcStrategy()){this._ensureHasParentNode(a);if(this.hasPercentageCSSValue("height",a))var f=true;else var f=false}if(e.display==="none")return 0;var g=this.getComputedProperties("forOuterHeight",e,a);var h=g.paddingTop+g.paddingBottom;var i=g.marginTop+g.marginBottom;var j=g.borderTopWidth+g.borderBottomWidth;var k=0;var l=this.normalizeComputedCSSSizeValue(e.height);if(l!==false)k=l;var m=null;var n=null;var o=null;if(f){m=this._getComputedCSSWithMaybePercentageSizes(a);if(a.parentNode.nodeName=="HTML")var p=true;else var p=false;n=this.recalculatePercentageWidthFunction.call(this,a.parentNode,false,p,true);if(this.hasLastRecalculatedDOMElBorderBoxBS){n-=this.lastRecalculatedDOMElBorderWidth}o=this.recalculatePercentageHeightFunction.call(this,a.parentNode,false,p,true);if(this.hasLastRecalculatedDOMElBorderBoxBS&&this.hasPercentageCSSValue("height",a,m)){o-=this.lastRecalculatedDOMElBorderHeight}}if(f&&(this.hasPercentageCSSValue("paddingTop",a,m)||this.hasPercentageCSSValue("paddingBottom",a,m))){h=this._recalculateTwoSidePropertyWithPercentageValues(a,n,g,m,"padding","vertical")}if(f&&this.hasPercentageCSSValue("height",a,m)){k=this._recalculateHeightWithPercentageValue(a,o,m)}if(!this.isBoxSizingBorderBox(e)||this.isBoxSizingBorderBox(e)&&!this.isOuterBorderBoxSizing()){this.lastRecalculatedDOMElRawHeight=k;k+=h;if(!d)k+=j;this.hasLastRecalculatedDOMElBorderBoxBS=false}else{this.hasLastRecalculatedDOMElBorderBoxBS=true;this.lastRecalculatedDOMElRawHeight=k;this.lastRecalculatedDOMElBorderHeight=j}if(b){if(f&&(this.hasPercentageCSSValue("marginTop",a,m)||this.hasPercentageCSSValue("marginBottom",a,m))){i=this._recalculateTwoSidePropertyWithPercentageValues(a,n,g,m,"margin","vertical")}k+=i}return k};var Event=function(){var a=0;function b(a){a=a||window.event;if(a.isFixed){return a}a.isFixed=true;a.preventDefault=a.preventDefault||function(){this.returnValue=false};a.stopPropagation=a.stopPropagation||function(){this.cancelBubble=true};if(!a.target){a.target=a.srcElement}if(!a.relatedTarget&&a.fromElement){a.relatedTarget=a.fromElement==a.target?a.toElement:a.fromElement}if(a.pageX==null&&a.clientX!=null){var b=document.documentElement,c=document.body;a.pageX=a.clientX+(b&&b.scrollLeft||c&&c.scrollLeft||0)-(b.clientLeft||0);a.pageY=a.clientY+(b&&b.scrollTop||c&&c.scrollTop||0)-(b.clientTop||0)}if(!a.which&&a.button){a.which=a.button&1?1:a.button&2?3:a.button&4?2:0}return a}function c(a){a=b(a);var c=this.events[a.type];for(var d in c){var e=c[d].call(this,a);if(e===false){a.preventDefault();a.stopPropagation()}else if(e!==undefined){a.result=e}if(a.stopNow)break}}return{add:function(b,d,e){if(b.setInterval&&(b!=window&&!b.frameElement)){b=window}if(!e.guid){e.guid=++a}if(!b.events){b.events={};b.handle=function(a){if(typeof Event!=="undefined"){return c.call(b,a)}}}if(!b.events[d]){b.events[d]={};if(b.addEventListener)b.addEventListener(d,b.handle,false);else if(b.attachEvent)b.attachEvent("on"+d,b.handle)}b.events[d][e.guid]=e},remove:function(a,b,c){var d=a.events&&a.events[b];if(!d)return;if(!c){for(var e in d){delete a.events[b][e]}return}else{delete d[c.guid];for(var f in d)return}if(a.removeEventListener)a.removeEventListener(b,a.handle,false);else if(a.detachEvent)a.detachEvent("on"+b,a.handle);delete a.events[b];for(var f in a.events)return;try{delete a.handle;delete a.events}catch(g){a.removeAttribute("handle");a.removeAttribute("events")}}}}();var Prefixer={prefixes:["Moz","Webkit","ms","Ms","Khtml","O"],init:function(){},get:function(a,b){b=b||document.documentElement;var c=b.style;if(typeof c[a]==="string"){return a}var a=a.charAt(0).toUpperCase()+a.slice(1);for(var d=0;d<this.prefixes.length;d++){var e=this.prefixes[d]+a;if(typeof c[e]==="string")return e}},getForCSS:function(a,b){b=b||document.documentElement;var c=b.style;if(typeof c[a]==="string"){return a}var d=a;var a=a.charAt(0).toUpperCase()+a.slice(1);for(var e=0;e<this.prefixes.length;e++){var f=this.prefixes[e]+a;if(typeof c[f]==="string")return"-"+this.prefixes[e].toLowerCase()+"-"+d}}};var Dom={hasDOMElemOwnPropertyFunction:null,init:function(){this.createTrimFunction();this.createHasDOMElemOwnPropertyFunction()},createTrimFunction:function(){if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}},createHasDOMElemOwnPropertyFunction:function(){var a=document.createElement("div");var b=document.body||document.documentElement;b.appendChild(a);if(Object.prototype.hasOwnProperty.call(a,"innerHTML")){this.hasDOMElemOwnPropertyFunction=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)}}else{this.hasDOMElemOwnPropertyFunction=function(a,b){for(var c in a){if(c==b)return true}return false}}b.removeChild(a)},toInt:function(a){return parseInt(a,10)},isJqueryObject:function(a){if(typeof jQuery=="undefined")return false;return a&&a instanceof jQuery},isNativeDOMObject:function(a){if(typeof a!="undefined"&&typeof a.tagName!="undefined"&&typeof a.nodeName!="undefined"&&typeof a.ownerDocument!="undefined"&&typeof a.removeAttribute!="undefined")return true;else return false},isArray:function(a){return Object.prototype.toString.call(a)=="[object Array]"},isChildOf:function(a,b){var c=a.parentNode;while(c!=undefined){if(c==b)return true;if(c==document.body)break;c=c.parentNode}return false},hasAttribute:function(a,b){if(a.getAttribute(b)===null||a.getAttribute(b)==="")return false;return true},isBrowserSupportingTransitions:function(){var a=document.createElement("div");var b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b){if(a.style[c]!==undefined)return true}return false},hasDOMElemOwnProperty:function(a,b){return this.hasDOMElemOwnPropertyFunction(a,b)},css:{set:function(a,b){if(!Dom.isNativeDOMObject(a))throw new Error("Dom abstraction layer error: DOMElem must be a scalar value.");for(var c in b)a.style[c]=b[c]},hasClass:function(a,b){var c=a.getAttribute("class");if(c==null||c.length==0)return false;var d=c.split(" ");for(var e=0;e<d.length;e++){d[e]=d[e].trim();if(d[e]==b)return true}return false},addClass:function(a,b){var c=a.getAttribute("class");if(c==null||c.length==0)var d=b;else var d=c+" "+b;a.setAttribute("class",d)},removeClass:function(a,b){var c=a.getAttribute("class").split(" ");var d="";for(var e=0;e<c.length;e++){if(c[e].trim()!=b)d+=c[e]+" "}d=d.substring(0,d.length-1);a.setAttribute("class",d)}},css3:{prefixedTransitionProps:["WebkitTransition","MozTransition","MsTransition","OTransition","transition"],prefixedTransformProps:["WebkitTransform","MozTransform","OTransform","MsTransform","transform"],prefixedPerspectiveProps:["WebkitPerspective","perspective","MozPerspective"],prefixedTransformStyleProps:["transformStyle","WebkitTransformStyle","MozTransformStyle"],prefixedBackfaceVisibilityProps:["WebkitBackfaceVisibility","MozBackfaceVisibility","backfaceVisibility"],transition:function(a,b){a.style[Prefixer.get("transition",a)]=b},transitionProperty:function(a,b){var c=a.style[Prefixer.get("transition",a)];if(c.length==0){a.style[Prefixer.get("transition",a)]=b;return}var d=b;var e=c.split(",");for(var f=0;f<e.length;f++){var g=e[f].trim();if(g.length==0)continue;var h=g.split(" ");var i=h[0];if(d.search(i)===-1){d+=", "+g}}a.style[Prefixer.get("transition",a)]=d.trim()},transform:function(a,b){a.style[Prefixer.get("transform",a)]=b},transformProperty:function(a,b,c){var d=a.style[Prefixer.get("transform",a)];if(d.length==0){a.style[Prefixer.get("transform",a)]=b+"("+c+")";return}var e="";var f=d.split(/\)/);var g=false;for(var h=0;h<f.length;h++){var i=f[h].trim();if(i.trim().length==0)continue;if(i.search(b)!==-1){e+=" "+b+"("+c+")";g=true}else{e+=" "+i+")"}}if(!g)e+=" "+b+"("+c+")";a.style[Prefixer.get("transform",a)]=e.trim()},opacity:function(a,b){var c=["-webkit-opacity","-moz-opacity","opacity"];for(var d=0;d<c.length;d++)a.style[c[d]]=b},perspective:function(a,b){for(var c=0;c<this.prefixedPerspectiveProps.length;c++)a.style[this.prefixedPerspectiveProps[c]]=b},transformStyle:function(a,b){for(var c=0;c<this.prefixedTransformStyleProps.length;c++)a.style[this.prefixedTransformStyleProps[c]]=b},backfaceVisibility:function(a,b){for(var c=0;c<this.prefixedBackfaceVisibilityProps.length;c++)a.style[this.prefixedBackfaceVisibilityProps[c]]=b}},get:{byId:function(a){return document.getElementById(a)},byClass:function(a,b){return a.querySelectorAll("."+b)},byQuery:function(a,b){return a.querySelectorAll(b)}},remove:{byQuery:function(a,b){var c=Dom.get.byQuery(a,b);for(var d=0;d<c.length;d++){var e=c[d];e.parentNode.removeChild(e)}}}};Dom.init();SizesResolver.init();Gridifier=function(a,b){var c=this;this._grid=null;this._gridSizesUpdater=null;this._settings=null;this._collector=null;this._guid=null;this._eventEmitter=null;this._operation=null;this._resorter=null;this._filtrator=null;this._disconnector=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectionsSorter=null;this._renderer=null;this._sizesTransformer=null;this._normalizer=null;this._prepender=null;this._reversedPrepender=null;this._appender=null;this._reversedAppender=null;this._operationsQueue=null;this._toggleOperation=null;this._transformOperation=null;this._css={};this._construct=function(){c._sizesResolverManager=new Gridifier.SizesResolverManager;c._grid=new Gridifier.Grid(a,c._sizesResolverManager);c._eventEmitter=new Gridifier.EventEmitter(c);c._settings=new Gridifier.Settings(b,c._eventEmitter,c._sizesResolverManager);c._collector=new Gridifier.Collector(c._settings,c.getGrid(),c._sizesResolverManager);c._guid=new Gridifier.GUID;c._normalizer=new Gridifier.Normalizer(c,c._sizesResolverManager);c._operation=new Gridifier.Operation;c._grid.setCollectorInstance(c._collector);if(c._settings.isVerticalGrid()){c._connections=new Gridifier.VerticalGrid.Connections(c,c._guid,c._settings,c._sizesResolverManager);c._connectionsSorter=new Gridifier.VerticalGrid.ConnectionsSorter(c._connections,c._settings,c._guid)}else if(c._settings.isHorizontalGrid()){c._connections=new Gridifier.HorizontalGrid.Connections(c,c._guid,c._settings,c._sizesResolverManager);c._connectionsSorter=new Gridifier.HorizontalGrid.ConnectionsSorter(c._connections,c._settings,c._guid)}c._gridSizesUpdater=new Gridifier.GridSizesUpdater(c._grid,c._connections,c._settings,c._eventEmitter);c._connectors=new Gridifier.Connectors(c._guid,c._connections);c._renderer=new Gridifier.Renderer(c,c._connections,c._settings,c._normalizer);if(c._settings.isVerticalGrid()){c._prepender=new Gridifier.VerticalGrid.Prepender(c,c._settings,c._sizesResolverManager,c._connectors,c._connections,c._guid,c._renderer,c._normalizer,c._operation);c._reversedPrepender=new Gridifier.VerticalGrid.ReversedPrepender(c,c._settings,c._sizesResolverManager,c._connectors,c._connections,c._guid,c._renderer,c._normalizer,c._operation);c._appender=new Gridifier.VerticalGrid.Appender(c,c._settings,c._sizesResolverManager,c._connectors,c._connections,c._guid,c._renderer,c._normalizer,c._operation);c._reversedAppender=new Gridifier.VerticalGrid.ReversedAppender(c,c._settings,c._sizesResolverManager,c._connectors,c._connections,c._guid,c._renderer,c._normalizer,c._operation)}else if(c._settings.isHorizontalGrid()){c._prepender=new Gridifier.HorizontalGrid.Prepender(c,c._settings,c._sizesResolverManager,c._connectors,c._connections,c._guid,c._renderer,c._normalizer,c._operation);c._reversedPrepender=new Gridifier.HorizontalGrid.ReversedPrepender(c,c._settings,c._sizesResolverManager,c._connectors,c._connections,c._guid,c._renderer,c._normalizer,c._operation);c._appender=new Gridifier.HorizontalGrid.Appender(c,c._settings,c._sizesResolverManager,c._connectors,c._connections,c._guid,c._renderer,c._normalizer,c._operation);c._reversedAppender=new Gridifier.HorizontalGrid.ReversedAppender(c,c._settings,c._sizesResolverManager,c._connectors,c._connections,c._guid,c._renderer,c._normalizer,c._operation)}c._resorter=new Gridifier.Resorter(c,c._collector,c._connections,c._settings,c._guid);c._disconnector=new Gridifier.Disconnector(c,c._collector,c._connections,c._connectors,c._settings,c._guid,c._appender,c._reversedAppender);c._filtrator=new Gridifier.Filtrator(c,c._collector,c._connections,c._settings,c._guid,c._disconnector);c._sizesTransformer=new Gridifier.SizesTransformer.Core(c,c._settings,c._connectors,c._connections,c._connectionsSorter,c._guid,c._appender,c._reversedAppender,c._normalizer,c._operation,c._sizesResolverManager);c._connections.setSizesTransformerInstance(c._sizesTransformer);c._toggleOperation=new Gridifier.TransformerOperations.Toggle(c._collector,c._connections,c._guid,c._sizesTransformer,c._sizesResolverManager);c._transformOperation=new Gridifier.TransformerOperations.Transform(c._collector,c._connections,c._guid,c._sizesTransformer,c._sizesResolverManager);c._operationsQueue=new Gridifier.Operations.Queue(c._gridSizesUpdater,c._collector,c._connections,c._connectionsSorter,c._guid,c._settings,c._prepender,c._reversedPrepender,c._appender,c._reversedAppender,c._sizesTransformer,c._sizesResolverManager);var d=new Gridifier.Dragifier(c,c._appender,c._reversedAppender,c._connections,c._connectors,c._guid,c._settings,c._sizesResolverManager);c._bindEvents()};this._bindEvents=function(){var a=null;Event.add(window,"resize",function(){c.triggerResize()})};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.prototype.addToGrid=function(a){this._grid.addToGrid(a);return this};Gridifier.prototype.getGridX2=function(){return this._grid.getGridX2()};Gridifier.prototype.getGridY2=function(){return this._grid.getGridY2()};Gridifier.prototype.getGrid=function(){return this._grid.getGrid()};Gridifier.prototype.getRenderer=function(){return this._renderer};Gridifier.prototype.markAsGridItem=function(a){this._grid.markAsGridItem(a);return this};Gridifier.prototype.scheduleGridSizesUpdate=function(){this._gridSizesUpdater.scheduleGridSizesUpdate()};Gridifier.prototype.triggerResize=function(){this._sizesResolverManager.startCachingTransaction();this.retransformAllSizes();this._sizesResolverManager.stopCachingTransaction()};Gridifier.prototype.watch=function(){};Gridifier.prototype.toggleBy=function(a){this._settings.setToggle(a);return this};Gridifier.prototype.sortBy=function(a){this._settings.setSort(a);return this};Gridifier.prototype.filterBy=function(a){this._sizesTransformer.stopRetransformAllConnectionsQueue();this._settings.setFilter(a);this._filtrator.filter();this.retransformAllSizes();return this};Gridifier.prototype.resort=function(){this._sizesTransformer.stopRetransformAllConnectionsQueue();this._resorter.resort();this.retransformAllSizes();return this};Gridifier.prototype.collect=function(){};Gridifier.prototype.disconnect=function(a){this._sizesTransformer.stopRetransformAllConnectionsQueue();this._disconnector.disconnect(a);this.retransformAllSizes();return this};Gridifier.prototype.setCoordsChanger=function(a){this._settings.setCoordsChanger(a);return this};Gridifier.prototype.setSizesChanger=function(a){this._settings.setSizesChanger(a);return this};Gridifier.prototype.setItemWidthPercentageAntialias=function(a){this._normalizer.setItemWidthAntialiasPercentageValue(a)};Gridifier.prototype.setItemHeightPercentageAntialias=function(a){this._normalizer.setItemHeightAntialiasPercentageValue(a)};Gridifier.prototype.prepend=function(a,b,c){if(this._settings.isMirroredPrepend()){this.insertBefore(a,null,b,c);return this}this._operationsQueue.schedulePrependOperation(a,b,c);return this};Gridifier.prototype.append=function(a,b,c){this._operationsQueue.scheduleAppendOperation(a,b,c);return this};Gridifier.prototype.insertBefore=function(a,b,c,d){this._operationsQueue.scheduleInsertBeforeOperation(a,b,c,d);return this};Gridifier.prototype.insertAfter=function(a,b,c,d){this._operationsQueue.scheduleInsertAfterOperation(a,b,c,d);return this};Gridifier.prototype.retransformAllSizes=function(){this._normalizer.updateItemAntialiasValues();this._transformOperation.executeRetransformAllSizes()};Gridifier.prototype.toggleSizes=function(a,b,c){this._normalizer.updateItemAntialiasValues();this._toggleOperation.execute(a,b,c)};Gridifier.prototype.transformSizes=function(a,b,c){this._normalizer.updateItemAntialiasValues();this._transformOperation.execute(a,b,c)};Gridifier.Api={};Gridifier.HorizontalGrid={};Gridifier.VerticalGrid={};Gridifier.Operations={};Gridifier.TransformerOperations={};Gridifier.SizesTransformer={};Gridifier.GRID_TYPES={VERTICAL_GRID:"verticalGrid",HORIZONTAL_GRID:"horizontalGrid"};Gridifier.PREPEND_TYPES={MIRRORED_PREPEND:"mirroredPrepend",DEFAULT_PREPEND:"defaultPrepend",REVERSED_PREPEND:"reversedPrepend"};Gridifier.APPEND_TYPES={DEFAULT_APPEND:"defaultAppend",REVERSED_APPEND:"reversedAppend"};Gridifier.INTERSECTION_STRATEGIES={DEFAULT:"default",NO_INTERSECTIONS:"noIntersections"};Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES={FOR_VERTICAL_GRID:{TOP:"top",CENTER:"center",BOTTOM:"bottom"},FOR_HORIZONTAL_GRID:{LEFT:"left",CENTER:"center",RIGHT:"right"}};Gridifier.SORT_DISPERSION_MODES={DISABLED:"disabled",CUSTOM:"custom",CUSTOM_ALL_EMPTY_SPACE:"customAllEmptySpace"};Gridifier.GRID_ITEM_MARKING_STRATEGIES={BY_CLASS:"class",BY_DATA_ATTR:"data"};Gridifier.GRID_ITEM_MARKING_DEFAULTS={CLASS:"gridifier-item",DATA_ATTR:"data-gridifier-item"};Gridifier.OPERATIONS={PREPEND:0,REVERSED_PREPEND:1,APPEND:2,REVERSED_APPEND:3,MIRRORED_PREPEND:4};Gridifier.Api.CoordsChanger=function(a,b){var c=this;this._settings=null;this._eventEmitter=null;this._coordsChangerFunction=null;this._coordsChangerFunctions={};this._css={};this._construct=function(){c._settings=a;c._eventEmitter=b;c._coordsChangerFunctions={};c._addDefaultCoordsChanger();c._addSimultaneousCSS3TransitionCoordsChanger()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Api.CoordsChanger.prototype.setCoordsChangerFunction=function(a){if(!this._coordsChangerFunctions.hasOwnProperty(a)){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.SET_COORDS_CHANGER_INVALID_PARAM,a);return}this._coordsChangerFunction=this._coordsChangerFunctions[a]};Gridifier.Api.CoordsChanger.prototype.addCoordsChangerFunction=function(a,b){this._coordsChangerFunctions[a]=b};Gridifier.Api.CoordsChanger.prototype.getCoordsChangerFunction=function(){return this._coordsChangerFunction};Gridifier.Api.CoordsChanger.prototype._addDefaultCoordsChanger=function(){this._coordsChangerFunctions["default"]=function(a,b,c){Dom.css.set(a,{left:b,top:c})}};Gridifier.Api.CoordsChanger.prototype._addSimultaneousCSS3TransitionCoordsChanger=function(){this._coordsChangerFunctions.simultaneousCSS3Transition=function(a,b,c){var b=parseFloat(b);var c=parseFloat(c);var d=parseFloat(a.style.left);var e=parseFloat(a.style.top);if(b>d)var f=b-d;else if(b<d)var f=(d-b)*-1;else var f=0;if(c>e)var g=c-e;else if(c<e)var g=(e-c)*-1;else var g=0;Dom.css3.transitionProperty(a,Prefixer.getForCSS("transform",a)+" 500ms ease");Dom.css3.perspective(a,"1000");Dom.css3.backfaceVisibility(a,"hidden");Dom.css3.transformProperty(a,"translate3d",f+"px,"+g+"px,0px")}};Gridifier.Api.Filter=function(a,b){var c=this;this._settings=null;this._eventEmitter=null;this._filterFunction=null;this._filterFunctions={};this._css={};this._construct=function(){c._settings=a;c._eventEmitter=b;c._filterFunctions={};c._addAllFilter()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Api.Filter.prototype.setFilterFunction=function(a){if(!this._filterFunctions.hasOwnProperty(a)){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.SET_FILTER_INVALID_PARAM,a);return}this._filterFunction=this._filterFunctions[a]};Gridifier.Api.Filter.prototype.addFilterFunction=function(a,b){this._filterFunctions[a]=b};Gridifier.Api.Filter.prototype.getFilterFunction=function(){return this._filterFunction};Gridifier.Api.Filter.prototype._addAllFilter=function(){this._filterFunctions.all=function(a){return true}};Gridifier.Api.Rotate=function(a,b,c){var d=this;this._settings=null;this._eventEmitter=null;this._sizesResolverManager=null;this._css={};this._construct=function(){d._settings=a;d._eventEmitter=b;d._sizesResolverManager=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.Api.Rotate.prototype.show=function(a,b,c){var d=c?"rotateY":"rotateX";this._rotate(a,b,d,false)};Gridifier.Api.Rotate.prototype.hide=function(a,b,c){var d=c?"rotateY":"rotateX";this._rotate(a,b,d,true)};Gridifier.Api.Rotate.prototype._rotate=function(a,b,c,d){if(!d){var e=true;var f=false}else{var e=false;var f=true}var g=this._createScene(a,b);var h=this._createFrames(g);var i=this._createItemClone(a);var j=this._createFrontFrame(h,c);var k=this._createBackFrame(h,c);if(e){k.appendChild(i)}else if(f){j.appendChild(i);a.style.visibility="hidden"}var l=this._settings.getAnimationMsDuration();Dom.css3.transitionProperty(j,Prefixer.getForCSS("transform",j)+" "+l+"ms ease");Dom.css3.transitionProperty(k,Prefixer.getForCSS("transform",k)+" "+l+"ms ease");setTimeout(function(){Dom.css3.transformProperty(k,c,"0deg");Dom.css3.transformProperty(j,c,"180deg")},20);setTimeout(function(){g.parentNode.removeChild(g);if(e)a.style.visibility="visible"},this._settings.getAnimationMsDuration()+1)};Gridifier.Api.Rotate.prototype._createScene=function(a,b){var c=document.createElement("div");Dom.css.set(c,{width:this.sizesResolverManager.outerWidth(a,true)+"px",height:this.sizesResolverManager.outerHeight(a,true)+"px",position:"absolute",top:this.sizesResolverManager.positionTop(a)+"px",left:this.sizesResolverManager.positionLeft(a)+"px"});Dom.css3.perspective(c,"200px");b.appendChild(c);return c};Gridifier.Api.Rotate.prototype._createFrames=function(a){var b=document.createElement("div");Dom.css.set(b,{width:"100%",height:"100%",position:"absolute"});Dom.css3.transformStyle(b,"preserve-3d");Dom.css3.perspective(b,"200px");a.appendChild(b);return b};Gridifier.Api.Rotate.prototype._createItemClone=function(a){var b=a.cloneNode(true);Dom.css.set(b,{left:"0px",top:"0px",visibility:"visible",width:this.sizesResolverManager.outerWidth(a,true)+"px",height:this.sizesResolverManager.outerHeight(a,true)+"px"});return b};Gridifier.Api.Rotate.prototype._addFrameCss=function(a){Dom.css.set(a,{display:"block",position:"absolute",width:"100%",height:"100%"});
Dom.css3.backfaceVisibility(a,"hidden")};Gridifier.Api.Rotate.prototype._createFrontFrame=function(a,b){var c=document.createElement("div");this._addFrameCss(c);a.appendChild(c);Dom.css.set(c,{zIndex:2});Dom.css3.transitionProperty(c,Prefixer.getForCSS("transform",c)+" 0ms ease");Dom.css3.transformProperty(c,b,"0deg");return c};Gridifier.Api.Rotate.prototype._createBackFrame=function(a,b){var c=document.createElement("div");this._addFrameCss(c);a.appendChild(c);Dom.css3.transitionProperty(c,Prefixer.getForCSS("transform",c)+" 0ms ease");Dom.css3.transformProperty(c,b,"-180deg");return c};Gridifier.Api.SizesChanger=function(a,b){var c=this;this._settings=null;this._eventEmitter=null;this._sizesChangerFunction=null;this._sizesChangerFunctions={};this._css={};this._construct=function(){c._settings=a;c._eventEmitter=b;c._sizesChangerFunctions={};c._addDefaultSizesChanger();c._addSimultaneousCSS3TransitionSizesChanger()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Api.SizesChanger.prototype.setSizesChangerFunction=function(a){if(!this._sizesChangerFunctions.hasOwnProperty(a)){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.SET_SIZES_CHANGER_INVALID_PARAM,a);return}this._sizesChangerFunction=this._sizesChangerFunctions[a]};Gridifier.Api.SizesChanger.prototype.addSizesChangerFunction=function(a,b){this._sizesChangerFunctions[a]=b};Gridifier.Api.SizesChanger.prototype.getSizesChangerFunction=function(){return this._sizesChangerFunction};Gridifier.Api.SizesChanger.prototype._addDefaultSizesChanger=function(){this._sizesChangerFunctions["default"]=function(a,b,c){Dom.css3.transitionProperty(a,"width 0ms ease, height 0ms ease");Dom.css.set(a,{width:b,height:c})}};Gridifier.Api.SizesChanger.prototype._addSimultaneousCSS3TransitionSizesChanger=function(){this._sizesChangerFunctions.simultaneousCSS3Transition=function(a,b,c){Dom.css.set(a,{width:b,height:c})}};Gridifier.Api.Sort=function(a,b){var c=this;this._settings=null;this._eventEmitter=null;this._sortFunction=null;this._sortFunctions={};this._css={};this._construct=function(){c._settings=a;c._eventEmitter=b;c._sortFunctions={};c._addDefaultSort()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Api.Sort.prototype.setSortFunction=function(a){if(!this._sortFunctions.hasOwnProperty(a)){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.SET_SORT_INVALID_PARAM,a);return}this._sortFunction=this._sortFunctions[a]};Gridifier.Api.Sort.prototype.addSortFunction=function(a,b){this._sortFunctions[a]=b};Gridifier.Api.Sort.prototype.getSortFunction=function(){return this._sortFunction};Gridifier.Api.Sort.prototype._addDefaultSort=function(){this._sortFunctions["default"]=function(a,b){return-1}};Gridifier.Api.Toggle=function(a,b,c){var d=this;this._settings=null;this._eventEmitter=null;this._sizesResolverManager=null;this._rotateApi=null;this._toggleFunction=null;this._toggleFunctions={};this._css={};this._construct=function(){d._settings=a;d._eventEmitter=b;d._sizesResolverManager=c;d._rotateApi=new Gridifier.Api.Rotate(d._settings,d._eventEmitter,d._sizesResolverManager);d._toggleFunctions={};d._addRotateX();d._addRotateY();d._addScale();d._addFade();d._addVisibility()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.Api.Toggle.prototype.setToggleFunction=function(a){if(!this._toggleFunctions.hasOwnProperty(a)){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.SET_TOGGLE_INVALID_PARAM,a);return}this._toggleFunction=this._toggleFunctions[a]};Gridifier.Api.Toggle.prototype.addToggleFunction=function(a,b){this._toggleFunctions[a]=b};Gridifier.Api.Toggle.prototype.getToggleFunction=function(){return this._toggleFunction};Gridifier.Api.Toggle.prototype._addRotateX=function(){var a=this;this._toggleFunctions.rotateX={show:function(b,c){if(!Dom.isBrowserSupportingTransitions()){b.style.visibility="visible";return}a._rotateApi.show(b,c)},hide:function(b,c){if(!Dom.isBrowserSupportingTransitions()){b.style.visibility="hidden";return}a._rotateApi.hide(b,c)}}};Gridifier.Api.Toggle.prototype._addRotateY=function(){var a=this;this._toggleFunctions.rotateY={show:function(b,c){if(!Dom.isBrowserSupportingTransitions()){b.style.visibility="visible";return}a._rotateApi.show(b,c,true)},hide:function(b,c){if(!Dom.isBrowserSupportingTransitions()){b.style.visibility="hidden";return}a._rotateApi.hide(b,c,true)}}};Gridifier.Api.Toggle.prototype._addScale=function(){var a=this;this._toggleFunctions.scale={show:function(b,c){if(!Dom.isBrowserSupportingTransitions()){b.style.visibility="visible";return}Dom.css3.transition(b,"none");Dom.css3.transformProperty(b,"scale",0);b.style.visibility="visible";setTimeout(function(){b.style.visibility="visible";Dom.css3.transition(b,Prefixer.getForCSS("transform",b)+" 900ms ease");Dom.css3.transformProperty(b,"scale",1);setTimeout(function(){a._eventEmitter.emitShowEvent(b)},1020)},20)},hide:function(a,b,c){b.style.visibility="visible";a.style.visibility="hidden";if(!Dom.isBrowserSupportingTransitions()){b.style.visibility="hidden";return}Dom.css3.transition(b,Prefixer.getForCSS("transform",b)+" 900ms ease");Dom.css3.transform(b,"scale(0)");setTimeout(function(){b.style.visibility="hidden";c.removeChild(b)},820)}}};Gridifier.Api.Toggle.prototype._addFade=function(){var a=this;this._toggleFunctions.fade={show:function(a){if(!Dom.isBrowserSupportingTransitions()){a.style.visibility="visible";return}Dom.css3.transition(a,"All 0s ease");Dom.css3.opacity(a,"0");setTimeout(function(){a.style.visibility="visible";Dom.css3.transition(a,"All 1000ms ease");Dom.css3.opacity(a,1)},20)},hide:function(a){if(!Dom.isBrowserSupportingTransitions()){a.style.visibility="hidden";return}Dom.css3.transition(a,"All 1000ms ease");Dom.css3.opacity(a,"0");setTimeout(function(){a.style.visibility="hidden";Dom.css3.transition(a,"All 0ms ease");Dom.css3.opacity(a,1)},20)}}};Gridifier.Api.Toggle.prototype._addVisibility=function(){this._toggleFunctions.visibility={show:function(a){a.style.visibility="visible"},hide:function(a){a.style.visibility="hidden"}}};Gridifier.Connections=function(a,b,c,d,e){var f=this;this._gridifier=null;this._connections=null;this._guid=null;this._sizesTransformer=null;this._connectionsSorter=null;this._sizesResolverManager=null;this._connectedItemMarker=null;this._css={};this._construct=function(){f._gridifier=a;f._connections=b;f._guid=c;f._connectionsSorter=d;f._sizesResolverManager=e;f._connectedItemMarker=new Gridifier.ConnectedItemMarker};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){f._unbindEvents()};this._construct();return this};Gridifier.Connections.prototype.setSizesTransformerInstance=function(a){this._sizesTransformer=a};Gridifier.Connections.prototype.findConnectionByItem=function(a){var b=this._connections.get();if(b.length==0)new Gridifier.Error(Gridifier.Error.ERROR_TYPES.CONNECTIONS.NO_CONNECTIONS);var c=this._guid.getItemGUID(a);var d=null;for(var e=0;e<b.length;e++){if(c==this._guid.getItemGUID(b[e].item))d=b[e]}if(d==null){if(!this._sizesTransformer.isTransformerQueueEmpty()){var f=this._sizesTransformer.getQueuedConnectionsPerTransform();for(var e=0;e<f.length;e++){if(c==f[e].itemGUID)d=f[e]}}}if(d==null){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.CONNECTIONS.CONNECTION_BY_ITEM_NOT_FOUND,{item:a,connections:b})}return d};Gridifier.Connections.prototype.remapAllItemGUIDS=function(){this._guid.reinit();var a=this._connectionsSorter.sortConnectionsPerReappend(this._connections.get());for(var b=0;b<a.length;b++){var c=this._guid.markNextAppendedItem(a[b].item);a[b].itemGUID=c}};Gridifier.Connections.prototype.remapAllItemGUIDSInSortedConnections=function(a){for(var b=0;b<a.length;b++){var c=this._guid.markNextAppendedItem(a[b].item);a[b].itemGUID=c}};Gridifier.Connections.prototype.getConnectionsByItemGUIDS=function(a){var b=this._connections.get();var c=[];for(var d=0;d<b.length;d++){for(var e=0;e<a.length;e++){if(b[d].itemGUID==a[e]){c.push(b[d]);break}}}return c};Gridifier.Connections.prototype.createItemConnection=function(a,b){var c=b;c.item=a;c.itemGUID=Dom.toInt(this._guid.getItemGUID(a));if(!c.hasOwnProperty("horizontalOffset"))c.horizontalOffset=0;if(!c.hasOwnProperty("verticalOffset"))c.verticalOffset=0;if(!c.hasOwnProperty(Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT))c[Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT]=false;if(!this._connectedItemMarker.isItemConnected(a))this._connectedItemMarker.markItemAsConnected(a);return c};Gridifier.Connections.prototype.syncConnectionParams=function(a){var b=this._connections.get();for(var c=0;c<a.length;c++){for(var d=0;d<b.length;d++){if(b[d].itemGUID==a[c].itemGUID){var e=Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT;b[d][e]=a[c][e];b[d].verticalOffset=a[c].verticalOffset;b[d].horizontalOffset=a[c].horizontalOffset;b[d].x1=a[c].x1;b[d].x2=a[c].x2;b[d].y1=a[c].y1;b[d].y2=a[c].y2;break}}}};Gridifier.Connections.prototype.getMinConnectionWidth=function(){var a=this._connections.get();if(a.length==0)return 0;var b=this;var c=this._gridifier.getGridX2();var d=function(d){if(a[d].x1>=a[d].x2||a[d].x1<0||a[d].x2>c){var e=b._sizesResolverManager.outerWidth(a[d].item,true)}else{var e=a[d].x2-a[d].x1+1}return e};var e=d(0);for(var f=1;f<a.length;f++){var g=d(f);if(g<e)e=g}return e};Gridifier.Connections.prototype.getMinConnectionHeight=function(){var a=this._connections.get();if(a.length==0)return 0;var b=this;var c=this._gridifier.getGridY2();var d=function(d){if(a[d].y1>=a[d].y2||a[d].y1<0||a[d].y2>c){var e=b._sizesResolverManager.outerHeight(a[d].item,true)}else{var e=a[d].y2-a[d].y1+1}return e};var e=d(0);for(var f=1;f<a.length;f++){var g=d(f);if(g<e)e=g}return e};Gridifier.Connections.prototype.isAnyConnectionItemGUIDSmallerThan=function(a,b){var c=this._guid.getItemGUID(b);for(var d=0;d<a.length;d++){var e=this._guid.getItemGUID(a[d].item);if(e<c)return true}return false};Gridifier.Connections.prototype.isAnyConnectionItemGUIDBiggerThan=function(a,b){var c=this._guid.getItemGUID(b);for(var d=0;d<a.length;d++){var e=this._guid.getItemGUID(a[d].item);if(e>c)return true}return false};Gridifier.ConnectionsIntersector=function(a){var b=this;this._connections=null;this._css={};this._construct=function(){b._connections=a};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.ConnectionsIntersector.prototype.isIntersectingAnyConnection=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];var e=b.y1<d.y1&&b.y2<d.y1;var f=b.y1>d.y2&&b.y2>d.y2;var g=b.x1<d.x1&&b.x2<d.x1;var h=b.x1>d.x2&&b.x2>d.x2;if(!e&&!f&&!g&&!h)return true}return false};Gridifier.ConnectionsIntersector.prototype.getAllConnectionsWithIntersectedCenter=function(a){var b=this._connections.get();var c=[];for(var d=0;d<b.length;d++){var e=b[d].x2-b[d].x1+1;var f=b[d].y2-b[d].y1+1;var g={x1:b[d].x1+e/2,x2:b[d].x1+e/2,y1:b[d].y1+f/2,y2:b[d].y1+f/2};if(this.isIntersectingAnyConnection([g],a)){c.push(b[d])}}return c};Gridifier.Connectors=function(a,b){var c=this;this._guid=null;this._connections=null;this._connectors=[];this._nextFlushCallback=null;this._css={};this._construct=function(){c._guid=a;c._connections=b};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Connectors.INITIAL_CONNECTOR_ITEM_GUID=-1;Gridifier.Connectors.TYPES={APPEND:{DEFAULT:"appendDefault",REVERSED:"appendReversed"},PREPEND:{DEFAULT:"prependDefault",REVERSED:"prependReversed"}};Gridifier.Connectors.SIDES={LEFT:{TOP:"leftTop",BOTTOM:"leftBottom"},BOTTOM:{RIGHT:"bottomRight",LEFT:"bottomLeft"},RIGHT:{TOP:"rightTop",BOTTOM:"rightBottom"},TOP:{LEFT:"topLeft",RIGHT:"topRight"}};Gridifier.Connectors.isLeftTopSideConnector=function(a){return a.side==Gridifier.Connectors.SIDES.LEFT.TOP};Gridifier.Connectors.isLeftBottomSideConnector=function(a){return a.side==Gridifier.Connectors.SIDES.LEFT.BOTTOM};Gridifier.Connectors.isBottomRightSideConnector=function(a){return a.side==Gridifier.Connectors.SIDES.BOTTOM.RIGHT};Gridifier.Connectors.isBottomLeftSideConnector=function(a){return a.side==Gridifier.Connectors.SIDES.BOTTOM.LEFT};Gridifier.Connectors.isRightTopSideConnector=function(a){return a.side==Gridifier.Connectors.SIDES.RIGHT.TOP};Gridifier.Connectors.isRightBottomSideConnector=function(a){return a.side==Gridifier.Connectors.SIDES.RIGHT.BOTTOM};Gridifier.Connectors.isTopLeftSideConnector=function(a){return a.side==Gridifier.Connectors.SIDES.TOP.LEFT};Gridifier.Connectors.isTopRightSideConnector=function(a){return a.side==Gridifier.Connectors.SIDES.TOP.RIGHT};Gridifier.Connectors.prototype._addConnector=function(a,b,c,d,e){if(typeof e=="undefined")var e=Gridifier.Connectors.INITIAL_CONNECTOR_ITEM_GUID;this._connectors.push({type:a,side:b,x:c,y:d,itemGUID:e})};Gridifier.Connectors.prototype.addAppendConnector=function(a,b,c,d){this._addConnector(Gridifier.Connectors.TYPES.APPEND.DEFAULT,a,b,c,d)};Gridifier.Connectors.prototype.addReversedAppendConnector=function(a,b,c,d){this._addConnector(Gridifier.Connectors.TYPES.APPEND.REVERSED,a,b,c,d)};Gridifier.Connectors.prototype.addPrependConnector=function(a,b,c,d){this._addConnector(Gridifier.Connectors.TYPES.PREPEND.DEFAULT,a,b,c,d)};Gridifier.Connectors.prototype.addReversedPrependConnector=function(a,b,c,d){this._addConnector(Gridifier.Connectors.TYPES.PREPEND.REVERSED,a,b,c,d)};Gridifier.Connectors.prototype.count=function(){return this._connectors.length};Gridifier.Connectors.prototype.setNextFlushCallback=function(a){this._nextFlushCallback=a};Gridifier.Connectors.prototype.flush=function(){this._connectors=[];if(typeof this._nextFlushCallback=="function"){this._nextFlushCallback();this._nextFlushCallback=null}};Gridifier.Connectors.prototype.get=function(){return this._connectors};Gridifier.Connectors.prototype.set=function(a){this._connectors=a};Gridifier.Connectors.prototype.getClone=function(){var a=[];for(var b=0;b<this._connectors.length;b++){a.push({type:this._connectors[b].type,side:this._connectors[b].side,x:this._connectors[b].x,y:this._connectors[b].y,itemGUID:this._connectors[b].itemGUID,connectorIndex:b})}return a};Gridifier.ConnectorsIntersector=function(a,b){var c=this;this._connections=null;this._settings=null;this._css={};this._construct=function(){c._connections=a;c._settings=b};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.ConnectorsIntersector.prototype.getMostLeftFromIntersectedRightItems=function(a){var b=this._connections.get();var c=null;var d=function(b){if(a.y>=b.y1&&a.y<=b.y2&&a.x<b.x1){if(c==null)c=b;else{if(b.x1<c.x1)c=b}}};if(this._settings.isVerticalGrid()){var e=this._connections.getAllHorizontallyIntersectedConnections(a);for(var f=0;f<e.length;f++){d(b[e[f]])}}else if(this._settings.isHorizontalGrid()){var e=this._connections.getAllVerticallyIntersectedAndRightConnections(a);for(var f=0;f<e.length;f++){for(var g=0;g<e[f].length;g++){d(b[e[f][g]])}}}return c};Gridifier.ConnectorsIntersector.prototype.getMostBottomFromIntersectedTopOrTopLeftItems=function(a){var b=this._connections.get();var c=null;if(this._settings.isVerticalGrid())var d=this._connections.getAllHorizontallyIntersectedAndUpperConnections(a);else if(this._settings.isHorizontalGrid())var d=this._connections.getAllVerticallyIntersectedAndLeftConnections(a);for(var e=0;e<d.length;e++){for(var f=0;f<d[e].length;f++){var g=b[d[e][f]];if((a.x>=g.x1&&a.x<=g.x2||a.x>g.x2)&&a.y>g.y2){if(c==null)c=g;else{if(g.y2>c.y2)c=g}}}}return c};Gridifier.ConnectorsIntersector.prototype.getMostBottomFromIntersectedTopOrTopRightItems=function(a){var b=this._connections.get();var c=null;if(this._settings.isVerticalGrid())var d=this._connections.getAllHorizontallyIntersectedAndUpperConnections(a);else if(this._settings.isHorizontalGrid())var d=this._connections.getAllVerticallyIntersectedAndRightConnections(a);for(var e=0;e<d.length;e++){for(var f=0;f<d[e].length;f++){var g=b[d[e][f]];if((a.x>=g.x1&&a.x<=g.x2||a.x<g.x1)&&a.y>g.y2){if(c==null)c=g;else{if(g.y2>c.y2)c=g}}}}};Gridifier.ConnectorsIntersector.prototype.getMostRightFromIntersectedLeftItems=function(a){var b=this._connections.get();var c=null;var d=function(b){if(a.y>=b.y1&&a.y<=b.y2&&a.x>b.x2){if(c==null)c=b;else{if(b.x>c.x2)c=b}}};if(this._settings.isVerticalGrid()){var e=this._connections.getAllHorizontallyIntersectedConnections(a);for(var f=0;f<e.length;f++){d(b[e[f]])}}else if(this._settings.isHorizontalGrid()){var e=this._connections.getAllVerticallyIntersectedAndLeftConnections(a);for(var f=0;f<e.length;f++){for(var g=0;g<e[f].length;g++){d(b[e[f][g]])}}}return c};Gridifier.ConnectorsIntersector.prototype.getMostTopFromIntersectedBottomOrBottomRightItems=function(a){var b=this._connections.get();var c=null;if(this._settings.isVerticalGrid())var d=this._connections.getAllHorizontallyIntersectedAndLowerConnections(a);else if(this._settings.isHorizontalGrid())var d=this._connections.getAllVerticallyIntersectedAndRightConnections(a);for(var e=0;e<d.length;e++){for(var f=0;f<d[e].length;f++){var g=b[d[e][f]];if((a.x>=g.x1&&a.x<=g.x2||a.x<g.x1)&&a.y<g.y1){if(c==null)c=g;else{if(g.y1<c.y1)c=g}}}}return c};Gridifier.ConnectorsIntersector.prototype.getMostTopFromIntersectedBottomOrBottomLeftItems=function(a){var b=this._connections.get();var c=null;if(this._settings.isVerticalGrid())var d=this._connections.getAllHorizontallyIntersectedAndLowerConnections(a);else if(this._settings.isHorizontalGrid())var d=this._connections.getAllVerticallyIntersectedAndLeftConnections(a);for(var e=0;e<d.length;e++){for(var f=0;f<d[e].length;f++){var g=b[d[e][f]];if((a.x>=g.x1&&a.x<=g.x2||a.x>g.x2)&&a.y<g.y1){if(c==null)c=g;else{if(g.y1<c.y1)c=g}}}}return c};Gridifier.ConnectorsShifter=function(a,b,c){var d=this;this._gridifier=null;this._connections=null;this._settings=null;this._connectorsIntersector=null;this._ci=null;this._connectors=null;this._shiftedConnectors=[];this._allConnectors=[];this._css={};this._construct=function(){d._gridifier=a;d._connections=b;d._settings=c;d._connectorsIntersector=new Gridifier.ConnectorsIntersector(d._connections,d._settings);d._ci=d._connectorsIntersector};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.ConnectorsShifter.SIDE="shifted";Gridifier.ConnectorsShifter.prototype.attachConnectors=function(a){this._connectors=a;this._shifterConnectors=[];this._allConnectors=[]};Gridifier.ConnectorsShifter.prototype.getAllConnectors=function(){return this._allConnectors};Gridifier.ConnectorsShifter.prototype._createShiftedConnector=function(a,b,c){var d={type:c.type,side:Gridifier.ConnectorsShifter.SIDE,x:parseFloat(a),y:parseFloat(b),itemGUID:Dom.toInt(c.itemGUID)};this._shiftedConnectors.push(d);this._allConnectors.push(d)};Gridifier.ConnectorsShifter.prototype.shiftAllConnectors=function(){for(var a=0;a<this._connectors.length;a++){this._allConnectors.push(this._connectors[a]);if(Gridifier.Connectors.isLeftTopSideConnector(this._connectors[a])){this._shiftLeftTopConnector(this._connectors[a])}else if(Gridifier.Connectors.isLeftBottomSideConnector(this._connectors[a])){this._shiftLeftBottomConnector(this._connectors[a])}else if(Gridifier.Connectors.isBottomRightSideConnector(this._connectors[a])){this._shiftBottomRightConnector(this._connectors[a])}else if(Gridifier.Connectors.isBottomLeftSideConnector(this._connectors[a])){this._shiftTopLeftConnector(this._connectors[a])}else if(Gridifier.Connectors.isTopLeftSideConnector(this._connectors[a])){this._shiftTopLeftConnector(this._connectors[a])}else if(Gridifier.Connectors.isTopRightSideConnector(this._connectors[a])){this._shiftBottomRightConnector(this._connectors[a])}else if(Gridifier.Connectors.isRightBottomSideConnector(this._connectors[a])){this._shiftRightBottomConnector(this._connectors[a])}else if(Gridifier.Connectors.isRightTopSideConnector(this._connectors[a])){this._shiftRightTopConnector(this._connectors[a])}}};Gridifier.ConnectorsShifter.prototype._shiftLeftTopConnector=function(a){var b=this._ci.getMostBottomFromIntersectedTopOrTopLeftItems(a);if(b!=null){if(b.y2+1!=a.y)this._createShiftedConnector(a.x,b.y2+1,a)}else{if(a.y!=0)this._createShiftedConnector(a.x,0,a)}};Gridifier.ConnectorsShifter.prototype._shiftLeftBottomConnector=function(a){var b=this._ci.getMostTopFromIntersectedBottomOrBottomLeftItems(a);if(b!=null){if(b.y1-1!=a.y)this._createShiftedConnector(a.x,b.y1-1,a)}else{var c=this._connections.getMaxYFromAllConnections();if(c!=0){if(c-1!=a.y)this._createShiftedConnector(a.x,c-1,a)}}};Gridifier.ConnectorsShifter.prototype._shiftBottomRightConnector=function(a){var b=this._ci.getMostLeftFromIntersectedRightItems(a);if(b!=null){if(b.x1-1!=a.x)this._createShiftedConnector(b.x1-1,a.y,a)}else{if(a.x!=this._gridifier.getGridX2())this._createShiftedConnector(this._gridifier.getGridX2(),a.y,a)}};Gridifier.ConnectorsShifter.prototype._shiftTopLeftConnector=function(a){var b=this._ci.getMostRightFromIntersectedLeftItems(a);if(b!=null){if(b.x2+1!=a.x)this._createShiftedConnector(b.x2+1,a.y,a)}else{if(a.x!=0)this._createShiftedConnector(0,a.y,a)}};Gridifier.ConnectorsShifter.prototype._shiftRightBottomConnector=function(a){var b=this._ci.getMostTopFromIntersectedBottomOrBottomRightItems(a);if(b!=null){if(b.y1-1!=a.y)this._createShiftedConnector(a.x,b.y1-1,a)}else{var c=this._connections.getMaxYFromAllConnections();if(c!=0){if(c-1!=a.y)this._createShiftedConnector(a.x,c-1,a)}}};Gridifier.ConnectorsShifter.prototype._shiftRightTopConnector=function(a){var b=this._ci.getMostBottomFromIntersectedTopOrTopRightItems(a);if(b!=null){if(b.y2+1!=a.y)this._createShiftedConnector(a.x,b.y2+1,a)}else{if(a.y!=0){this._createShiftedConnector(a.x,0,a)}}};Gridifier.ConnectorsShifter.prototype.shiftAllWithSpecifiedSideToRightGridCorner=function(a){this._allConnectors=this._connectors;for(var b=0;b<this._allConnectors.length;b++){if(this._allConnectors[b].side==a)this._allConnectors[b].x=this._gridifier.getGridX2()}};Gridifier.ConnectorsShifter.prototype.shiftAllWithSpecifiedSideToLeftGridCorner=function(a){this._allConnectors=this._connectors;for(var b=0;b<this._allConnectors.length;b++){if(this._allConnectors[b].side==a)this._allConnectors[b].x=0}};Gridifier.ConnectorsShifter.prototype.shiftAllWithSpecifiedSideToTopGridCorner=function(a){this._allConnectors=this._connectors;for(var b=0;b<this._allConnectors.length;b++){if(this._allConnectors[b].side==a)this._allConnectors[b].y=0}};Gridifier.ConnectorsShifter.prototype.shiftAllWithSpecifiedSideToBottomGridCorner=function(a){this._allConnectors=this._connectors;for(var b=0;b<this._allConnectors.length;b++){if(this._allConnectors[b].side==a)this._allConnectors[b].y=this._gridifier.getGridY2()}};Gridifier.TransformerConnectors=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this;this._gridifier=null;this._settings=null;this._connectors=null;this._connections=null;this._guid=null;this._appender=null;this._reversedAppender=null;this._normalizer=null;this._sizesTransformer=null;this._connectorsCleaner=null;this._transformedItemMarker=null;this._itemsReappender=null;this._operation=null;this._css={};this._construct=function(){m._gridifier=a;m._settings=b;m._connectors=c;m._connections=d;m._guid=e;m._appender=f;m._reversedAppender=g;m._normalizer=h;m._sizesTransformer=i;m._connectorsCleaner=j;m._transformedItemMarker=k;m._operation=l};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){m._unbindEvents()};this._construct();return this};Gridifier.TransformerConnectors.prototype.setItemsReappenderInstance=function(a){this._itemsReappender=a};Gridifier.TransformerConnectors.prototype.recreateConnectorsPerFirstItemReappendOnTransform=function(a,b){if(this._itemsReappender.isReversedAppendShouldBeUsedPerItemInsert(a)){this._operation.setLastOperation(Gridifier.OPERATIONS.REVERSED_APPEND);this._recreateConnectorsPerReversedItemReappend(a,b)}else{this._operation.setLastOperation(Gridifier.OPERATIONS.APPEND);this._recreateConnectorsPerDefaultItemReappend(a,b)}};Gridifier.TransformerConnectors.prototype._recreateConnectorsPerReversedItemReappend=function(a,b){this._connections.reinitRanges();this._reversedAppender.recreateConnectorsPerAllConnectedItems();if(this._settings.isVerticalGrid()){this._connectorsCleaner.deleteAllIntersectedFromBottomConnectors()}else if(this._settings.isHorizontalGrid()){this._connectorsCleaner.deleteAllIntersectedFromRightConnectors()}};Gridifier.TransformerConnectors.prototype._recreateConnectorsPerDefaultItemReappend=function(a,b){this._connections.reinitRanges();this._appender.recreateConnectorsPerAllConnectedItems();if(this._settings.isVerticalGrid()){this._connectorsCleaner.deleteAllIntersectedFromBottomConnectors()}else if(this._settings.isHorizontalGrid()){this._connectorsCleaner.deleteAllIntersectedFromRightConnectors()}};Gridifier.Collector=function(a,b,c){var d=this;this._settings=null;this._grid=null;this._sizesResolverManager=null;this._collectorFunction=null;this._markingFunction=null;this._connectedItemMarker=null;this._css={};this._construct=function(){d._settings=a;d._grid=b;d._sizesResolverManager=c;d._createCollectorFunction();d._createMarkingFunction();d._connectedItemMarker=new Gridifier.ConnectedItemMarker};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.Collector.prototype._createCollectorFunction=function(){var a=this._settings.getGridItemMarkingType();if(this._settings.isByClassGridItemMarkingStrategy()){this._collectorFunction=function(b){return Dom.get.byQuery(b,"."+a)}}else if(this._settings.isByDataAttrGridItemMarkingStrategy()){this._collectorFunction=function(b){return Dom.get.byQuery(b,"["+a+"]")}}};Gridifier.Collector.prototype._createMarkingFunction=function(){var a=this._settings.getGridItemMarkingType();if(this._settings.isByClassGridItemMarkingStrategy()){this._markingFunction=function(b){Dom.css.addClass(b,a)}}else if(this._settings.isByDataAttrGridItemMarkingStrategy()){this._markingFunction=function(b){b.setAttribute(a,"")}}};Gridifier.Collector.prototype.attachToGrid=function(a){for(var b=0;b<a.length;b++){Dom.css.set(a[b],{visibility:"hidden",position:"absolute"})}for(var b=0;b<a.length;b++)this._markingFunction(a[b])};Gridifier.Collector.prototype.ensureAllItemsAreAttachedToGrid=function(a){for(var b=0;b<a.length;b++){if(!Dom.isChildOf(a[b],this._grid)){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.COLLECTOR.ITEM_NOT_ATTACHED_TO_GRID,a[b])}}};Gridifier.Collector.prototype.ensureAllItemsAreConnectedToGrid=function(a){for(var b=0;b<a.length;b++){if(!this._connectedItemMarker.isItemConnected(a[b])){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.COLLECTOR.ITEM_NOT_CONNECTED_TO_GRID,a[b])}}};Gridifier.Collector.prototype._isItemWiderThanGridWidth=function(a){return this._sizesResolverManager.outerWidth(a,true)>this._sizesResolverManager.outerWidth(this._grid,false,true)};Gridifier.Collector.prototype._isItemTallerThanGridHeight=function(a){return this._sizesResolverManager.outerHeight(a,true)>this._sizesResolverManager.outerHeight(this._grid,false,true)};Gridifier.Collector.prototype.canItemBeAttachedToGrid=function(a){if(this._settings.isVerticalGrid())return!this._isItemWiderThanGridWidth(a);else if(this._settings.isHorizontalGrid())return!this._isItemTallerThanGridHeight(a)};Gridifier.Collector.prototype.throwWrongItemSizesError=function(a){if(this._settings.isVerticalGrid()){var b={item:a,itemWidth:this._sizesResolverManager.outerWidth(a,true),gridWidth:this._sizesResolverManager.outerWidth(this._grid,false,true)};var c=Gridifier.Error.ERROR_TYPES.COLLECTOR.ITEM_WIDER_THAN_GRID_WIDTH}else if(this._settings.isHorizontalGrid()){var b={item:a,itemHeight:this._sizesResolverManager.outerHeight(a,true),gridHeight:this._sizesResolverManager.outerHeight(this._grid,false,true)};var c=Gridifier.Error.ERROR_TYPES.COLLECTOR.ITEM_TALLER_THAN_GRID_HEIGHT}new Gridifier.Error(c,b)};Gridifier.Collector.prototype.ensureAllItemsCanBeAttachedToGrid=function(a){for(var b=0;b<a.length;b++){if(!this.canItemBeAttachedToGrid(a[b])){this.throwWrongItemSizesError(a[b])}}};Gridifier.Collector.prototype.collect=function(){var a=this._collectorFunction(this._grid);return a};Gridifier.Collector.prototype.collectAllConnectedItems=function(){var a=this._collectorFunction(this._grid);var b=[];for(var c=0;c<a.length;c++){if(this._connectedItemMarker.isItemConnected(a[c]))b.push(a[c])}return b};Gridifier.Collector.prototype.collectAllDisconnectedItems=function(){var a=this._collectorFunction(this._grid);var b=[];for(var c=0;c<a.length;c++){if(!this._connectedItemMarker.isItemConnected(a[c]))b.push(a[c])}return b};Gridifier.Collector.prototype.toDOMCollection=function(a){var b=function(a){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.COLLECTOR.NOT_DOM_ELEMENT,a)};if(Dom.isJqueryObject(a)){var c=[];for(var d=0;d<a.length;d++)c.push(a.get(d));return c}if(Dom.isNativeDOMObject(a)){var c=[];c.push(a);return c}if(Dom.isArray(a)){for(var d=0;d<a.length;d++){if(Dom.isJqueryObject(a[d]))a[d]=a[d].get(0);if(!Dom.isNativeDOMObject(a[d])){b(a[d])}}return a}else{b(a)}};Gridifier.Collector.prototype.filterCollection=function(a){var b=this._settings.getFilter();var c=[];for(var d=0;d<a.length;d++){if(b(a[d]))c.push(a[d])}return c};Gridifier.Collector.prototype.sortCollection=function(a){a.sort(this._settings.getSort());return a};Gridifier.ConnectedItemMarker=function(){var a=this;this._css={};this._construct=function(){};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){a._unbindEvents()};this._construct();return this};Gridifier.ConnectedItemMarker.CONNECTED_ITEM_DATA_CLASS="gridifier-connected-item";Gridifier.ConnectedItemMarker.prototype.markItemAsConnected=function(a){Dom.css.addClass(a,Gridifier.ConnectedItemMarker.CONNECTED_ITEM_DATA_CLASS)};Gridifier.ConnectedItemMarker.prototype.isItemConnected=function(a){return Dom.css.hasClass(a,Gridifier.ConnectedItemMarker.CONNECTED_ITEM_DATA_CLASS)};Gridifier.ConnectedItemMarker.prototype.unmarkItemAsConnected=function(a){Dom.css.removeClass(a,Gridifier.ConnectedItemMarker.CONNECTED_ITEM_DATA_CLASS)};Gridifier.Disconnector=function(a,b,c,d,e,f,g,h){var i=this;this._gridifier=null;this._collector=null;this._connections=null;this._connectors=null;this._settings=null;this._guid=null;this._connectedItemMarker=null;this._appender=null;this._reversedAppender=null;this._css={};this._construct=function(){i._gridifier=a;i._collector=b;i._connections=c;i._connectors=d;i._settings=e;i._guid=f;i._connectedItemMarker=new Gridifier.ConnectedItemMarker;i._appender=g;i._reversedAppender=h};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){i._unbindEvents()};this._construct();return this};Gridifier.Disconnector.prototype.disconnect=function(a){var a=this._collector.toDOMCollection(a);this._collector.ensureAllItemsAreConnectedToGrid(a);var b=this._findConnectionsToDisconnect(a);for(var c=0;c<b.length;c++){this._connections.removeConnection(b[c]);this._guid.removeItemGUID(b[c].item)}if(this._connections.get().length==0)this._recreateConnectors();for(var c=0;c<b.length;c++)this._connectedItemMarker.unmarkItemAsConnected(b[c].item);b=this._addDisconnectedItemClones(b);var d=this._gridifier.getRenderer();d.hideConnections(b)};Gridifier.Disconnector.prototype._findConnectionsToDisconnect=function(a){var b=[];for(var c=0;c<a.length;c++){var d=this._connections.findConnectionByItem(a[c]);b.push(d)}return b};Gridifier.Disconnector.prototype._recreateConnectors=function(){this._connectors.flush();
if(this._settings.isDefaultAppend()){this._appender.createInitialConnector()}else if(this._settings.isReversedAppend()){this._reversedAppender.createInitialConnector()}};Gridifier.Disconnector.prototype._addDisconnectedItemClones=function(a){for(var b=0;b<a.length;b++){var c=a[b].item.cloneNode(true);c.style.visibility="hidden";Dom.css3.transition(c,"none");Dom.css3.transform(c,"");a[b].disconnectedItemClone=c;this._gridifier.getGrid().appendChild(c)}return a};Gridifier.EventEmitter=function(a){var b=this;b._gridifier=null;b._showCallbacks=[];b._gridSizesChangeCallbacks=[];this._css={};this._construct=function(){b._gridifier=a;b._bindEmitterToGridifier()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.EventEmitter.prototype._bindEmitterToGridifier=function(){var a=this;this._gridifier.onShow=function(b){a.onShow.call(a,b)};this._gridifier.onGridSizesChange=function(b){a.onGridSizesChange.call(a,b)}};Gridifier.EventEmitter.prototype.onShow=function(a){this._showCallbacks.push(a)};Gridifier.EventEmitter.prototype.onGridSizesChange=function(a){this._gridSizesChangeCallbacks.push(a)};Gridifier.EventEmitter.prototype.emitShowEvent=function(a){for(var b=0;b<this._showCallbacks.length;b++){this._showCallbacks[b](a)}};Gridifier.EventEmitter.prototype.emitGridSizesChangeEvent=function(){for(var a=0;a<this._gridSizesChangeCallbacks.length;a++){this._gridSizesChangeCallbacks[a]()}};Gridifier.Filtrator=function(a,b,c,d,e,f){var g=this;this._gridifier=null;this._collector=null;this._connections=null;this._settings=null;this._guid=null;this._connectedItemMarker=null;this._disconnector=null;this._css={};this._construct=function(){g._gridifier=a;g._collector=b;g._connections=c;g._settings=d;g._guid=e;g._connectedItemMarker=new Gridifier.ConnectedItemMarker;g._disconnector=f};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){g._unbindEvents()};this._construct();return this};Gridifier.Filtrator.prototype.filter=function(){var a=this._collector.collect();var b=this._collector.collectAllConnectedItems();var c=this._collector.collectAllDisconnectedItems();var d=this._collector.sortCollection(this._collector.filterCollection(a));var e=this._collector.filterCollection(b);var f=this._collector.filterCollection(c);var g=this._findConnectedItemsToHide(b);this._disconnector.disconnect(g);this._recreateGUIDS(d);this._recreateConnections(d)};Gridifier.Filtrator.prototype._findConnectedItemsToHide=function(a){var b=[];for(var c=0;c<a.length;c++){var d=this._collector.filterCollection([a[c]]);if(d.length==0)b.push(a[c])}return b};Gridifier.Filtrator.prototype._recreateGUIDS=function(a){this._guid.reinit();for(var b=0;b<a.length;b++){this._guid.markNextAppendedItem(a[b])}};Gridifier.Filtrator.prototype._recreateConnections=function(a){var b=this._connections.get();b.splice(0,b.length);if(this._settings.isHorizontalGrid()){this._recreateAllHorizontalGridConnectionsPerReappend(a)}else if(this._settings.isVerticalGrid()){this._recreateAllVerticalGridConnectionsPerReappend(a)}};Gridifier.Filtrator.prototype._recreateAllHorizontalGridConnectionsPerReappend=function(a){var b=0;for(var c=0;c<a.length;c++){var d={};d.x1=b;d.x2=b;d.y1=0;d.y2=0;this._connections.add(a[c],d);b++}};Gridifier.Filtrator.prototype._recreateAllVerticalGridConnectionsPerReappend=function(a){var b=0;for(var c=0;c<a.length;c++){var d={};d.x1=0;d.x2=0;d.y1=b;d.y2=b;this._connections.add(a[c],d);b++}};Gridifier.GUID=function(){var a=this;this._maxItemGUID=9999;this._minItemGUID=1e4;this._css={};this._construct=function(){};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){a._unbindEvents()};this._construct();return this};Gridifier.GUID.GUID_DATA_ATTR="data-gridifier-item-id";Gridifier.GUID.prototype.reinit=function(){this._maxItemGUID=9999;this._minItemGUID=1e4};Gridifier.GUID.prototype.reinitMaxGUID=function(a){if(typeof a=="undefined"||a==null)this._maxItemGUID=9999;else this._maxItemGUID=a};Gridifier.GUID.prototype.getItemGUID=function(a){return Dom.toInt(a.getAttribute(Gridifier.GUID.GUID_DATA_ATTR))};Gridifier.GUID.prototype.setItemGUID=function(a,b){return a.setAttribute(Gridifier.GUID.GUID_DATA_ATTR,b)};Gridifier.GUID.prototype.removeItemGUID=function(a){a.removeAttribute(Gridifier.GUID.GUID_DATA_ATTR)};Gridifier.GUID.prototype.markNextAppendedItem=function(a){this._maxItemGUID++;a.setAttribute(Gridifier.GUID.GUID_DATA_ATTR,this._maxItemGUID);return this._maxItemGUID};Gridifier.GUID.prototype.markNextPrependedItem=function(a){this._minItemGUID--;a.setAttribute(Gridifier.GUID.GUID_DATA_ATTR,this._minItemGUID);return this._minItemGUID};Gridifier.Normalizer=function(a,b){var c=this;this._gridifier=null;this._sizesResolverManager=null;this._roundingNormalizationValue=1;this._itemWidthAntialiasPercentageValue=0;this._itemHeightAntialiasPercentageValue=0;this._css={};this._construct=function(){c._gridifier=a;c._sizesResolverManager=b;c.setItemWidthAntialiasPercentageValue(c._itemWidthAntialiasPercentageValue);c.setItemHeightAntialiasPercentageValue(c._itemHeightAntialiasPercentageValue)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Normalizer.prototype.normalizeLowRounding=function(a){return a-this._roundingNormalizationValue};Gridifier.Normalizer.prototype.normalizeHighRounding=function(a){return a+this._roundingNormalizationValue};Gridifier.Normalizer.prototype.setItemWidthAntialiasPercentageValue=function(a){this._itemWidthAntialiasPercentageValue=a;this.updateItemWidthAntialiasPxValue()};Gridifier.Normalizer.prototype.setItemHeightAntialiasPercentageValue=function(a){this._itemHeightAntialiasPercentageValue=a;this.updateItemHeightAntialiasPxValue()};Gridifier.Normalizer.prototype.updateItemWidthAntialiasPxValue=function(){if(this._itemWidthAntialiasPercentageValue==0){this._sizesResolverManager.setOuterWidthAntialiasValue(0);return}var a=(this._gridifier.getGridX2()+1)*(this._itemWidthAntialiasPercentageValue/100);this._sizesResolverManager.setOuterWidthAntialiasValue(a)};Gridifier.Normalizer.prototype.updateItemHeightAntialiasPxValue=function(){if(this._itemHeightAntialiasPercentageValue==0){this._sizesResolverManager.setOuterHeightAntialiasValue(0);return}var a=(this._gridifier.getGridY2()+1)*(this._itemHeightAntialiasPercentageValue/100);this._sizesResolverManager.setOuterHeightAntialiasValue(a)};Gridifier.Normalizer.prototype.updateItemAntialiasValues=function(){this.updateItemWidthAntialiasPxValue();this.updateItemHeightAntialiasPxValue()};Gridifier.Operation=function(){var a=this;this._lastOperation=null;this._css={};this._construct=function(){};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){a._unbindEvents()};this._construct();return this};Gridifier.Operation.prototype.isInitialOperation=function(a){if(this._lastOperation==null){this._lastOperation=a;return true}return false};Gridifier.Operation.prototype.isCurrentOperationSameAsPrevious=function(a){if(this._lastOperation!=a){this._lastOperation=a;return false}return true};Gridifier.Operation.prototype.setLastOperation=function(a){this._lastOperation=a};Gridifier.Resorter=function(a,b,c,d,e){var f=this;this._gridifier=null;this._collector=null;this._connections=null;this._settings=null;this._guid=null;this._css={};this._construct=function(){f._gridifier=a;f._collector=b;f._connections=c;f._settings=d;f._guid=e};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){f._unbindEvents()};this._construct();return this};Gridifier.Resorter.prototype.resort=function(){var a=this._collector.sortCollection(this._collector.collectAllConnectedItems());if(this._settings.isCustomAllEmptySpaceSortDispersion()){if(this._settings.isHorizontalGrid()){this._resortAllHorizontalGridConnectionsPerReappend(a)}else if(this._settings.isVerticalGrid()){this._resortAllVerticalGridConnectionsPerReappend(a)}}this._guid.reinit();for(var b=0;b<a.length;b++){this._guid.markNextAppendedItem(a[b])}};Gridifier.Resorter.prototype._resortAllHorizontalGridConnectionsPerReappend=function(a){var b=0;for(var c=0;c<a.length;c++){var d=this._connections.findConnectionByItem(a[c]);d.x1=b;d.x2=b;d.y1=0;d.y2=0;b++}};Gridifier.Resorter.prototype._resortAllVerticalGridConnectionsPerReappend=function(a){var b=0;for(var c=0;c<a.length;c++){var d=this._connections.findConnectionByItem(a[c]);d.x1=0;d.x2=0;d.y1=b;d.y2=b;b++}};Gridifier.SizesResolverManager=function(){var a=this;this._outerWidthCache=[];this._outerHeightCache=[];this._nextCachedItemGUIDPerOuterWidth=0;this._nextCachedItemGUIDPerOuterHeight=0;this._isCachingTransactionActive=false;this._outerWidthAntialiasValue=0;this._outerHeightAntialiasValue=0;this._css={};this._construct=function(){};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){a._unbindEvents()};this._construct();return this};Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_ITEM_GUID_DATA_ATTR="data-gridifier-cached-per-outerwidth-guid";Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_ITEM_GUID_DATA_ATTR="data-gridifier-cached-per-outerheight-guid";Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_DATA_ATTR="data-gridifier-cached-per-outerwidth";Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_DATA_ATTR="data-gridifier-cached-per-outerheight";Gridifier.SizesResolverManager.EMPTY_DATA_ATTR_VALUE="gridifier-empty-data";Gridifier.SizesResolverManager.prototype.setOuterWidthAntialiasValue=function(a){this._outerWidthAntialiasValue=a};Gridifier.SizesResolverManager.prototype.setOuterHeightAntialiasValue=function(a){this._outerHeightAntialiasValue=a};Gridifier.SizesResolverManager.prototype._markAsCachedPerOuterWidth=function(a,b){a.setAttribute(Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_DATA_ATTR,Gridifier.SizesResolverManager.EMPTY_DATA_ATTR_VALUE);a.setAttribute(Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_ITEM_GUID_DATA_ATTR,b)};Gridifier.SizesResolverManager.prototype._markAsCachedPerOuterHeight=function(a,b){a.setAttribute(Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_DATA_ATTR,Gridifier.SizesResolverManager.EMPTY_DATA_ATTR_VALUE);a.setAttribute(Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_ITEM_GUID_DATA_ATTR,b)};Gridifier.SizesResolverManager.prototype.unmarkAsCached=function(a){if(Dom.hasAttribute(a,Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_DATA_ATTR))a.removeAttribute(Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_DATA_ATTR);if(Dom.hasAttribute(a,Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_ITEM_GUID_DATA_ATTR))a.removeAttribute(Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_ITEM_GUID_DATA_ATTR);if(Dom.hasAttribute(a,Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_DATA_ATTR))a.removeAttribute(Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_DATA_ATTR);if(Dom.hasAttribute(a,Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_ITEM_GUID_DATA_ATTR))a.removeAttribute(Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_ITEM_GUID_DATA_ATTR)};Gridifier.SizesResolverManager.prototype._getOuterWidthCachedItemEntry=function(a){var b=Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_ITEM_GUID_DATA_ATTR;var c=a.getAttribute(b);for(var d=0;d<this._outerWidthCache.length;d++){if(parseInt(this._outerWidthCache[d].cachedItemGUID)==parseInt(c))return this._outerWidthCache[d]}};Gridifier.SizesResolverManager.prototype._getOuterHeightCachedItemEntry=function(a){var b=Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_ITEM_GUID_DATA_ATTR;var c=a.getAttribute(b);for(var d=0;d<this._outerHeightCache.length;d++){if(parseInt(this._outerHeightCache[d].cachedItemGUID)==parseInt(c))return this._outerHeightCache[d]}};Gridifier.SizesResolverManager.prototype._isOuterWidthCallWithSuchParamsCached=function(a,b){if(!Dom.hasAttribute(a,Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_DATA_ATTR))return false;var c=this._getOuterWidthCachedItemEntry(a);if(b)return c.cachedReturnedValues.withIncludeMarginsParam!=null?true:false;else return c.cachedReturnedValues.withoutIncludeMarginsParam!=null?true:false};Gridifier.SizesResolverManager.prototype._isOuterHeightCallWithSuchParamsCached=function(a,b){if(!Dom.hasAttribute(a,Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_DATA_ATTR))return false;var c=this._getOuterHeightCachedItemEntry(a);if(b)return c.cachedReturnedValues.withIncludeMarginsParam!=null?true:false;else return c.cachedReturnedValues.withoutIncludeMarginsParam?true:false};Gridifier.SizesResolverManager.prototype.startCachingTransaction=function(){this._isCachingTransactionActive=true};Gridifier.SizesResolverManager.prototype.stopCachingTransaction=function(){this._isCachingTransactionActive=false;for(var a=0;a<this._outerWidthCache.length;a++)this.unmarkAsCached(this._outerWidthCache[a].DOMElem);for(var a=0;a<this._outerHeightCache.length;a++)this.unmarkAsCached(this._outerHeightCache[a].DOMElem);this._outerWidthCache=[];this._outerHeightCache=[];this._nextCachedItemGUIDPerOuterWidth=0;this._nextCachedItemGUIDPerOuterHeight=0};Gridifier.SizesResolverManager.prototype.outerWidth=function(a,b,c,d,e,f){var c=c||false;var f=f||false;if(!this._isCachingTransactionActive){return this._callRealOuterWidth(a,b,c,d,e,f)}if(this._isOuterWidthCallWithSuchParamsCached(a,b)){var g=this._getOuterWidthCachedItemEntry(a);if(b)return g.cachedReturnedValues.withIncludeMarginsParam;else return g.cachedReturnedValues.withoutIncludeMarginsParam}var h=this._callRealOuterWidth(a,b,c,d,e,f);if(Dom.hasAttribute(a,Gridifier.SizesResolverManager.CACHED_PER_OUTERWIDTH_DATA_ATTR)){var g=this._getOuterWidthCachedItemEntry(a);if(b)g.cachedReturnedValues.withIncludeMarginsParam=h;else g.cachedReturnedValues.withoutIncludeMarginsParam=h}else{this._nextCachedItemGUIDPerOuterWidth++;this._markAsCachedPerOuterWidth(a,this._nextCachedItemGUIDPerOuterWidth);var i={};i.withIncludeMarginsParam=b?h:null;i.withoutIncludeMarginsParam=!b?h:null;this._outerWidthCache.push({cachedItemGUID:this._nextCachedItemGUIDPerOuterWidth,DOMElem:a,cachedReturnedValues:i})}return h};Gridifier.SizesResolverManager.prototype._callRealOuterWidth=function(a,b,c,d,e,f){var g=this;var h=SizesResolver.recalculatePercentageWidthFunction;SizesResolver.recalculatePercentageWidthFunction=function(a,b,c,d){return g.outerWidth(a,b,true,c,d,true)};if(!f)SizesResolver.clearRecursiveSubcallsData();var i=SizesResolver.outerWidth(a,b,d,e);if(!c)i-=this._outerWidthAntialiasValue;SizesResolver.recalculatePercentageWidthFunction=h;return i};Gridifier.SizesResolverManager.prototype.outerHeight=function(a,b,c,d,e,f){var c=c||false;var f=f||false;if(!this._isCachingTransactionActive){return this._callRealOuterHeight(a,b,c,d,e,f)}if(this._isOuterHeightCallWithSuchParamsCached(a,b)){var g=this._getOuterHeightCachedItemEntry(a);if(b)return g.cachedReturnedValues.withIncludeMarginsParam;else return g.cachedReturnedValues.withoutIncludeMarginsParam}var h=this._callRealOuterHeight(a,b,c,d,e,f);if(Dom.hasAttribute(a,Gridifier.SizesResolverManager.CACHED_PER_OUTERHEIGHT_DATA_ATTR)){var g=this._getOuterHeightCachedItemEntry(a);if(b)g.cachedReturnedValues.withIncludeMarginsParam=h;else g.cachedReturnedValues.withoutIncludeMarginsParam=h}else{this._nextCachedItemGUIDPerOuterHeight++;this._markAsCachedPerOuterHeight(a,this._nextCachedItemGUIDPerOuterHeight);var i={};i.withIncludeMarginsParam=b?h:null;i.withoutIncludeMarginsParam=!b?h:null;this._outerHeightCache.push({cachedItemGUID:this._nextCachedItemGUIDPerOuterHeight,DOMElem:a,cachedReturnedValues:i})}return h};Gridifier.SizesResolverManager.prototype._callRealOuterHeight=function(a,b,c,d,e,f){var g=this;var h=SizesResolver.recalculatePercentageWidthFunction;var i=SizesResolver.recalculatePercentageHeightFunction;SizesResolver.recalculatePercentageWidthFunction=function(a,b,c,d){return g.outerWidth(a,b,true,c,d,true)};SizesResolver.recalculatePercentageHeightFunction=function(a,b,c,d){return g.outerHeight(a,b,true,c,d,true)};if(!f)SizesResolver.clearRecursiveSubcallsData();var j=SizesResolver.outerHeight(a,b,d,e);if(!c)j-=this._outerHeightAntialiasValue;SizesResolver.recalculatePercentageWidthFunction=h;SizesResolver.recalculatePercentageHeightFunction=i;return j};Gridifier.SizesResolverManager.prototype.positionTop=function(a){return SizesResolver.positionTop(a)};Gridifier.SizesResolverManager.prototype.positionLeft=function(a){return SizesResolver.positionLeft(a)};Gridifier.SizesResolverManager.prototype.offsetLeft=function(a,b){var b=b||false;if(b){var c=this.outerWidth(a);var d=this.outerWidth(a,true);var e=d-c;var f=e/2;var g=SizesResolver.offsetLeft(a)-f}else{var g=SizesResolver.offsetLeft(a)}return g};Gridifier.SizesResolverManager.prototype.offsetTop=function(a,b){var b=b||false;if(b){var c=this.outerHeight(a);var d=this.outerHeight(a,true);var e=d-c;var f=e/2;var g=SizesResolver.offsetTop(a)-f}else{var g=SizesResolver.offsetTop(a)}return g};Gridifier.Discretizer=function(a,b,c,d){var e=this;this._gridifier=null;this._connections=null;this._settings=null;this._sizesResolverManager=null;this._discretizerCore=null;this._discretizationDemonstrator=null;this._showDemonstrator=false;this._cells=[];this._css={};this._construct=function(){e._gridifier=a;e._connections=b;e._settings=c;e._sizesResolverManager=d;if(e._settings.isVerticalGrid()){e._discretizerCore=new Gridifier.Discretizer.VerticalCore(e._gridifier,e._settings,e._sizesResolverManager)}else if(e._settings.isHorizontalGrid()){e._discretizerCore=new Gridifier.Discretizer.HorizontalCore(e._gridifier,e._settings,e._sizesResolverManager)}if(e._showDemonstrator){e._discretizationDemonstrator=new Gridifier.Discretizer.Demonstrator(e._gridifier,e._settings)}else{e._discretizationDemonstrator={create:function(){return},update:function(){return},"delete":function(){return}}}e._bindEvents()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){e._unbindEvents()};this._construct();return this};Gridifier.Discretizer.IS_INTERSECTED_BY_ITEM="isIntersectedByItem";Gridifier.Discretizer.CELL_CENTER_X="centerX";Gridifier.Discretizer.CELL_CENTER_Y="centerY";Gridifier.Discretizer.prototype.discretizeGrid=function(){var a=this._connections.getMinConnectionWidth();var b=this._connections.getMinConnectionHeight();if(this._settings.isDefaultAppend()){this._cells=this._discretizerCore.discretizeGridWithDefaultAppend(a,b)}else if(this._settings.isReversedAppend()){this._cells=this._discretizerCore.discretizeGridWithReversedAppend(a,b)}};Gridifier.Discretizer.prototype.intersectedCellsToCoords=function(a){var b={x1:a[0].x1,x2:a[0].x2,y1:a[0].y1,y2:a[0].y2};for(var c=1;c<a.length;c++){if(a[c].x1<b.x1)b.x1=a[c].x1;if(a[c].x2>b.x2)b.x2=a[c].x2;if(a[c].y1<b.y1)b.y1=a[c].y1;if(a[c].y2>b.y2)b.y2=a[c].y2}return b};Gridifier.Discretizer.prototype.markCellsIntersectedByItem=function(a,b){for(var c=0;c<this._cells.length;c++){for(var d=0;d<this._cells[c].length;d++){var e={x1:this._cells[c][d][Gridifier.Discretizer.CELL_CENTER_X],x2:this._cells[c][d][Gridifier.Discretizer.CELL_CENTER_X],y1:this._cells[c][d][Gridifier.Discretizer.CELL_CENTER_Y],y2:this._cells[c][d][Gridifier.Discretizer.CELL_CENTER_Y]};if(this._isCellIntersectedBy(e,b))this._cells[c][d][Gridifier.Discretizer.IS_INTERSECTED_BY_ITEM]=true;else this._cells[c][d][Gridifier.Discretizer.IS_INTERSECTED_BY_ITEM]=false}}};Gridifier.Discretizer.prototype.getAllCellsWithIntersectedCenterData=function(a){var b=[];var c=0;var d=0;var e=[];var f=function(a){for(var b=0;b<e.length;b++){if(e[b]==a)return true}return false};for(var g=0;g<this._cells.length;g++){var h=false;var i=[];for(var j=0;j<this._cells[g].length;j++){var k={x1:this._cells[g][j][Gridifier.Discretizer.CELL_CENTER_X],x2:this._cells[g][j][Gridifier.Discretizer.CELL_CENTER_X],y1:this._cells[g][j][Gridifier.Discretizer.CELL_CENTER_Y],y2:this._cells[g][j][Gridifier.Discretizer.CELL_CENTER_Y]};if(this._isCellIntersectedBy(k,a)){i.push(this._cells[g][j]);if(!h){c++;h=true}if(!f(j)){d++;e.push(j)}}}if(i.length>0)b.push(i)}return{cellsWithIntersectedCenter:b,intersectedRowsCount:c,intersectedColsCount:d}};Gridifier.Discretizer.prototype._isCellIntersectedBy=function(a,b){var c=b.y1<a.y1&&b.y2<a.y1;var d=b.y1>a.y2&&b.y2>a.y2;var e=b.x1<a.x1&&b.x2<a.x1;var f=b.x1>a.x2&&b.x2>a.x2;if(!c&&!d&&!e&&!f)return true;else return false};Gridifier.Discretizer.prototype.normalizeItemNewConnectionHorizontalCoords=function(a,b){return this._discretizerCore.normalizeItemNewConnectionHorizontalCoords(a,b)};Gridifier.Discretizer.prototype.normalizeItemNewConnectionVerticalCoords=function(a,b){return this._discretizerCore.normalizeItemNewConnectionVerticalCoords(a,b)};Gridifier.Discretizer.prototype.createDemonstrator=function(){this._discretizationDemonstrator.create(this._cells)};Gridifier.Discretizer.prototype.updateDemonstrator=function(){this._discretizationDemonstrator.update(this._cells)};Gridifier.Discretizer.prototype.deleteDemonstrator=function(){this._discretizationDemonstrator["delete"].call(this)};Gridifier.Discretizer.Demonstrator=function(a,b){var c=this;this._gridifier=null;this._settings=null;this._demonstrator=null;this._css={};this._construct=function(){c._gridifier=a;c._settings=b;c._bindEvents()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Discretizer.Demonstrator.prototype.create=function(a){this._createDemonstrator();this._decorateDemonstrator();this._bindDemonstratorDeleteOnClick();this._createCells(a)};Gridifier.Discretizer.Demonstrator.prototype._createDemonstrator=function(){this._demonstrator=document.createElement("div");this._gridifier.getGrid().appendChild(this._demonstrator);Dom.css.set(this._demonstrator,{width:this._gridifier.getGridX2()+1+"px",height:this._gridifier.getGridY2()+1+"px",position:"absolute",left:"0px",top:"0px"})};Gridifier.Discretizer.Demonstrator.prototype._decorateDemonstrator=function(){Dom.css.set(this._demonstrator,{background:"rgb(235,235,235)",zIndex:"100",opacity:"0.8"})};Gridifier.Discretizer.Demonstrator.prototype._bindDemonstratorDeleteOnClick=function(){var a=this;$(this._demonstrator).on("click",function(){$(this).off("click");a["delete"].call(a)})};Gridifier.Discretizer.Demonstrator.prototype.update=function(a){if(this._demonstrator!=null)this["delete"].call(this);this.create(a)};Gridifier.Discretizer.Demonstrator.prototype["delete"]=function(){if(this._demonstrator==null)return;this._demonstrator.parentNode.removeChild(this._demonstrator);this._demonstrator=null};Gridifier.Discretizer.Demonstrator.prototype._createCells=function(a){var b=["gridFirstBorderColor","gridSecondBorderColor","gridThirdBorderColor","gridFourthBorderColor","gridFifthBorderColor"];var c=-1;for(var d=0;d<a.length;d++){for(var e=0;e<a[d].length;e++){var f=document.createElement("div");var g=a[d][e].x2-a[d][e].x1+1;var h=a[d][e].y2-a[d][e].y1+1;c++;if(c==5){b.reverse();c=0}f.setAttribute("class",b[c]);Dom.css.set(f,{position:"absolute",boxSizing:"border-box",left:a[d][e].x1+"px",top:a[d][e].y1+"px",width:g+"px",height:h+"px",border:"5px dashed"});if(a[d][e][Gridifier.Discretizer.IS_INTERSECTED_BY_ITEM]){f.style.background="red";f.style.opacity="1"}this._demonstrator.appendChild(f);var i=document.createElement("div");Dom.css.set(i,{position:"absolute",left:a[d][e][Gridifier.Discretizer.CELL_CENTER_X]+"px",top:a[d][e][Gridifier.Discretizer.CELL_CENTER_Y]+"px",width:"5px",height:"5px",background:"black"});this._demonstrator.appendChild(i)}}};Gridifier.Dragifier=function(a,b,c,d,e,f,g,h){var i=this;this._gridifier=null;this._appender=null;this._reversedAppender=null;this._connections=null;this._connectors=null;this._guid=null;this._settings=null;this._sizesResolverManager=null;this._draggableItems=[];this._isDragging=false;this._css={};this._construct=function(){i._gridifier=a;i._appender=b;i._reversedAppender=c;i._connections=d;i._connectors=e;i._guid=f;i._settings=g;i._sizesResolverManager=h;if(i._settings.shouldEnableDragifierOnInit()){i._bindEvents()}};this._bindEvents=function(){var a=i._settings.getDragifierItemSelector();$(i._gridifier.getGrid()).on("touchstart",a,function(a){a.preventDefault();i._sizesResolverManager.startCachingTransaction();i._isDragging=true;if(i._isAlreadyDraggable($(this).get(0))){var b=a.originalEvent.changedTouches[0];var c=i._findAlreadyDraggableItem($(this).get(0));c.addDragIdentifier(b.identifier);return}var d=i._createDraggableItem();var e=a.originalEvent.changedTouches[0];d.bindDraggableItem($(this).get(0),e.pageX,e.pageY);d.addDragIdentifier(e.identifier);i._draggableItems.push(d)});$("body").on("touchend",a,function(a){if(!i._isDragging)return;a.preventDefault();setTimeout(function(){if(!i._isDragging)return;var b=a.originalEvent.changedTouches;for(var c=0;c<b.length;c++){var d=i._findDraggableItemByIdentifier(b[c].identifier,true);if(d.item==null)continue;d.item.removeDragIdentifier(b[c].identifier);if(d.item.getDragIdentifiersCount()==0){d.item.unbindDraggableItem();i._draggableItems.splice(d.itemIndex,1)}}if(i._draggableItems.length==0){i._isDragging=false;i._sizesResolverManager.stopCachingTransaction()}},0)});$("body").on("touchmove",function(a){if(!i._isDragging)return;a.preventDefault();setTimeout(function(){if(!i._isDragging)return;var b=a.originalEvent.changedTouches;for(var c=0;c<b.length;c++){var d=i._findDraggableItemByIdentifier(b[c].identifier);if(d==null)continue;d.processDragMove(b[c].pageX,b[c].pageY)}},0)});$(i._gridifier.getGrid()).on("mousedown",a,function(a){a.preventDefault();i._sizesResolverManager.startCachingTransaction();i._isDragging=true;var b=i._createDraggableItem();b.bindDraggableItem($(this).get(0),a.pageX,a.pageY);i._draggableItems.push(b)});$("body").on("mouseup.gridifier.dragifier",function(){setTimeout(function(){if(!i._isDragging)return;i._draggableItems[0].unbindDraggableItem();i._draggableItems.splice(0,1);i._isDragging=false;i._sizesResolverManager.stopCachingTransaction()},0)});$("body").on("mousemove.gridfier.dragifier",function(a){setTimeout(function(){if(!i._isDragging)return;i._draggableItems[0].processDragMove(a.pageX,a.pageY)},0)})};this._unbindEvents=function(){};this.destruct=function(){i._unbindEvents()};this._construct();return this};Gridifier.Dragifier.prototype._createDraggableItem=function(){if(this._settings.isDisabledSortDispersion()){var a=new Gridifier.Dragifier.ConnectionIntersectionDraggableItem(this._gridifier,this._appender,this._reversedAppender,this._connections,this._connectors,this._guid,this._settings,this._sizesResolverManager)}else if(this._settings.isCustomAllEmptySpaceSortDispersion()){var a=new Gridifier.Dragifier.GridDiscretizationDraggableItem(this._gridifier,this._appender,this._reversedAppender,this._connections,this._connectors,this._guid,this._settings,this._sizesResolverManager)}return a};Gridifier.Dragifier.prototype._isAlreadyDraggable=function(a){for(var b=0;b<this._draggableItems.length;b++){var c=this._draggableItems[b].getDraggableItem();if(this._guid.getItemGUID(c)==this._guid.getItemGUID(a))return true}return false};Gridifier.Dragifier.prototype._findAlreadyDraggableItem=function(a){for(var b=0;b<this._draggableItems.length;b++){var c=this._draggableItems[b].getDraggableItem();if(this._guid.getItemGUID(c)==this._guid.getItemGUID(a))return this._draggableItems[b]}throw new Error("Draggable item not found")};Gridifier.Dragifier.prototype._findDraggableItemByIdentifier=function(a,b){var b=b||false;var c=null;var d=null;for(var e=0;e<this._draggableItems.length;e++){if(this._draggableItems[e].hasDragIdentifier(a)){c=this._draggableItems[e];d=e;break}}if(b){return{item:c,itemIndex:d}}else{return c}};Gridifier.Dragifier.Core=function(a,b,c,d,e,f,g){var h=this;this._gridifier=null;this._appender=null;this._reversedAppender=null;this._connectors=null;this._settings=null;this._dragifierRenderer=null;this._sizesResolverManager=null;this._cursorOffsetXFromDraggableItemCenter=null;this._cursorOffsetYFromDraggableItemCenter=null;this._gridOffsetLeft=null;this._gridOffsetTop=null;this._css={};this._construct=function(){h._gridifier=a;h._appender=b;h._reversedAppender=c;h._connectors=d;h._settings=e;h._dragifierRenderer=f;h._sizesResolverManager=g;h._bindEvents()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){h._unbindEvents()};this._construct();return this};Gridifier.Dragifier.Core.prototype.determineInitialCursorOffsetsFromDraggableItemCenter=function(a,b,c){var d=this._sizesResolverManager.offsetLeft(a);var e=this._sizesResolverManager.offsetTop(a);var f=this._sizesResolverManager.outerWidth(a,true);var g=this._sizesResolverManager.outerHeight(a,true);var h=d+f/2;var i=e+g/2;this._cursorOffsetXFromDraggableItemCenter=h-b;this._cursorOffsetYFromDraggableItemCenter=i-c};Gridifier.Dragifier.Core.prototype.determineGridOffsets=function(){this._gridOffsetLeft=this._sizesResolverManager.offsetLeft(this._gridifier.getGrid());this._gridOffsetTop=this._sizesResolverManager.offsetTop(this._gridifier.getGrid())};Gridifier.Dragifier.Core.prototype.createDraggableItemClone=function(a){var b=a.cloneNode(true);b.style.setProperty("background","rgb(235,235,235)","important");Dom.css3.transition(b,"All 0ms ease");b.style.zIndex=10;var c=this._sizesResolverManager.outerWidth(a);var d=this._sizesResolverManager.outerHeight(a);b.style.width=c+"px";b.style.height=d+"px";b.style.margin="0px";document.body.appendChild(b);var e=this._sizesResolverManager.offsetLeft(a);var f=this._sizesResolverManager.offsetTop(a);b.style.left=e+"px";b.style.top=f+"px";this._dragifierRenderer.render(b,e,f);return b};Gridifier.Dragifier.Core.prototype.createDraggableItemPointer=function(a){var b=this._sizesResolverManager.offsetLeft(a,true);var c=this._sizesResolverManager.offsetTop(a,true);var d=document.createElement("div");Dom.css.set(d,{width:this._sizesResolverManager.outerWidth(a,true)+"px",height:this._sizesResolverManager.outerHeight(a,true)+"px",position:"absolute",left:b-this._gridOffsetLeft+"px",top:c-this._gridOffsetTop+"px",background:"red"});this._gridifier.getGrid().appendChild(d);this._dragifierRenderer.render(d,b-this._gridOffsetLeft,c-this._gridOffsetTop);return d};Gridifier.Dragifier.Core.prototype.calculateDraggableItemCloneNewDocumentPosition=function(a,b,c){var d=this._sizesResolverManager.outerWidth(a,true)/2;var e=this._sizesResolverManager.outerHeight(a,true)/2;return{x:b-d-this._cursorOffsetXFromDraggableItemCenter*-1,y:c-e-this._cursorOffsetYFromDraggableItemCenter*-1}};Gridifier.Dragifier.Core.prototype.calculateDraggableItemCloneNewGridPosition=function(a,b){var c={x1:b.x,x2:b.x+this._sizesResolverManager.outerWidth(a,true)-1,y1:b.y,y2:b.y+this._sizesResolverManager.outerHeight(a,true)-1};c.x1-=this._gridOffsetLeft;c.x2-=this._gridOffsetLeft;c.y1-=this._gridOffsetTop;c.y2-=this._gridOffsetTop;return c};Gridifier.Dragifier.Core.prototype.reappendGridItems=function(){var a=this;if(this._settings.isDefaultAppend()){this._connectors.setNextFlushCallback(function(){a._appender.createInitialConnector()})}else if(this._settings.isReversedAppend()){this._connectors.setNextFlushCallback(function(){a._reversedAppender.createInitialConnector()})}this._gridifier.retransformAllSizes()};Gridifier.Dragifier.Renderer=function(a){var b=this;this._settings=null;this._renderFunction=null;this._css={};this._construct=function(){b._settings=a;b._setTransitionRenderFunction();b._bindEvents()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.Dragifier.Renderer.prototype._setTransitionRenderFunction=function(){this._renderFunction=function(a,b,c){var b=parseFloat(b);var c=parseFloat(c);var d=parseFloat(a.style.left);var e=parseFloat(a.style.top);if(b>d)var f=b-d;else if(b<d)var f=(d-b)*-1;else var f=0;
if(c>e)var g=c-e;else if(c<e)var g=(e-c)*-1;else var g=0;Dom.css3.transformProperty(a,"translate3d",f+"px,"+g+"px, 0px")}};Gridifier.Dragifier.Renderer.prototype.render=function(a,b,c){this._renderFunction(a,b,c)};Gridifier.Dragifier.ConnectionIntersectionDraggableItem=function(a,b,c,d,e,f,g,h){var i=this;this._gridifier=null;this._appender=null;this._reversedAppender=null;this._connections=null;this._connectors=null;this._connectionsIntersector=null;this._guid=null;this._settings=null;this._sizesResolverManager=null;this._dragifierCore=null;this._dragifierRenderer=null;this._dragIdentifiers=[];this._draggableItem=null;this._draggableItemClone=null;this._css={};this._construct=function(){i._gridifier=a;i._appender=b;i._reversedAppender=c;i._connections=d;i._connectors=e;i._guid=f;i._settings=g;i._sizesResolverManager=h;i._dragIdentifiers=[];i._connectionsIntersector=new Gridifier.VerticalGrid.ConnectionsIntersector(i._connections);i._dragifierRenderer=new Gridifier.Dragifier.Renderer(i._settings);i._dragifierCore=new Gridifier.Dragifier.Core(i._gridifier,i._appender,i._reversedAppender,i._connectors,i._settings,i._dragifierRenderer,i._sizesResolverManager);i._bindEvents()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){i._unbindEvents()};this._construct();return this};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype.bindDraggableItem=function(a,b,c){this._initDraggableItem(a);this._dragifierCore.determineInitialCursorOffsetsFromDraggableItemCenter(this._draggableItem,b,c);this._dragifierCore.determineGridOffsets();this._draggableItemClone=this._dragifierCore.createDraggableItemClone(this._draggableItem);this._hideDraggableItem()};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype.getDraggableItem=function(){return this._draggableItem};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype.addDragIdentifier=function(a){this._dragIdentifiers.push(a)};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype.hasDragIdentifier=function(a){for(var b=0;b<this._dragIdentifiers.length;b++){if(this._dragIdentifiers[b]==a)return true}return false};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype.removeDragIdentifier=function(a){for(var b=0;b<this._dragIdentifiers.length;b++){if(this._dragIdentifiers[b]==a){this._dragIdentifiers.splice(b,1);break}}};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype.getDragIdentifiersCount=function(){return this._dragIdentifiers.length};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype._initDraggableItem=function(a){this._draggableItem=a;Dom.css3.transitionProperty(this._draggableItem,"Visibility 0ms ease")};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype._hideDraggableItem=function(){this._draggableItem.style.visibility="hidden";Dom.css.addClass(document.body,"disableSelect")};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype.processDragMove=function(a,b){var c=this._dragifierCore.calculateDraggableItemCloneNewDocumentPosition(this._draggableItem,a,b);this._dragifierRenderer.render(this._draggableItemClone,c.x,c.y);var d=this._dragifierCore.calculateDraggableItemCloneNewGridPosition(this._draggableItem,c);var e=this._getNewIntersectedConnections(d);if(e.length==0)return;this._swapItemGUIDS(e);this._dragifierCore.reappendGridItems()};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype._getNewIntersectedConnections=function(a){var b=this._guid.getItemGUID(this._draggableItem);var c=this._connectionsIntersector.getAllConnectionsWithIntersectedCenter(a);var d=[];for(var e=0;e<c.length;e++){if(c[e].itemGUID!=b){d.push(c[e])}}return d};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype._swapItemGUIDS=function(a){var b=this._guid.getItemGUID(this._draggableItem);var c=a[0];for(var d=0;d<a.length;d++){if(a[d].itemGUID<c)c=a[d]}this._guid.setItemGUID(this._draggableItem,c.itemGUID);this._guid.setItemGUID(this._draggableItemClone,c.itemGUID);this._guid.setItemGUID(c.item,b)};Gridifier.Dragifier.ConnectionIntersectionDraggableItem.prototype.unbindDraggableItem=function(){document.body.removeChild(this._draggableItemClone);this._draggableItem.style.visibility="visible";this._draggableItem=null;this._draggableItem=null;Dom.css.removeClass(document.body,"disableSelect")};Gridifier.Dragifier.Cells=function(a){var b=this;this._discretizer=null;this._css={};this._construct=function(){b._discretizer=a;b._bindEvents()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.Dragifier.Cells.prototype.getIntersectedByDraggableItemCellCentersData=function(a){var b=this._discretizer.getAllCellsWithIntersectedCenterData(a);if(b.intersectedColsCount==0&&b.intersectedRowsCount==0){b.intersectedRowsCount=1;b.intersectedColsCount=1}return b};Gridifier.Dragifier.Cells.prototype.isAtLeastOneOfIntersectedCellCentersEmpty=function(a){var b=a.cellsWithIntersectedCenter;var c=false;for(var d=0;d<b.length;d++){for(var e=0;e<b[d].length;e++){if(!b[d][e][Gridifier.Discretizer.IS_INTERSECTED_BY_ITEM])c=true}}return c};Gridifier.Dragifier.Cells.prototype.isIntersectingEnoughRowsAndCols=function(a,b){if(b.intersectedRowsCount<a.intersectedRowsCount||b.intersectedColsCount<a.intersectedColsCount){return false}return true};Gridifier.Dragifier.Cells.prototype.normalizeCellsWithMaybeIntersectionOverflows=function(a,b,c){if(c.intersectedRowsCount>b.intersectedRowsCount){var d=c.intersectedRowsCount-b.intersectedRowsCount;for(var e=0;e<d;e++){a.pop()}}if(c.intersectedColsCount>b.intersectedColsCount){var f=c.intersectedColsCount-b.intersectedColsCount;for(var g=0;g<a.length;g++){for(var e=0;e<f;e++){a[g].pop()}}}var h=[];for(var g=0;g<a.length;g++){for(var i=0;i<a[g].length;i++){h.push(a[g][i])}}return h};Gridifier.Dragifier.GridDiscretizationDraggableItem=function(a,b,c,d,e,f,g,h){var i=this;this._gridifier=null;this._appender=null;this._reversedAppender=null;this._connections=null;this._connectors=null;this._guid=null;this._settings=null;this._sizesResolverManager=null;this._dragifierCore=null;this._discretizer=null;this._dragifierCells=null;this._dragifierRenderer=null;this._dragIdentifiers=[];this._draggableItem=null;this._draggableItemConnection=null;this._draggableItemClone=null;this._draggableItemPointer=null;this._css={};this._construct=function(){i._gridifier=a;i._appender=b;i._reversedAppender=c;i._connections=d;i._connectors=e;i._guid=f;i._settings=g;i._sizesResolverManager=h;i._dragIdentifiers=[];i._dragifierRenderer=new Gridifier.Dragifier.Renderer(i._settings);i._dragifierCore=new Gridifier.Dragifier.Core(i._gridifier,i._appender,i._reversedAppender,i._connectors,i._settings,i._dragifierRenderer,i._sizesResolverManager);i._discretizer=new Gridifier.Discretizer(i._gridifier,i._connections,i._settings,i._sizesResolverManager);i._dragifierCells=new Gridifier.Dragifier.Cells(i._discretizer);i._bindEvents()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){i._unbindEvents()};this._construct();return this};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype.bindDraggableItem=function(a,b,c){this._initDraggableItem(a);this._initDraggableItemConnection();this._dragifierCore.determineInitialCursorOffsetsFromDraggableItemCenter(this._draggableItem,b,c);this._dragifierCore.determineGridOffsets();this._draggableItemClone=this._dragifierCore.createDraggableItemClone(this._draggableItem);this._draggableItemPointer=this._dragifierCore.createDraggableItemPointer(this._draggableItem);this._discretizer.discretizeGrid();this._discretizer.markCellsIntersectedByItem(this._draggableItem,this._draggableItemConnection);this._discretizer.createDemonstrator();this._hideDraggableItem()};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype.getDraggableItem=function(){return this._draggableItem};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype.addDragIdentifier=function(a){this._dragIdentifiers.push(a)};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype.hasDragIdentifier=function(a){for(var b=0;b<this._dragIdentifiers.length;b++){if(this._dragIdentifiers[b]==a)return true}return false};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype.removeDragIdentifier=function(a){for(var b=0;b<this._dragIdentifiers.length;b++){if(this._dragIdentifiers[b]==a){this._dragIdentifiers.splice(b,1);break}}};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype.getDragIdentifiersCount=function(){return this._dragIdentifiers.length};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype._initDraggableItem=function(a){this._draggableItem=a;Dom.css3.transitionProperty(this._draggableItem,"Visibility 0ms ease")};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype._initDraggableItemConnection=function(){this._draggableItemConnection=this._connections.findConnectionByItem(this._draggableItem);this._draggableItemConnection[Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT]=true};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype._hideDraggableItem=function(){this._draggableItem.style.visibility="hidden";Dom.css.addClass(document.body,"disableSelect")};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype.processDragMove=function(a,b){var c=this._dragifierCore.calculateDraggableItemCloneNewDocumentPosition(this._draggableItem,a,b);this._dragifierRenderer.render(this._draggableItemClone,c.x,c.y);var d=this._dragifierCore.calculateDraggableItemCloneNewGridPosition(this._draggableItem,c);var e=this._dragifierCells.getIntersectedByDraggableItemCellCentersData(this._draggableItemConnection);var f=this._discretizer.getAllCellsWithIntersectedCenterData(d);if(!this._dragifierCells.isAtLeastOneOfIntersectedCellCentersEmpty(f))return;if(!this._dragifierCells.isIntersectingEnoughRowsAndCols(e,f))return;this._transformGrid(this._dragifierCells.normalizeCellsWithMaybeIntersectionOverflows(f.cellsWithIntersectedCenter,e,f));this._discretizer.updateDemonstrator()};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype._transformGrid=function(a){var b=this._discretizer.intersectedCellsToCoords(a);b=this._discretizer.normalizeItemNewConnectionHorizontalCoords(this._draggableItem,b);b=this._discretizer.normalizeItemNewConnectionVerticalCoords(this._draggableItem,b);this._adjustDraggableItemPositions(b);this._discretizer.markCellsIntersectedByItem(this._draggableItem,b);var c=this;setTimeout(function(){c._dragifierCore.reappendGridItems()},100)};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype._adjustDraggableItemPositions=function(a){this._draggableItemConnection.x1=a.x1;this._draggableItemConnection.x2=a.x2;this._draggableItemConnection.y1=a.y1;this._draggableItemConnection.y2=a.y2;var b=this._settings.getCoordsChanger();b(this._draggableItem,a.x1,a.y1);this._dragifierRenderer.render(this._draggableItemPointer,a.x1,a.y1)};Gridifier.Dragifier.GridDiscretizationDraggableItem.prototype.unbindDraggableItem=function(){document.body.removeChild(this._draggableItemClone);this._gridifier.getGrid().removeChild(this._draggableItemPointer);this._draggableItemConnection[Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT]=false;this._draggableItem.style.visibility="visible";this._draggableItem=null;this._discretizer.deleteDemonstrator();Dom.css.removeClass(document.body,"disableSelect")};Gridifier.ApiSettingsErrors=function(a,b){var c=this;this._error=null;this._isApiSettingsError=false;this._errorMsg="";this._css={};this._construct=function(){c._error=a;c._isApiSettingsError=false;c._errorMsg="";c._parseIfIsApiSettingsError(b)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.ApiSettingsErrors.prototype.isApiSettingsError=function(){return this._isApiSettingsError};Gridifier.ApiSettingsErrors.prototype.getErrorMessage=function(){return this._errorMsg};Gridifier.ApiSettingsErrors.prototype._parseIfIsApiSettingsError=function(a){var b=Gridifier.Error.ERROR_TYPES.SETTINGS;if(a==b.INVALID_ONE_OF_TOGGLE_PARAMS){this._markAsApiSettingsError();this._invalidOneOfToggleParamsError()}else if(a==b.INVALID_ONE_OF_SORT_FUNCTION_TYPES||a==b.INVALID_ONE_OF_FILTER_FUNCTION_TYPES||a==b.INVALID_ONE_OF_COORDS_CHANGER_FUNCTION_TYPES||a==b.INVALID_ONE_OF_SIZES_CHANGER_FUNCTION_TYPES){this._markAsApiSettingsError();if(a==b.INVALID_ONE_OF_SORT_FUNCTION_TYPES){var c="sort"}else if(a==b.INVALID_ONE_OF_FILTER_FUNCTION_TYPES){var c="filter"}else if(a==b.INVALID_ONE_OF_COORDS_CHANGER_FUNCTION_TYPES){var c="coordsChanger"}else if(a==b.INVALID_ONE_OF_SIZES_CHANGER_FUNCTION_TYPES){var c="sizesChanger"}this._invalidOneOfFunctionTypesError(c)}else if(a==b.INVALID_TOGGLE_PARAM_VALUE||a==b.INVALID_SORT_PARAM_VALUE||a==b.INVALID_FILTER_PARAM_VALUE||a==b.INVALID_COORDS_CHANGER_PARAM_VALUE||a==b.INVALID_SIZES_CHANGER_PARAM_VALUE){this._markAsApiSettingsError();if(a==b.INVALID_TOGGLE_PARAM_VALUE){var c="toggle"}else if(a==b.INVALID_SORT_PARAM_VALUE){var c="sort"}else if(a==b.INVALID_FILTER_PARAM_VALUE){var c="filter"}else if(a==b.INVALID_COORDS_CHANGER_PARAM_VALUE){var c="coordsChanger"}else if(a==b.INVALID_SIZES_CHANGER_PARAM_VALUE){var c="sizesChanger"}this._invalidParamValueError(c)}else if(a==b.SET_TOGGLE_INVALID_PARAM||a==b.SET_FILTER_INVALID_PARAM||a==b.SET_SORT_INVALID_PARAM||a==b.SET_COORDS_CHANGER_INVALID_PARAM||a==b.SET_SIZES_CHANGER_INVALID_PARAM){this._markAsApiSettingsError();if(a==b.SET_TOGGLE_INVALID_PARAM){var d="toggle"}else if(a==b.SET_FILTER_INVALID_PARAM){var d="filter"}else if(a==b.SET_SORT_INVALID_PARAM){var d="sort"}else if(a==b.SET_COORDS_CHANGER_INVALID_PARAM){var d="coordsChanger"}else if(a==b.SET_SIZES_CHANGER_INVALID_PARAM){var d="sizesChanger"}this._invalidSetterParamError(d)}};Gridifier.ApiSettingsErrors.prototype._markAsApiSettingsError=function(){this._isApiSettingsError=true};Gridifier.ApiSettingsErrors.prototype._invalidOneOfToggleParamsError=function(){var a=this._error.getErrorMsgPrefix();a+="Wrong one of the 'toggle' params. It must be an object with show and hide function definitions.";a+=" Got: '"+this._error.getErrorParam()+"'.";this._errorMsg=a};Gridifier.ApiSettingsErrors.prototype._invalidOneOfFunctionTypesError=function(a){var b=this._error.getErrorMsgPrefix();b+="Wrong one of the '"+a+"' functions. It must be a function. Got: '"+this._error.getErrorParam()+"'.";this._errorMsg=b};Gridifier.ApiSettingsErrors.prototype._invalidParamValueError=function(a){var b=this._error.getErrorMsgPrefix();b+="Wrong '"+a+"' param value. It must be a function(which will be used by default), ";b+="or an object with key(function name)-value(function body) pairs. Got: '"+this._error.getErrorParam()+"'.";this._errorMsg=b};Gridifier.ApiSettingsErrors.prototype._invalidSetterParamError=function(a){var b=this._error.getErrorMsgPrefix();b+="Can't set '"+a+"' with name '"+this._error.getErrorParam()+"'.";b+=" It is not registred in Gridifier.";this._errorMsg=b};Gridifier.CollectorErrors=function(a,b){var c=this;this._error=null;this._isCollectorError=false;this._errorMsg="";this._css={};this._construct=function(){c._error=a;c._isCollectorError=false;c._errorMsg="";c._parseIfIsCollectorError(b)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.CollectorErrors.prototype.isCollectorError=function(){return this._isCollectorError};Gridifier.CollectorErrors.prototype.getErrorMessage=function(){return this._errorMsg};Gridifier.CollectorErrors.prototype._parseIfIsCollectorError=function(a){var b=Gridifier.Error.ERROR_TYPES.COLLECTOR;if(a==b.NOT_DOM_ELEMENT){this._markAsCollectorError();this._notDomElementError()}else if(a==b.ITEM_NOT_ATTACHED_TO_GRID){this._markAsCollectorError();this._itemNotAttachedToGridError()}else if(a==b.ITEM_NOT_CONNECTED_TO_GRID){this._markAsCollectorError();this._itemNotConnectedToGridError()}else if(a==b.ITEM_WIDER_THAN_GRID_WIDTH){this._markAsCollectorError();this._itemWiderThanGridWidthError()}else if(a==b.ITEM_TALLER_THAN_GRID_HEIGHT){this._markAsCollectorError();this._itemTallerThanGridHeightError()}};Gridifier.CollectorErrors.prototype._markAsCollectorError=function(){this._isCollectorError=true};Gridifier.CollectorErrors.prototype._notDomElementError=function(){var a=this._error.getErrorMsgPrefix();a+="One of the added elements to Gridifier is not DOM Element. Got: '";a+=this._error.getErrorParam()+"'.";this._errorMsg=a};Gridifier.CollectorErrors.prototype._itemNotAttachedToGridError=function(){var a=this._error.getErrorMsgPrefix();a+="One of the appended/prepended items is not attached to grid. Item: '";a+=this._error.getErrorParam()+"'.";this._errorMsg=a};Gridifier.CollectorErrors.prototype._itemNotConnectedToGridError=function(){var a=this._error.getErrorMsgPrefix();a+="One of items is not connected to grid. Item: '";a+=this._error.getErrorParam()+"'.";this._errorMsg=a};Gridifier.CollectorErrors.prototype._itemWiderThanGridWidthError=function(){var a=this._error.getErrorMsgPrefix();var b=this._error.getErrorObjectParam();a+="Item '"+b.item+"' is wider than grid. Grid type: 'Vertical Grid'. ";a+="Grid width: '"+b.gridWidth+"px'. Item width: '"+b.itemWidth+"px'.";this._errorMsg=a};Gridifier.CollectorErrors.prototype._itemTallerThanGridHeightError=function(){var a=this._error.getErrorMsgPrefix();var b=this._error.getErrorObjectParam();a+="Item '"+b.item+"' is taller than grid. Grid type: 'Horizontal Grid'. ";a+="Grid height: '"+b.gridHeight+"px'. Item height: '"+b.itemHeight+"px'.";this._errorMsg=a};Gridifier.CoreErrors=function(a,b){var c=this;this._error=null;this._isCoreError=false;this._errorMsg="";this._css={};this._construct=function(){c._error=a;c._isCoreError=false;c._errorMsg="";c._parseIfIsCoreError(b)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.CoreErrors.prototype.isCoreError=function(){return this._isCoreError};Gridifier.CoreErrors.prototype.getErrorMessage=function(){return this._errorMsg};Gridifier.CoreErrors.prototype._parseIfIsCoreError=function(a){var b=Gridifier.Error.ERROR_TYPES;if(a==b.EXTRACT_GRID){this._markAsCoreError();this._notDomElementError()}else if(a==b.CONNECTIONS.NO_CONNECTIONS){this._markAsCoreError();this._noConnectionsError()}else if(a==b.CONNECTIONS.CONNECTION_BY_ITEM_NOT_FOUND){this._markAsCoreError();this._connectionByItemNotFoundError()}else if(a==b.SIZES_TRANSFORMER.WRONG_TARGET_TRANSFORMATION_SIZES){this._markAsCoreError();this._wrongTargetTransformationSizesError()}else if(a==b.APPENDER.WRONG_INSERT_BEFORE_TARGET_ITEM){this._markAsCoreError();this._wrongInsertBeforeTargetItem()}else if(a==b.APPENDER.WRONG_INSERT_AFTER_TARGET_ITEM){this._markAsCoreError();this._wrongInsertAfterTargetItem()}};Gridifier.CoreErrors.prototype._markAsCoreError=function(){this._isCoreError=true};Gridifier.CoreErrors.prototype._notDomElementError=function(){var a=this._error.getErrorMsgPrefix();a+="Can't get grid layout DOM element. Currently gridifier supports ";a+="native DOM elements, as well as jQuery objects. ";this._errorMsg=a};Gridifier.CoreErrors.prototype._noConnectionsError=function(){var a=this._error.getErrorMsgPrefix();a+="Can't find any item, that was processed by Gridifier.";this._errorMsg=a};Gridifier.CoreErrors.prototype._connectionByItemNotFoundError=function(){var a=this._error.getErrorMsgPrefix();var b=this._error.getErrorObjectParam();a+="Can't find connection by item.\n";a+="Item: \n"+b.item+"\n";a+="Connections:\n";for(var c=0;c<b.connections.length;c++)a+=b.connections[c]+"\n";this._errorMsg=a};Gridifier.CoreErrors.prototype._wrongTargetTransformationSizesError=function(){var a=this._error.getErrorMsgPrefix();var b=this._error.getErrorParam();a+="Wrong target transformation sizes. 'transformSizes' and 'toggleSizes' functions accepts 4 types of values:\n";a+="    gridifier.transformSizes(item, '100px', '60%'); // px or % values\n";a+="    gridifier.transformSizes(item, 100, 200.5); // values without postfix will be parsed as px value.";a+="    gridifier.transformSizes(item, '*2', '/0.5'); // values with multiplication or division expressions.";this._errorMsg=a};Gridifier.CoreErrors.prototype._wrongInsertBeforeTargetItem=function(){var a=this._error.getErrorMsgPrefix();var b=this._error.getErrorParam();a+="Wrong target item passed to the insertBefore function. It must be item, which was processed by gridifier. ";a+="Got: "+b+".";this._errorMsg=a};Gridifier.CoreErrors.prototype._wrongInsertAfterTargetItem=function(){var a=this._error.getErrorMsgPrefix();var b=this._error.getErrorParam();a+="Wrong target item passed to the insertAfter function. It must be item, which was processed by gridifier. ";a+="Got: "+b+".";this._errorMsg=a};Gridifier.CoreSettingsErrors=function(a,b){var c=this;this._error=null;this._isCoreSettingsError=false;this._errorMsg="";this._css={};this._construct=function(){c._error=a;c._isCoreSettingsError=false;c._errorMsg="";c._parseIfIsCoreSettingsError(b)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.CoreSettingsErrors.prototype.isCoreSettingsError=function(){return this._isCoreSettingsError};Gridifier.CoreSettingsErrors.prototype.getErrorMessage=function(){return this._errorMsg};Gridifier.CoreSettingsErrors.prototype._parseIfIsCoreSettingsError=function(a){var b=Gridifier.Error.ERROR_TYPES.SETTINGS;if(a==b.INVALID_GRID_TYPE){this._markAsCoreSettingsError();this._invalidGridTypeError()}else if(a==b.INVALID_PREPEND_TYPE){this._markAsCoreSettingsError();this._invalidPrependTypeError()}else if(a==b.INVALID_APPEND_TYPE){this._markAsCoreSettingsError();this._invalidAppendTypeError()}else if(a==b.INVALID_INTERSECTION_STRATEGY){this._markAsCoreSettingsError();this._invalidIntersectionStrategyError()}else if(a==b.INVALID_ALIGNMENT_TYPE){this._markAsCoreSettingsError();this._invalidAlignmentTypeError()}else if(a==b.INVALID_SORT_DISPERSION_MODE){this._markAsCoreSettingsError();this._invalidSortDispersionModeError()}else if(a==b.MISSING_SORT_DISPERSION_VALUE){this._markAsCoreSettingsError();this._missingSortDispersionValueError()}else if(a==b.INVALID_SORT_DISPERSION_VALUE){this._markAsCoreSettingsError();this._invalidSortDispersionValueError()}};Gridifier.CoreSettingsErrors.prototype._markAsCoreSettingsError=function(){this._isCoreSettingsError=true};Gridifier.CoreSettingsErrors.prototype._invalidGridTypeError=function(){var a=this._error.getErrorMsgPrefix();a+="Wrong 'gridType' param value. Got: '"+this._error.getErrorParam()+"'. ";a+="Available types: "+Gridifier.GRID_TYPES.VERTICAL_GRID;a+=", "+Gridifier.GRID_TYPES.HORIZONTAL_GRID+".";this._errorMsg=a};Gridifier.CoreSettingsErrors.prototype._invalidPrependTypeError=function(){var a=this._error.getErrorMsgPrefix();a+="Wrong 'prependType' param value. Got: '"+this._error.getErrorParam()+"'. ";a+="Available types: "+Gridifier.PREPEND_TYPES.MIRRORED_PREPEND;a+=" , "+Gridifier.PREPEND_TYPES.DEFAULT_PREPEND;a+=" , "+Gridifier.PREPEND_TYPES.REVERSED_PREPEND+".";this._errorMsg=a};Gridifier.CoreSettingsErrors.prototype._invalidAppendTypeError=function(){var a=this._error.getErrorMsgPrefix();a+="Wrong 'appendType' param value. Got: '"+this._error.getErrorParam()+"'. ";a+="Available types: "+Gridifier.APPEND_TYPES.DEFAULT_APPEND;a+=" , "+Gridifier.APPEND_TYPES.REVERSED_APPEND+".";this._errorMsg=a};Gridifier.CoreSettingsErrors.prototype._invalidIntersectionStrategyError=function(){var a=this._error.getErrorMsgPrefix();a+="Wrong 'intersectionStrategy' param value. Got: '"+this._error.getErrorParam()+"'. ";a+="Available strategies: "+Gridifier.INTERSECTION_STRATEGIES.DEFAULT;a+=" , "+Gridifier.INTERSECTION_STRATEGIES.REVERSED;this._errorMsg=a};Gridifier.CoreSettingsErrors.prototype._invalidAlignmentTypeError=function(){var a=this._error.getErrorMsgPrefix();var b=Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES;var c=b.FOR_VERTICAL_GRID;var d=b.FOR_HORIZONTAL_GRID;a+="Wrong 'alignmentType' param value. Got: '"+this._error.getErrorParam()+"'. ";a+="Available values: ";a+=c.TOP+", ";a+=c.CENTER+", ";a+=c.BOTTOM+"(For vertical grids), ";a+=d.LEFT+", ";a+=d.CENTER+", ";a+=d.RIGHT+"(For horizontal grids). ";this._errorMsg=a};Gridifier.CoreSettingsErrors.prototype._invalidSortDispersionModeError=function(){var a=this._error.getErrorMsgPrefix();a+="Wrong 'sortDispersionMode' param value. Got: '"+this._error.getErrorParam()+"'. ";a+="Available modes: "+Gridifier.SORT_DISPERSION_MODES.DISABLED;a+=" , "+Gridifier.SORT_DISPERSION_MODES.CUSTOM;a+=" , "+Gridifier.SORT_DISPERSION_MODES.CUSTOM_ALL_EMPTY_SPACE;this._errorMsg=a};Gridifier.CoreSettingsErrors.prototype._missingSortDispersionModeError=function(){var a=this._error.getErrorMsgPrefix();a+="You have chosen custom sort dispersion mode, but didn't provided required 'sortDispersionValue' param.";this._errorMsg=a};Gridifier.CoreSettingsErrors.prototype._invalidSortDispersionValueError=function(){var a=this._error.getErrorMsgPrefix();a+="Wrong 'sortDispersionValue' param value. It must be a string with number as prefix, ";a+="and px as postfix.(100px). Got: '"+this._error.getErrorParam()+"'.";this._errorMsg=a};Gridifier.Error=function(a,b){var c=this;this._errorParam=null;this._coreErrors=null;this._collectorErrors=null;this._apiSettingsErrors=null;this._coreSettingsErrors=null;this._css={};this._construct=function(){c._errorParam=b||null;c._coreErrors=new Gridifier.CoreErrors(c,a);c._collectorErrors=new Gridifier.CollectorErrors(c,a);c._apiSettingsErrors=new Gridifier.ApiSettingsErrors(c,a);c._coreSettingsErrors=new Gridifier.CoreSettingsErrors(c,a);if(c._coreErrors.isCoreError()){var d=c._coreErrors.getErrorMessage()}else if(c._collectorErrors.isCollectorError()){var d=c._collectorErrors.getErrorMessage()}else if(c._apiSettingsErrors.isApiSettingsError()){var d=c._apiSettingsErrors.getErrorMessage()}else if(c._coreSettingsErrors.isCoreSettingsError()){var d=c._coreSettingsErrors.getErrorMessage()}else{throw new Error("Gridifier Error -> Wrong error type: "+a)}throw new Error(d)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Error.ERROR_TYPES={EXTRACT_GRID:0,SETTINGS:{INVALID_GRID_TYPE:1,INVALID_PREPEND_TYPE:2,INVALID_APPEND_TYPE:3,INVALID_INTERSECTION_STRATEGY:4,INVALID_ALIGNMENT_TYPE:5,INVALID_SORT_DISPERSION_MODE:6,MISSING_SORT_DISPERSION_VALUE:7,INVALID_SORT_DISPERSION_VALUE:8,INVALID_SORT_PARAM_VALUE:9,INVALID_ONE_OF_SORT_FUNCTION_TYPES:10,INVALID_FILTER_PARAM_VALUE:11,INVALID_ONE_OF_FILTER_FUNCTION_TYPES:12,INVALID_TOGGLE_PARAM_VALUE:13,INVALID_ONE_OF_TOGGLE_PARAMS:14,INVALID_COORDS_CHANGER_PARAM_VALUE:15,INVALID_ONE_OF_COORDS_CHANGER_FUNCTION_TYPES:16,INVALID_SIZES_CHANGER_PARAM_VALUE:17,INVALID_ONE_OF_SIZES_CHANGER_FUNCTION_TYPES:18,SET_TOGGLE_INVALID_PARAM:19,SET_FILTER_INVALID_PARAM:20,SET_SORT_INVALID_PARAM:21,SET_COORDS_CHANGER_INVALID_PARAM:22,SET_SIZES_CHANGER_INVALID_PARAM:23},COLLECTOR:{NOT_DOM_ELEMENT:24,ITEM_NOT_ATTACHED_TO_GRID:25,ITEM_NOT_CONNECTED_TO_GRID:26,ITEM_WIDER_THAN_GRID_WIDTH:27,ITEM_TALLER_THAN_GRID_HEIGHT:28},CONNECTIONS:{NO_CONNECTIONS:29,CONNECTION_BY_ITEM_NOT_FOUND:30},SIZES_TRANSFORMER:{WRONG_TARGET_TRANSFORMATION_SIZES:31},APPENDER:{WRONG_INSERT_BEFORE_TARGET_ITEM:32,WRONG_INSERT_AFTER_TARGET_ITEM:33}};Gridifier.Error.prototype.getErrorMsgPrefix=function(){return"Gridifier error: "};Gridifier.Error.prototype.getErrorApiUrlPrefix=function(){return"http://gridifier.io/api/errors/"};Gridifier.Error.prototype.getErrorParam=function(){return this._errorParam+"("+typeof this._errorParam+")"};Gridifier.Error.prototype.getErrorObjectParam=function(){return this._errorParam};Gridifier.Grid=function(a,b){var c=this;this._grid=null;this._collector=null;this._sizesResolverManager=null;this._css={};this._construct=function(){c._grid=a;c._sizesResolverManager=b;c._extractGrid(a);c._adjustGridCss()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.Grid.prototype.setCollectorInstance=function(a){this._collector=a};Gridifier.Grid.prototype._extractGrid=function(a){if(Dom.isJqueryObject(a))this._grid=a.get(0);else if(Dom.isNativeDOMObject(a))this._grid=a;else new Gridifier.Error(Gridifier.Error.ERROR_TYPES.EXTRACT_GRID)};Gridifier.Grid.prototype._adjustGridCss=function(){Dom.css.set(this._grid,{position:"relative"})};Gridifier.Grid.prototype.getGrid=function(){return this._grid};Gridifier.Grid.prototype.getGridX2=function(){return this._sizesResolverManager.outerWidth(this._grid,false,true)-1};Gridifier.Grid.prototype.getGridY2=function(){return this._sizesResolverManager.outerHeight(this._grid,false,true)-1};Gridifier.Grid.prototype.addToGrid=function(a){var a=this._collector.toDOMCollection(a);for(var b=0;b<a.length;b++){this._grid.appendChild(a[b])}this._collector.attachToGrid(a)};Gridifier.Grid.prototype.markAsGridItem=function(a){var a=this._collector.toDOMCollection(a);this._collector.attachToGrid(a)};Gridifier.GridSizesUpdater=function(a,b,c,d){var e=this;e._grid=null;e._connections=null;e._settings=null;e._eventEmitter=null;e._gridSizesUpdateTimeout=null;this._css={};this._construct=function(){e._grid=a;e._connections=b;e._settings=c;e._eventEmitter=d};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){e._unbindEvents()};this._construct();return this};Gridifier.GridSizesUpdater.GRID_SIZES_UPDATE_TIMEOUT=100;Gridifier.GridSizesUpdater.prototype.scheduleGridSizesUpdate=function(){if(this._gridSizesUpdateTimeout!=null){clearTimeout(this._gridSizesUpdateTimeout);this._gridSizesUpdateTimeout=null}var a=this;this._gridSizesUpdateTimeout=setTimeout(function(){a._updateGridSizes.call(a)},Gridifier.GridSizesUpdater.GRID_SIZES_UPDATE_TIMEOUT)};Gridifier.GridSizesUpdater.prototype._updateGridSizes=function(){var a=this._connections.get();if(a.length==0)return;if(this._settings.isVerticalGrid()){var b=a[0].y2;for(var c=1;c<a.length;c++){if(a[c].y2>b)b=a[c].y2}if(this._grid.getGridY2()<b)Dom.css.set(this._grid.getGrid(),{height:b+"px"});this._eventEmitter.emitGridSizesChangeEvent()}else if(this._settings.isHorizontalGrid()){var d=a[0].x2;for(var c=1;c<a.length;c++){if(a[c].x2>d)d=a[c].x2}if(this._grid.getGridX2()<d)Dom.css.set(this._grid.getGrid(),{width:d+"px"});this._eventEmitter.emitGridSizesChangeEvent()}};Gridifier.HorizontalGrid.Appender=function(a,b,c,d,e,f,g,h,i){var j=this;this._gridifier=null;this._settings=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectorsCleaner=null;this._connectorsShifter=null;this._connectorsSelector=null;this._connectorsSorter=null;this._itemCoordsExtractor=null;this._connectionsIntersector=null;this._guid=null;this._renderer=null;this._normalizer=null;this._operation=null;this._css={};this._construct=function(){j._gridifier=a;j._settings=b;j._sizesResolverManager=c;j._connectors=d;j._connections=e;j._connectorsCleaner=new Gridifier.HorizontalGrid.ConnectorsCleaner(j._connectors,j._connections,j._settings);j._connectorsShifter=new Gridifier.ConnectorsShifter(j._gridifier,j._connections,j._settings);j._connectorsSelector=new Gridifier.HorizontalGrid.ConnectorsSelector(j._guid);j._connectorsSorter=new Gridifier.HorizontalGrid.ConnectorsSorter;j._itemCoordsExtractor=new Gridifier.HorizontalGrid.ItemCoordsExtractor(j._gridifier,j._sizesResolverManager);j._connectionsIntersector=new Gridifier.HorizontalGrid.ConnectionsIntersector(j._connections);j._guid=f;j._renderer=g;j._normalizer=h;j._operation=i};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){j._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.Appender.prototype.append=function(a){this._initConnectors();
var b=this._createConnectionPerItem(a);this._connections.attachConnectionToRanges(b);this._connectorsCleaner.deleteAllTooLeftConnectorsFromMostRightConnector();this._connectorsCleaner.deleteAllIntersectedFromRightConnectors();if(this._settings.isDefaultIntersectionStrategy())this._renderer.showConnections(b);else if(this._settings.isNoIntersectionsStrategy()){var c=this._connections.getLastColHorizontallyExpandedConnections();for(var d=0;d<c.length;d++){if(c[d].itemGUID==b.itemGUID){c.splice(d,1);d--}}this._renderer.renderConnections(c);this._renderer.showConnections(b)}};Gridifier.HorizontalGrid.Appender.prototype._initConnectors=function(){if(this._operation.isInitialOperation(Gridifier.OPERATIONS.APPEND)){this.createInitialConnector();return}if(!this._operation.isCurrentOperationSameAsPrevious(Gridifier.OPERATIONS.APPEND)){this.recreateConnectorsPerAllConnectedItems();this._connectorsCleaner.deleteAllIntersectedFromRightConnectors();this._connectorsCleaner.deleteAllTooLeftConnectorsFromMostRightConnector()}};Gridifier.HorizontalGrid.Appender.prototype.createInitialConnector=function(){this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.RIGHT.TOP,0,0)};Gridifier.HorizontalGrid.Appender.prototype.recreateConnectorsPerAllConnectedItems=function(){this._connectors.flush();var a=this._connections.get();for(var b=0;b<a.length;b++){this._addItemConnectors(a[b],a[b].itemGUID)}if(this._connectors.count()==0)this.createInitialConnector()};Gridifier.HorizontalGrid.Appender.prototype._addItemConnectors=function(a,b){if(a.y2+1<=this._gridifier.getGridY2()){this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.BOTTOM.LEFT,parseFloat(a.x1),parseFloat(a.y2+1),Dom.toInt(b))}this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.RIGHT.TOP,parseFloat(a.x2+1),parseFloat(a.y1),Dom.toInt(b))};Gridifier.HorizontalGrid.Appender.prototype._createConnectionPerItem=function(a){var b=this._filterConnectorsPerNextConnection();var c=this._findItemConnectionCoords(a,b);var d=this._connections.add(a,c);if(this._settings.isNoIntersectionsStrategy()){this._connections.expandHorizontallyAllColConnectionsToMostWide(d)}this._addItemConnectors(c,this._guid.getItemGUID(a));return d};Gridifier.HorizontalGrid.Appender.prototype._filterConnectorsPerNextConnection=function(){var a=this._connectors.getClone();if(this._settings.isDefaultIntersectionStrategy()){this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllConnectors();a=this._connectorsShifter.getAllConnectors()}else if(this._settings.isNoIntersectionsStrategy()){var b=Gridifier.Connectors.SIDES.RIGHT.TOP;this._connectorsSelector.attachConnectors(a);this._connectorsSelector.selectOnlyMostRightConnectorFromSide(b);a=this._connectorsSelector.getSelectedConnectors();this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllWithSpecifiedSideToTopGridCorner(b);a=this._connectorsShifter.getAllConnectors()}this._connectorsSorter.attachConnectors(a);this._connectorsSorter.sortConnectorsForAppend(Gridifier.APPEND_TYPES.DEFAULT_APPEND);return this._connectorsSorter.getConnectors()};Gridifier.HorizontalGrid.Appender.prototype._findItemConnectionCoords=function(a,b){var c=null;for(var d=0;d<b.length;d++){var e=this._itemCoordsExtractor.connectorToAppendedItemCoords(a,b[d]);if(e.y2>this._normalizer.normalizeHighRounding(this._gridifier.getGridY2())){continue}var f=this._connectionsIntersector.findAllMaybeIntersectableConnectionsOnAppend(b[d]);if(this._connectionsIntersector.isIntersectingAnyConnection(f,e)){continue}c=e;var g=this._connections.getAllConnectionsBehindX(e.x2);if(this._connections.isAnyConnectionItemGUIDSmallerThan(g,a)){continue}if(this._settings.isNoIntersectionsStrategy()){if(this._connections.isIntersectingMoreThanOneConnectionItemHorizontally(c)){c=null}}if(c!=null){break}}return c};Gridifier.HorizontalGrid.Connections=function(a,b,c,d){var e=this;this._gridifier=null;this._guid=null;this._settings=null;this._sizesResolverManager=null;this._itemCoordsExtractor=null;this._sizesTransformer=null;this._connectionsCore=null;this._connectionsHorizontalIntersector=null;this._connections=[];this._ranges=null;this._sorter=null;this._css={};this._construct=function(){e._gridifier=a;e._guid=b;e._settings=c;e._sizesResolverManager=d;e._ranges=new Gridifier.HorizontalGrid.ConnectionsRanges(e);e._ranges.init();e._sorter=new Gridifier.HorizontalGrid.ConnectionsSorter(e,e._settings,e._guid);e._itemCoordsExtractor=new Gridifier.HorizontalGrid.ItemCoordsExtractor(e._gridifier,e._sizesResolverManager);e._connectionsCore=new Gridifier.Connections(e._gridifier,e,e._guid,e._sorter,e._sizesResolverManager);e._connectionsHorizontalIntersector=new Gridifier.HorizontalGrid.ConnectionsHorizontalIntersector(e,e._settings,e._itemCoordsExtractor)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){e._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.Connections.prototype.setSizesTransformerInstance=function(a){this._sizesTransformer=a;this._connectionsCore.setSizesTransformerInstance(a)};Gridifier.HorizontalGrid.Connections.prototype.attachConnectionToRanges=function(a){this._ranges.attachConnection(a,this._connections.length-1)};Gridifier.HorizontalGrid.Connections.prototype.reinitRanges=function(){this._ranges.init()};Gridifier.HorizontalGrid.Connections.prototype.getAllVerticallyIntersectedAndLeftConnections=function(a){return this._ranges.getAllConnectionsFromIntersectedAndLeftRanges(a.x)};Gridifier.HorizontalGrid.Connections.prototype.getAllVerticallyIntersectedConnections=function(a){return this._ranges.getAllConnectionsFromIntersectedRange(a.x)};Gridifier.HorizontalGrid.Connections.prototype.getAllVerticallyIntersectedAndRightConnections=function(a){return this._ranges.getAllConnectionsFromIntersectedAndRightRanges(a.x)};Gridifier.HorizontalGrid.Connections.prototype.mapAllIntersectedAndRightConnectionsPerEachConnector=function(a){return this._ranges.mapAllIntersectedAndRightConnectionsPerEachConnector(a)};Gridifier.HorizontalGrid.Connections.prototype.mapAllIntersectedAndLeftConnectionsPerEachConnector=function(a){return this._ranges.mapAllIntersectedAndLeftConnectionsPerEachConnector(a)};Gridifier.HorizontalGrid.Connections.prototype.getLastColHorizontallyExpandedConnections=function(){return this._connectionsHorizontalIntersector.getLastColHorizontallyExpandedConnections()};Gridifier.HorizontalGrid.Connections.prototype.get=function(){return this._connections};Gridifier.HorizontalGrid.Connections.prototype.count=function(){return this._connections.length};Gridifier.HorizontalGrid.Connections.prototype.restore=function(a){this._connections=this._connections.concat(a)};Gridifier.HorizontalGrid.Connections.prototype.restoreOnCustomSortDispersionMode=function(a){var b=this._sorter.sortConnectionsPerReappend(this._connections);var c=b[b.length-1];if(this._settings.isDefaultAppend()){var d=c.y2;var e=c.x1;var f=d+1;for(var g=0;g<a.length;g++){a[g].x1=e;a[g].x2=e;a[g].y1=f;a[g].y2=f;f++}}else if(this._settings.isReversedAppend()){var h=c.y1;var e=c.x1;var f=h-1;for(var g=0;g<a.length;g++){a[g].x1=e;a[g].x2=e;a[g].y1=f;a[g].y2=f;f--}}this.restore(a)};Gridifier.HorizontalGrid.Connections.prototype.findConnectionByItem=function(a){return this._connectionsCore.findConnectionByItem(a)};Gridifier.HorizontalGrid.Connections.prototype.remapAllItemGUIDS=function(){this._connectionsCore.remapAllItemGUIDS()};Gridifier.HorizontalGrid.Connections.prototype.remapAllItemGUIDSInSortedConnections=function(a){this._connectionsCore.remapAllItemGUIDSInSortedConnections(a)};Gridifier.HorizontalGrid.Connections.prototype.add=function(a,b){var c=this._connectionsCore.createItemConnection(a,b);this._connections.push(c);return c};Gridifier.HorizontalGrid.Connections.prototype.removeConnection=function(a){for(var b=0;b<this._connections.length;b++){if(this._guid.getItemGUID(a.item)==this._guid.getItemGUID(this._connections[b].item)){this._connections.splice(b,1);return}}};Gridifier.HorizontalGrid.Connections.prototype.getConnectionsByItemGUIDS=function(a){return this._connectionsCore.getConnectionsByItemGUIDS(a)};Gridifier.HorizontalGrid.Connections.prototype.syncConnectionParams=function(a){this._connectionsCore.syncConnectionParams(a)};Gridifier.HorizontalGrid.Connections.prototype.getMinConnectionWidth=function(){return this._connectionsCore.getMinConnectionWidth()};Gridifier.HorizontalGrid.Connections.prototype.getMinConnectionHeight=function(){return this._connectionsCore.getMinConnectionHeight()};Gridifier.HorizontalGrid.Connections.prototype.isAnyConnectionItemGUIDSmallerThan=function(a,b){return this._connectionsCore.isAnyConnectionItemGUIDSmallerThan(a,b)};Gridifier.HorizontalGrid.Connections.prototype.isAnyConnectionItemGUIDBiggerThan=function(a,b){return this._connectionsCore.isAnyConnectionItemGUIDBiggerThan(a,b)};Gridifier.HorizontalGrid.Connections.prototype.getAllConnectionsBehindX=function(a){var b=[];for(var c=0;c<this._connections.length;c++){if(this._connections[c].x1-1e4>a)b.push(this._connections[c])}return b};Gridifier.HorizontalGrid.Connections.prototype.getAllConnectionsBeforeX=function(a){var b=[];for(var c=0;c<this._connections.length;c++){if(this._connections[c].x2<a)b.push(this._connections[c])}return b};Gridifier.HorizontalGrid.Connections.prototype.getMaxYFromAllConnections=function(){var a=0;for(var b=0;b<this._connections.length;b++){if(this._connections[b].y2>a)a=this._connections[b].y2}return a};Gridifier.HorizontalGrid.Connections.prototype.isIntersectingMoreThanOneConnectionItemHorizontally=function(a){return this._connectionsHorizontalIntersector.isIntersectingMoreThanOneConnectionItemHorizontally(a)};Gridifier.HorizontalGrid.Connections.prototype.getMostWideFromAllHorizontallyIntersectedConnections=function(a){return this._connectionsHorizontalIntersector.getMostWideFromAllHorizontallyIntersectedConnections(a)};Gridifier.HorizontalGrid.Connections.prototype.getAllHorizontallyIntersectedConnections=function(a){return this._connectionsHorizontalIntersector.getAllHorizontallyIntersectedConnections(a)};Gridifier.HorizontalGrid.Connections.prototype.expandHorizontallyAllColConnectionsToMostWide=function(a){this._connectionsHorizontalIntersector.expandHorizontallyAllColConnectionsToMostWide(a)};Gridifier.HorizontalGrid.Connections.prototype.normalizeHorizontalPositionsOfAllConnectionsAfterPrepend=function(a,b){if(a.x1>=0)return false;var c=Math.round(Math.abs(a.x1));a.x2=Math.abs(a.x1-a.x2);a.x1=0;for(var d=0;d<this._connections.length;d++){if(a.itemGUID==this._connections[d].itemGUID)continue;this._connections[d].x1+=c;this._connections[d].x2+=c}for(var d=0;d<b.length;d++)b[d].x+=c;this._ranges.shiftAllRangesBy(c);this._ranges.createPrependedRange(a.x1,a.x2);return true};Gridifier.HorizontalGrid.ConnectionsHorizontalIntersector=function(a,b,c){var d=this;this._connections=null;this._settings=null;this._itemCoordsExtractor=null;this._lastColHorizontallyExpandedConnections=[];this._css={};this._construct=function(){d._connections=a;d._settings=b;d._itemCoordsExtractor=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ConnectionsHorizontalIntersector.prototype.getLastColHorizontallyExpandedConnections=function(){return this._lastColHorizontallyExpandedConnections};Gridifier.HorizontalGrid.ConnectionsHorizontalIntersector.prototype.isIntersectingMoreThanOneConnectionItemHorizontally=function(a){var b=this;var c=this._connections.get();var d=[];var e=function(a){if(d.length==0)return false;for(var b=0;b<d.length;b++){var e=c[d[b]];var f=a.x1<e.x1&&a.x2<e.x1;var g=a.x1>e.x2&&a.x2>e.x2;if(!f&&!g)return true}return false};var f=0;for(var g=0;g<c.length;g++){var h=c[g];var i=a.x1<h.x1&&a.x2<h.x1;var j=a.x1>h.x2&&a.x2>h.x2;if(!i&&!j&&!e(h)){d.push(g);f++}}return f>1};Gridifier.HorizontalGrid.ConnectionsHorizontalIntersector.prototype.getMostWideFromAllHorizontallyIntersectedConnections=function(a){var b=this;var c=this._connections.get();var d=null;for(var e=0;e<c.length;e++){var f=c[e];var g=a.x1<f.x1&&a.x2<f.x1;var h=a.x1>f.x2&&a.x2>f.x2;if(!g&&!h){if(d==null)d=f;else{var i=Math.abs(f.x2-f.x1);var j=Math.abs(d.x2-d.x1);if(i>j)d=f}}}return d};Gridifier.HorizontalGrid.ConnectionsHorizontalIntersector.prototype.getAllHorizontallyIntersectedConnections=function(a){var b=this;var c=this._connections.get();var d=[];for(var e=0;e<c.length;e++){var f=c[e];var g=a.x1<f.x1&&a.x2<f.x1;var h=a.x1>f.x2&&a.x2>f.x2;if(!g&&!h)d.push(f)}return d};Gridifier.HorizontalGrid.ConnectionsHorizontalIntersector.prototype.expandHorizontallyAllColConnectionsToMostWide=function(a){var b=this.getMostWideFromAllHorizontallyIntersectedConnections(a);if(b==null)return;var c=this.getAllHorizontallyIntersectedConnections(a);this._lastColHorizontallyExpandedConnections=c;for(var d=0;d<c.length;d++){c[d].x1=b.x1;c[d].x2=b.x2;if(this._settings.isHorizontalGridLeftAlignmentType())c[d].horizontalOffset=0;else if(this._settings.isHorizontalGridCenterAlignmentType()){var e=c[d].x1;var f=c[d].x2;var g=this._itemCoordsExtractor.getItemTargetSizes(c[d].item);var h=g.targetWidth-1;c[d].horizontalOffset=Math.round(Math.abs(f-e)/2)-Math.round(h/2)}else if(this._settings.isHorizontalGridRightAlignmentType()){var e=c[d].x1;var f=c[d].x2;var g=this._itemCoordsExtractor.getItemTargetSizes(c[d].item);var h=g.targetWidth-1;c[d].horizontalOffset=Math.abs(f-e)-h}}};Gridifier.HorizontalGrid.ConnectionsIntersector=function(a){var b=this;this._connections=null;this._intersectorCore=null;this._css={};this._construct=function(){b._connections=a;b._intersectorCore=new Gridifier.ConnectionsIntersector(b._connections)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ConnectionsIntersector.prototype.isIntersectingAnyConnection=function(a,b){return this._intersectorCore.isIntersectingAnyConnection(a,b)};Gridifier.HorizontalGrid.ConnectionsIntersector.prototype.getAllConnectionsWithIntersectedCenter=function(a){return this._intersectorCore.getAllConnectionsWithIntersectedCenter(a)};Gridifier.HorizontalGrid.ConnectionsIntersector.prototype.findAllMaybeIntersectableConnectionsOnAppend=function(a){var b=this._connections.get();var c=[];for(var d=0;d<b.length;d++){if(a.x>b[d].x2)continue;c.push(b[d])}return c};Gridifier.HorizontalGrid.ConnectionsIntersector.prototype.findAllMaybeIntersectableConnectionsOnPrepend=function(a){var b=this._connections.get();var c=[];for(var d=0;d<b.length;d++){if(a.x<b[d].x1)continue;c.push(b[d])}return c};Gridifier.HorizontalGrid.ConnectionsRanges=function(a){var b=this;this._connections=null;this._ranges=null;this._css={};this._construct=function(){b._connections=a};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ConnectionsRanges.RANGE_PX_WIDTH=500;Gridifier.HorizontalGrid.ConnectionsRanges.prototype.init=function(){this._ranges=[];this._ranges.push({x1:-1,x2:Gridifier.HorizontalGrid.ConnectionsRanges.RANGE_PX_WIDTH,connectionIndexes:[]});this._attachAllConnections()};Gridifier.HorizontalGrid.ConnectionsRanges.prototype.shiftAllRangesBy=function(a){for(var b=0;b<this._ranges.length;b++){this._ranges[b].x1+=a;this._ranges[b].x2+=a}};Gridifier.HorizontalGrid.ConnectionsRanges.prototype.createPrependedRange=function(a,b){this._ranges.unshift({x1:-1,x2:b,connectionIndexes:[]})};Gridifier.HorizontalGrid.ConnectionsRanges.prototype._createNextRange=function(){var a=this._ranges[this._ranges.length-1].x2+1;this._ranges.push({x1:a,x2:a+Gridifier.HorizontalGrid.ConnectionsRanges.RANGE_PX_WIDTH,connectionIndexes:[]})};Gridifier.HorizontalGrid.ConnectionsRanges.prototype.attachConnection=function(a,b){while(a.x2+1>this._ranges[this._ranges.length-1].x2){this._createNextRange()}var c=false;for(var d=0;d<this._ranges.length;d++){var e=a.x2<this._ranges[d].x1;var f=a.x1>this._ranges[d].x2;if(!e&&!f){this._ranges[d].connectionIndexes.push(b);c=true}}if(!c)throw new Error("Gridifier core error: connection was not connected to any range: "+a.itemGUID)};Gridifier.HorizontalGrid.ConnectionsRanges.prototype._attachAllConnections=function(){var a=this._connections.get();for(var b=0;b<a.length;b++)this.attachConnection(a[b],b)};Gridifier.HorizontalGrid.ConnectionsRanges.prototype.mapAllIntersectedAndLeftConnectionsPerEachConnector=function(a){var b=this._ranges.length-1;var c=[];for(var d=0;d<a.length;d++){var e=false;if(b==this._ranges.length-1)var f=false;else var f=true;while(!e){if(b>this._ranges.length-1||b<0){b=this._ranges.length-1;break}if(a[d].x>=this._ranges[b].x1&&a[d].x<=this._ranges[b].x2){e=true}else{b--;f=false}}if(!f){c=[];for(var g=b;g>=0;g--)c.push(this._ranges[g].connectionIndexes)}a[d].connectionIndexes=c}return a};Gridifier.HorizontalGrid.ConnectionsRanges.prototype.getAllConnectionsFromIntersectedAndRightRanges=function(a){var b=[];var c=null;for(var d=0;d<this._ranges.length;d++){if(a>=this._ranges[d].x1&&a<=this._ranges[d].x2){c=d;break}}if(c==null)c=0;for(var d=c;d<this._ranges.length;d++){b.push(this._ranges[d].connectionIndexes)}return b};Gridifier.HorizontalGrid.ConnectionsRanges.prototype.mapAllIntersectedAndRightConnectionsPerEachConnector=function(a){var b=0;var c=[];for(var d=0;d<a.length;d++){var e=false;if(b==0)var f=false;else var f=true;while(!e){if(b>this._ranges.length-1||b<0){b=0;break}if(a[d].x>=this._ranges[b].x1&&a[d].x<=this._ranges[b].x2){e=true}else{b++;f=false}}if(!f){c=[];for(var g=b;g<this._ranges.length;g++)c.push(this._ranges[g].connectionIndexes)}a[d].connectionIndexes=c}return a};Gridifier.HorizontalGrid.ConnectionsRanges.prototype.getAllConnectionsFromIntersectedRange=function(a){for(var b=0;b<this._ranges.length;b++){if(a>=this._ranges[b].x1&&a<=this._ranges[b].x2)return this._ranges[b].connectionIndexes}var c=function(a,b){for(var c=0;c<a.length;c++){if(a[c]==b)return true}return false};var d=[];for(var b=0;b<this._ranges.length;b++){for(var e=0;e<this._ranges[b].connectionIndexes.length;e++){if(!c(d,this._ranges[b].connectionIndexes[e]))d.push(this._ranges[b].connectionIndexes[e])}}return d};Gridifier.HorizontalGrid.ConnectionsRanges.prototype.getAllConnectionsFromIntersectedAndLeftRanges=function(a){var b=[];var c=null;for(var d=this._ranges.length-1;d>=0;d--){if(a>=this._ranges[d].x1&&a<=this._ranges[d].x2){c=d;break}}if(c==null)c=this._ranges.length-1;for(var d=c;d>=0;d--){b.push(this._ranges[d].connectionIndexes)}return b};Gridifier.HorizontalGrid.ConnectionsSorter=function(a,b,c){var d=this;this._connections=null;this._settings=null;this._guid=null;this._css={};this._construct=function(){d._connections=a;d._settings=b;d._guid=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ConnectionsSorter.prototype.sortConnectionsPerReappend=function(a){var b=this;if(this._settings.isDisabledSortDispersion()){a.sort(function(a,c){if(b._guid.getItemGUID(a.item)>b._guid.getItemGUID(c.item))return 1;return-1})}else if(this._settings.isCustomSortDispersion()||this._settings.isCustomAllEmptySpaceSortDispersion()){if(this._settings.isDefaultAppend()){a.sort(function(a,b){if(a.x1==b.x1){if(a.y2<b.y2)return-1;else return 1}else{if(a.x1<b.x1)return-1;else return 1}})}else if(this._settings.isReversedAppend()){a.sort(function(a,b){if(a.x1==b.x1){if(a.y1>b.y1)return-1;else return 1}else{if(a.x1<b.x1)return-1;else return 1}})}}return a};Gridifier.HorizontalGrid.ConnectorsCleaner=function(a,b,c){var d=this;this._connectors=null;this._connections=null;this._settings=null;this._connectionItemIntersectionStrategy=null;this._css={};this._construct=function(){d._connectors=a;d._connections=b;d._settings=c;if(d._settings.isDisabledSortDispersion()){d.setConnectorInsideOrBeforeItemIntersectionStrategy()}else if(d._settings.isCustomSortDispersion()||d._settings.isCustomAllEmptySpaceSortDispersion()){d.setConnectorInsideItemIntersectionStrategy()}};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES={CONNECTOR_INSIDE_CONNECTION_ITEM:0,CONNECTOR_INSIDE_OR_BEFORE_CONNECTION_ITEM:1};Gridifier.HorizontalGrid.ConnectorsCleaner.MAX_VALID_HORIZONTAL_DISTANCE={FROM_MOST_RIGHT_CONNECTOR:3e3,FROM_MOST_LEFT_CONNECTOR:3e3};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype.setConnectorInsideItemIntersectionStrategy=function(){var a=Gridifier.HorizontalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES;this._connectionItemIntersectionStrategy=a.CONNECTOR_INSIDE_CONNECTION_ITEM};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype.setConnectorInsideOrBeforeItemIntersectionStrategy=function(){var a=Gridifier.HorizontalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES;this._connectionItemIntersectionStrategy=a.CONNECTOR_INSIDE_OR_BEFORE_CONNECTION_ITEM};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype.isConnectorInsideItemIntersectionStrategy=function(){var a=Gridifier.HorizontalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES;return this._connectionItemIntersectionStrategy==a.CONNECTOR_INSIDE_CONNECTION_ITEM};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype.isConnectorInsideOrBeforeItemIntersectionStrategy=function(){var a=Gridifier.HorizontalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES;return this._connectionItemIntersectionStrategy==a.CONNECTOR_INSIDE_OR_BEFORE_CONNECTION_ITEM};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype._isMappedConnectorIntersectingAnyLeftConnectionItem=function(a){var b=this._connections.get();for(var c=0;c<a.connectionIndexes.length;c++){for(var d=0;d<a.connectionIndexes[c].length;d++){var e=b[a.connectionIndexes[c][d]];if(this.isConnectorInsideOrBeforeItemIntersectionStrategy())var f=a.x>=e.x1;else if(this.isConnectorInsideItemIntersectionStrategy())var f=a.x>=e.x1&&a.x<=e.x2;if(a.y>=e.y1&&a.y<=e.y2&&f)return true}}return false};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype.deleteAllIntersectedFromLeftConnectors=function(){var a=this._connectors.get();var b=this._connectors.getClone();b.sort(function(a,b){if(a.x==b.x)return 0;else if(a.x>b.x)return-1;else return 1});b=this._connections.mapAllIntersectedAndLeftConnectionsPerEachConnector(b);for(var c=0;c<b.length;c++){if(this._isMappedConnectorIntersectingAnyLeftConnectionItem(b[c]))a[b[c].connectorIndex].isIntersected=true;else a[b[c].connectorIndex].isIntersected=false}for(var c=0;c<a.length;c++){if(a[c].isIntersected){a.splice(c,1);c--}}};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype.deleteAllTooRightConnectorsFromMostLeftConnector=function(){var a=this._connectors.get();if(a.length==0)return;var b=a[0];for(var c=1;c<a.length;c++){if(a[c].x<b.x)b=a[c]}var d=Gridifier.HorizontalGrid.ConnectorsCleaner;var e=b.x+d.MAX_VALID_HORIZONTAL_DISTANCE.FROM_MOST_LEFT_CONNECTOR;for(var c=0;c<a.length;c++){if(a[c].x>e){a.splice(c,1);c--}}};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype._isMappedConnectorIntersectingAnyRightConnectionItem=function(a){var b=this._connections.get();for(var c=0;c<a.connectionIndexes.length;c++){for(var d=0;d<a.connectionIndexes[c].length;d++){var e=b[a.connectionIndexes[c][d]];if(this.isConnectorInsideOrBeforeItemIntersectionStrategy())var f=a.x<=e.x2;else if(this.isConnectorInsideItemIntersectionStrategy())var f=a.x<=e.x2&&a.x>=e.x1;if(a.y>=e.y1&&a.y<=e.y2&&f)return true}}return false};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype.deleteAllIntersectedFromRightConnectors=function(){var a=this._connectors.get();var b=this._connectors.getClone();b.sort(function(a,b){if(a.x==b.x)return 0;else if(a.x<b.x)return-1;else return 1});b=this._connections.mapAllIntersectedAndRightConnectionsPerEachConnector(b);for(var c=0;c<b.length;c++){if(this._isMappedConnectorIntersectingAnyRightConnectionItem(b[c]))a[b[c].connectorIndex].isIntersected=true;else a[b[c].connectorIndex].isIntersected=false}for(var c=0;c<a.length;c++){if(a[c].isIntersected){a.splice(c,1);c--}}};Gridifier.HorizontalGrid.ConnectorsCleaner.prototype.deleteAllTooLeftConnectorsFromMostRightConnector=function(){var a=this._connectors.get();if(a.length==0)return;var b=a[0];for(var c=1;c<a.length;c++){if(a[c].x>b.x)b=a[c]}var d=Gridifier.HorizontalGrid.ConnectorsCleaner;var e=b.x-d.MAX_VALID_HORIZONTAL_DISTANCE.FROM_MOST_RIGHT_CONNECTOR;for(var c=0;c<a.length;c++){if(a[c].x<e){a.splice(c,1);c--}}};Gridifier.HorizontalGrid.ConnectorsSelector=function(a){var b=this;this._connectors=null;this._guid=null;this._css={};this._construct=function(){b._guid=a};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ConnectorsSelector.prototype.attachConnectors=function(a){this._connectors=a};Gridifier.HorizontalGrid.ConnectorsSelector.prototype.getSelectedConnectors=function(){return this._connectors};Gridifier.HorizontalGrid.ConnectorsSelector.prototype.selectOnlyMostRightConnectorFromSide=function(a){var b=null;var c=null;var d=this._connectors.length;while(d--){if(this._connectors[d].side==a){if(b==null||this._connectors[d].x>c){b=this._connectors[d].itemGUID;c=this._connectors[d].x}}}if(b==null)return;var d=this._connectors.length;while(d--){if(this._connectors[d].side==a&&this._connectors[d].itemGUID!=b)this._connectors.splice(d,1)}};Gridifier.HorizontalGrid.ConnectorsSelector.prototype.selectOnlyMostLeftConnectorFromSide=function(a){var b=null;var c=null;var d=this._connectors.length;while(d--){if(this._connectors[d].side==a){if(b==null||this._connectors[d].x<c){b=this._connectors[d].itemGUID;c=this._connectors[d].x}}}if(b==null)return;var d=this._connectors.length;while(d--){if(this._connectors[d].side==a&&this._connectors[d].itemGUID!=b)this._connectors.splice(d,1)}};Gridifier.HorizontalGrid.ConnectorsSorter=function(){var a=this;this._connectors=null;this._css={};this._construct=function(){};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){a._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ConnectorsSorter.prototype.attachConnectors=function(a){this._connectors=a};Gridifier.HorizontalGrid.ConnectorsSorter.prototype.getConnectors=function(){return this._connectors};Gridifier.HorizontalGrid.ConnectorsSorter.prototype.sortConnectorsForPrepend=function(a){var b=this;this._connectors.sort(function(b,c){if(b.x==c.x){if(a==Gridifier.PREPEND_TYPES.DEFAULT_PREPEND){if(b.y<c.y)return 1;else return-1}else if(a==Gridifier.PREPEND_TYPES.REVERSED_PREPEND){if(b.y>c.y)return 1;else return-1}}else{if(b.x<c.x)return 1;else return-1}})};Gridifier.HorizontalGrid.ConnectorsSorter.prototype.sortConnectorsForAppend=function(a){var b=this;this._connectors.sort(function(b,c){if(b.x==c.x){if(a==Gridifier.APPEND_TYPES.DEFAULT_APPEND){if(b.y<c.y)return-1;else return 1}else if(a==Gridifier.APPEND_TYPES.REVERSED_APPEND){if(b.y>c.y)return-1;else return 1}}else{if(b.x<c.x)return-1;else return 1}})};Gridifier.HorizontalGrid.ItemCoordsExtractor=function(a,b){var c=this;this._gridifier=null;this._sizesResolverManager=null;this._transformedItemMarker=null;this._css={};this._construct=function(){c._gridifier=a;c._sizesResolverManager=b;c._transformedItemMarker=new Gridifier.SizesTransformer.TransformedItemMarker};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ItemCoordsExtractor.prototype._getItemSizesPerAppend=function(a){if(this._transformedItemMarker.isTransformedItem(a)){var b=this._transformedItemMarker.getTransformedItemTargetPxSizes(a);return{targetWidth:parseFloat(b.targetPxWidth),targetHeight:parseFloat(b.targetPxHeight)}}else{return{targetWidth:this._sizesResolverManager.outerWidth(a,true),targetHeight:this._sizesResolverManager.outerHeight(a,true)}}};Gridifier.HorizontalGrid.ItemCoordsExtractor.prototype.getItemTargetSizes=function(a){return this._getItemSizesPerAppend(a)};Gridifier.HorizontalGrid.ItemCoordsExtractor.prototype.connectorToAppendedItemCoords=function(a,b){var c=this._getItemSizesPerAppend(a);return{x1:parseFloat(b.x),x2:parseFloat(b.x+c.targetWidth-1),y1:parseFloat(b.y),y2:parseFloat(b.y+c.targetHeight-1)}};Gridifier.HorizontalGrid.ItemCoordsExtractor.prototype.connectorToReversedAppendedItemCoords=function(a,b){var c=this._getItemSizesPerAppend(a);return{x1:parseFloat(b.x),x2:parseFloat(b.x+c.targetWidth-1),y1:parseFloat(b.y-c.targetHeight+1),y2:parseFloat(b.y)}};Gridifier.HorizontalGrid.ItemCoordsExtractor.prototype.connectorToPrependedItemCoords=function(a,b){var c=this._getItemSizesPerAppend(a);return{x1:parseFloat(b.x-c.targetWidth+1),x2:parseFloat(b.x),y1:parseFloat(b.y-c.targetHeight+1),y2:parseFloat(b.y)}};Gridifier.HorizontalGrid.ItemCoordsExtractor.prototype.connectorToReversedPrependedItemCoords=function(a,b){var c=this._getItemSizesPerAppend(a);return{x1:parseFloat(b.x-c.targetWidth+1),x2:parseFloat(b.x),y1:parseFloat(b.y),y2:parseFloat(b.y+c.targetHeight-1)}};Gridifier.HorizontalGrid.Prepender=function(a,b,c,d,e,f,g,h,i){var j=this;this._gridifier=null;this._settings=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectorsCleaner=null;this._connectorsShifter=null;this._connectorsSelector=null;this._connectorsSorter=null;this._itemCoordsExtractor=null;this._connectionsIntersector=null;this._guid=null;this._renderer=null;this._normalizer=null;this._operation=null;this._css={};this._construct=function(){j._gridifier=a;j._settings=b;j._sizesResolverManager=c;j._connectors=d;j._connections=e;j._connectorsCleaner=new Gridifier.HorizontalGrid.ConnectorsCleaner(j._connectors,j._connections,j._settings);j._connectorsShifter=new Gridifier.ConnectorsShifter(j._gridifier,j._connections,j._settings);j._connectorsSelector=new Gridifier.HorizontalGrid.ConnectorsSelector(j._guid);j._connectorsSorter=new Gridifier.HorizontalGrid.ConnectorsSorter;j._itemCoordsExtractor=new Gridifier.HorizontalGrid.ItemCoordsExtractor(j._gridifier,j._sizesResolverManager);j._connectionsIntersector=new Gridifier.HorizontalGrid.ConnectionsIntersector(j._connections);j._guid=f;j._renderer=g;j._normalizer=h;j._operation=i};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){j._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.Prepender.prototype.prepend=function(a){this._initConnectors();var b=this._createConnectionPerItem(a);var c=this._connections.normalizeHorizontalPositionsOfAllConnectionsAfterPrepend(b,this._connectors.get());this._connections.attachConnectionToRanges(b);this._connectorsCleaner.deleteAllTooRightConnectorsFromMostLeftConnector();this._connectorsCleaner.deleteAllIntersectedFromLeftConnectors();if(c){this._renderer.renderConnections(this._connections.get(),[b])}if(this._settings.isDefaultIntersectionStrategy())this._renderer.showConnections(b);else if(this._settings.isNoIntersectionsStrategy()){var d=this._connections.getLastColHorizontallyExpandedConnections();for(var e=0;e<d.length;e++){if(d[e].itemGUID==b.itemGUID){d.splice(e,1);e--}}this._renderer.renderConnections(d);this._renderer.showConnections(b)}};Gridifier.HorizontalGrid.Prepender.prototype._initConnectors=function(){if(this._operation.isInitialOperation(Gridifier.OPERATIONS.PREPEND)){this.createInitialConnector();return}if(!this._operation.isCurrentOperationSameAsPrevious(Gridifier.OPERATIONS.PREPEND)){this.recreateConnectorsPerAllConnectedItems();this._connectorsCleaner.deleteAllIntersectedFromLeftConnectors();this._connectorsCleaner.deleteAllTooRightConnectorsFromMostLeftConnector()}};Gridifier.HorizontalGrid.Prepender.prototype.createInitialConnector=function(){this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.TOP.RIGHT,0,this._gridifier.getGridY2())
};Gridifier.HorizontalGrid.Prepender.prototype.recreateConnectorsPerAllConnectedItems=function(){this._connectors.flush();var a=this._connections.get();for(var b=0;b<a.length;b++){this._addItemConnectors(a[b],a[b].itemGUID)}if(this._connectors.count()==0)this.createInitialConnector()};Gridifier.HorizontalGrid.Prepender.prototype._addItemConnectors=function(a,b){if(a.y1-1>=0){this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.TOP.RIGHT,parseFloat(a.x2),parseFloat(a.y1-1),Dom.toInt(b))}this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.LEFT.BOTTOM,parseFloat(a.x1-1),parseFloat(a.y2),Dom.toInt(b))};Gridifier.HorizontalGrid.Prepender.prototype._createConnectionPerItem=function(a){var b=this._filterConnectorsPerNextConnection();var c=this._findItemConnectionCoords(a,b);var d=this._connections.add(a,c);if(this._settings.isNoIntersectionsStrategy()){this._connections.expandHorizontallyAllColConnectionsToMostWide(d)}this._addItemConnectors(c,this._guid.getItemGUID(a));return d};Gridifier.HorizontalGrid.Prepender.prototype._filterConnectorsPerNextConnection=function(){var a=this._connectors.getClone();if(this._settings.isDefaultIntersectionStrategy()){this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllConnectors();a=this._connectorsShifter.getAllConnectors()}else if(this._settings.isNoIntersectionsStrategy()){var b=Gridifier.Connectors.SIDES.LEFT.BOTTOM;this._connectorsSelector.attachConnectors(a);this._connectorsSelector.selectOnlyMostLeftConnectorFromSide(b);a=this._connectorsSelector.getSelectedConnectors();this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllWithSpecifiedSideToBottomGridCorner(b);a=this._connectorsShifter.getAllConnectors()}this._connectorsSorter.attachConnectors(a);this._connectorsSorter.sortConnectorsForPrepend(Gridifier.PREPEND_TYPES.DEFAULT_PREPEND);return this._connectorsSorter.getConnectors()};Gridifier.HorizontalGrid.Prepender.prototype._findItemConnectionCoords=function(a,b){var c=null;for(var d=0;d<b.length;d++){var e=this._itemCoordsExtractor.connectorToPrependedItemCoords(a,b[d]);if(e.y1<this._normalizer.normalizeLowRounding(0)){continue}var f=this._connectionsIntersector.findAllMaybeIntersectableConnectionsOnPrepend(b[d]);if(this._connectionsIntersector.isIntersectingAnyConnection(f,e)){continue}c=e;var g=this._connections.getAllConnectionsBeforeX(e.x1);if(this._connections.isAnyConnectionItemGUIDBiggerThan(g,a)){continue}if(this._settings.isNoIntersectionsStrategy()){if(this._connections.isIntersectingMoreThanOneConnectionItemHorizontally(c)){c=null}}if(c!=null){break}}return c};Gridifier.HorizontalGrid.ReversedAppender=function(a,b,c,d,e,f,g,h,i){var j=this;this._gridifier=null;this._settings=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectorsCleaner=null;this._connectorsShifter=null;this._connectorsSelector=null;this._connectorsSorter=null;this._itemCoordsExtractor=null;this._connectionsIntersector=null;this._guid=null;this._renderer=null;this._normalizer=null;this._operation=null;this._css={};this._construct=function(){j._gridifier=a;j._settings=b;j._sizesResolverManager=c;j._connectors=d;j._connections=e;j._connectorsCleaner=new Gridifier.HorizontalGrid.ConnectorsCleaner(j._connectors,j._connections,j._settings);j._connectorsShifter=new Gridifier.ConnectorsShifter(j._gridifier,j._connections,j._settings);j._connectorsSelector=new Gridifier.HorizontalGrid.ConnectorsSelector(j._guid);j._connectorsSorter=new Gridifier.HorizontalGrid.ConnectorsSorter;j._itemCoordsExtractor=new Gridifier.HorizontalGrid.ItemCoordsExtractor(j._gridifier,j._sizesResolverManager);j._connectionsIntersector=new Gridifier.HorizontalGrid.ConnectionsIntersector(j._connections);j._guid=f;j._renderer=g;j._normalizer=h;j._operation=i};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){j._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ReversedAppender.prototype.reversedAppend=function(a){this._initConnectors();var b=this._createConnectionPerItem(a);this._connections.attachConnectionToRanges(b);this._connectorsCleaner.deleteAllTooLeftConnectorsFromMostRightConnector();this._connectorsCleaner.deleteAllIntersectedFromRightConnectors();if(this._settings.isDefaultIntersectionStrategy())this._renderer.showConnections(b);else if(this._settings.isNoIntersectionsStrategy()){var c=this._connections.getLastColHorizontallyExpandedConnections();for(var d=0;d<c.length;d++){if(c[d].itemGUID==b.itemGUID){c.splice(d,1);d--}}this._renderer.renderConnections(c);this._renderer.showConnections(b)}};Gridifier.HorizontalGrid.ReversedAppender.prototype._initConnectors=function(){if(this._operation.isInitialOperation(Gridifier.OPERATIONS.REVERSED_APPEND)){this.createInitialConnector();return}if(!this._operation.isCurrentOperationSameAsPrevious(Gridifier.OPERATIONS.REVERSED_APPEND)){this.recreateConnectorsPerAllConnectedItems();this._connectorsCleaner.deleteAllIntersectedFromRightConnectors();this._connectorsCleaner.deleteAllTooLeftConnectorsFromMostRightConnector()}};Gridifier.HorizontalGrid.ReversedAppender.prototype.createInitialConnector=function(){this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.TOP.LEFT,0,parseFloat(this._gridifier.getGridY2()))};Gridifier.HorizontalGrid.ReversedAppender.prototype.recreateConnectorsPerAllConnectedItems=function(){this._connectors.flush();var a=this._connections.get();for(var b=0;b<a.length;b++){this._addItemConnectors(a[b],a[b].itemGUID)}if(this._connectors.count()==0)this.createInitialConnector()};Gridifier.HorizontalGrid.ReversedAppender.prototype._addItemConnectors=function(a,b){if(a.y1-1>=0){this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.TOP.LEFT,parseFloat(a.x1),parseFloat(a.y1-1),Dom.toInt(b))}this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.RIGHT.BOTTOM,parseFloat(a.x2+1),parseFloat(a.y2),Dom.toInt(b))};Gridifier.HorizontalGrid.ReversedAppender.prototype._createConnectionPerItem=function(a){var b=this._filterConnectorsPerNextConnection();var c=this._findItemConnectionCoords(a,b);var d=this._connections.add(a,c);if(this._settings.isNoIntersectionsStrategy()){this._connections.expandHorizontallyAllColConnectionsToMostWide(d)}this._addItemConnectors(c,this._guid.getItemGUID(a));return d};Gridifier.HorizontalGrid.ReversedAppender.prototype._filterConnectorsPerNextConnection=function(){var a=this._connectors.getClone();if(this._settings.isDefaultIntersectionStrategy()){this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllConnectors();a=this._connectorsShifter.getAllConnectors()}else if(this._settings.isNoIntersectionsStrategy()){var b=Gridifier.Connectors.SIDES.RIGHT.BOTTOM;this._connectorsSelector.attachConnectors(a);this._connectorsSelector.selectOnlyMostRightConnectorFromSide(b);a=this._connectorsSelector.getSelectedConnectors();this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllWithSpecifiedSideToBottomGridCorner(b);a=this._connectorsShifter.getAllConnectors()}this._connectorsSorter.attachConnectors(a);this._connectorsSorter.sortConnectorsForAppend(Gridifier.APPEND_TYPES.REVERSED_APPEND);return this._connectorsSorter.getConnectors()};Gridifier.HorizontalGrid.ReversedAppender.prototype._findItemConnectionCoords=function(a,b){var c=null;for(var d=0;d<b.length;d++){var e=this._itemCoordsExtractor.connectorToReversedAppendedItemCoords(a,b[d]);if(e.y1<this._normalizer.normalizeLowRounding(0)){continue}var f=this._connectionsIntersector.findAllMaybeIntersectableConnectionsOnAppend(b[d]);if(this._connectionsIntersector.isIntersectingAnyConnection(f,e)){continue}c=e;var g=this._connections.getAllConnectionsBehindX(e.x2);if(this._connections.isAnyConnectionItemGUIDSmallerThan(g,a)){continue}if(this._settings.isNoIntersectionsStrategy()){if(this._connections.isIntersectingMoreThanOneConnectionItemHorizontally(c)){c=null}}if(c!=null){break}}return c};Gridifier.HorizontalGrid.ReversedPrepender=function(a,b,c,d,e,f,g,h,i){var j=this;this._gridifier=null;this._settings=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectorsCleaner=null;this._connectorsShifter=null;this._connectorsSelector=null;this._connectorsSorter=null;this._itemCoordsExtractor=null;this._connectionsIntersector=null;this._guid=null;this._renderer=null;this._normalizer=null;this._operation=null;this._css={};this._construct=function(){j._gridifier=a;j._settings=b;j._sizesResolverManager=c;j._connectors=d;j._connections=e;j._connectorsCleaner=new Gridifier.HorizontalGrid.ConnectorsCleaner(j._connectors,j._connections,j._settings);j._connectorsShifter=new Gridifier.ConnectorsShifter(j._gridifier,j._connections,j._settings);j._connectorsSelector=new Gridifier.HorizontalGrid.ConnectorsSelector(j._guid);j._connectorsSorter=new Gridifier.HorizontalGrid.ConnectorsSorter;j._itemCoordsExtractor=new Gridifier.HorizontalGrid.ItemCoordsExtractor(j._gridifier,j._sizesResolverManager);j._connectionsIntersector=new Gridifier.HorizontalGrid.ConnectionsIntersector(j._connections);j._guid=f;j._renderer=g;j._normalizer=h;j._operation=i};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){j._unbindEvents()};this._construct();return this};Gridifier.HorizontalGrid.ReversedPrepender.prototype.reversedPrepend=function(a){this._initConnectors();var b=this._createConnectionPerItem(a);var c=this._connections.normalizeHorizontalPositionsOfAllConnectionsAfterPrepend(b,this._connectors.get());this._connections.attachConnectionToRanges(b);this._connectorsCleaner.deleteAllTooRightConnectorsFromMostLeftConnector();this._connectorsCleaner.deleteAllIntersectedFromLeftConnectors();if(c){this._renderer.renderConnections(this._connections.get(),[b])}if(this._settings.isDefaultIntersectionStrategy())this._renderer.showConnections(b);else if(this._settings.isNoIntersectionsStrategy()){var d=this._connections.getLastColHorizontallyExpandedConnections();for(var e=0;e<d.length;e++){if(d[e].itemGUID==b.itemGUID){d.splice(e,1);e--}}this._renderer.renderConnections(d);this._renderer.showConnections(b)}};Gridifier.HorizontalGrid.ReversedPrepender.prototype._initConnectors=function(){if(this._operation.isInitialOperation(Gridifier.OPERATIONS.REVERSED_PREPEND)){this.createInitialConnector();return}if(!this._operation.isCurrentOperationSameAsPrevious(Gridifier.OPERATIONS.REVERSED_PREPEND)){this.recreateConnectorsPerAllConnectedItems();this._connectorsCleaner.deleteAllIntersectedFromLeftConnectors();this._connectorsCleaner.deleteAllTooRightConnectorsFromMostLeftConnector()}};Gridifier.HorizontalGrid.ReversedPrepender.prototype.createInitialConnector=function(){this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.BOTTOM.RIGHT,0,0)};Gridifier.HorizontalGrid.ReversedPrepender.prototype.recreateConnectorsPerAllConnectedItems=function(){this._connectors.flush();var a=this._connections.get();for(var b=0;b<a.length;b++){this._addItemConnectors(a[b],a[b].itemGUID)}if(this._connectors.count()==0)this.createInitialConnector()};Gridifier.HorizontalGrid.ReversedPrepender.prototype._addItemConnectors=function(a,b){if(a.y2+1<=this._gridifier.getGridY2()){this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.BOTTOM.RIGHT,parseFloat(a.x2),parseFloat(a.y2+1),Dom.toInt(b))}this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.LEFT.TOP,parseFloat(a.x1-1),parseFloat(a.y1),Dom.toInt(b))};Gridifier.HorizontalGrid.ReversedPrepender.prototype._createConnectionPerItem=function(a){var b=this._filterConnectorsPerNextConnection();var c=this._findItemConnectionCoords(a,b);var d=this._connections.add(a,c);if(this._settings.isNoIntersectionsStrategy()){this._connections.expandHorizontallyAllColConnectionsToMostWide(d)}this._addItemConnectors(c,this._guid.getItemGUID(a));return d};Gridifier.HorizontalGrid.ReversedPrepender.prototype._filterConnectorsPerNextConnection=function(){var a=this._connectors.getClone();if(this._settings.isDefaultIntersectionStrategy()){this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllConnectors();a=this._connectorsShifter.getAllConnectors()}else if(this._settings.isNoIntersectionsStrategy()){var b=Gridifier.Connectors.SIDES.LEFT.TOP;this._connectorsSelector.attachConnectors(a);this._connectorsSelector.selectOnlyMostLeftConnectorFromSide(b);a=this._connectorsSelector.getSelectedConnectors();this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllWithSpecifiedSideToTopGridCorner(b);a=this._connectorsShifter.getAllConnectors()}this._connectorsSorter.attachConnectors(a);this._connectorsSorter.sortConnectorsForPrepend(Gridifier.PREPEND_TYPES.REVERSED_PREPEND);return this._connectorsSorter.getConnectors()};Gridifier.HorizontalGrid.ReversedPrepender.prototype._findItemConnectionCoords=function(a,b){var c=null;for(var d=0;d<b.length;d++){var e=this._itemCoordsExtractor.connectorToReversedPrependedItemCoords(a,b[d]);if(e.y2>this._normalizer.normalizeHighRounding(this._gridifier.getGridY2())){continue}var f=this._connectionsIntersector.findAllMaybeIntersectableConnectionsOnPrepend(b[d]);if(this._connectionsIntersector.isIntersectingAnyConnection(f,e)){continue}c=e;var g=this._connections.getAllConnectionsBeforeX(e.x1);if(this._connections.isAnyConnectionItemGUIDBiggerThan(g,a)){continue}if(this._settings.isNoIntersectionsStrategy()){if(this._connections.isIntersectingMoreThanOneConnectionItemHorizontally(c)){c=null}}if(c!=null){break}}return c};Gridifier.Operations.Append=function(a,b,c,d,e,f,g,h,i,j){var k=this;this._gridSizesUpdater=null;this._collector=null;this._connections=null;this._connectionsSorter=null;this._guid=null;this._settings=null;this._appender=null;this._reversedAppender=null;this._sizesTransformer=null;this._sizesResolverManager=null;this._css={};this._construct=function(){k._gridSizesUpdater=a;k._collector=b;k._connections=c;k._connectionsSorter=d;k._guid=e;k._settings=f;k._appender=g;k._reversedAppender=h;k._sizesTransformer=i;k._sizesResolverManager=j};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){k._unbindEvents()};this._construct();return this};Gridifier.Operations.Append.prototype.execute=function(a){var a=this._collector.toDOMCollection(a);this._sizesResolverManager.startCachingTransaction();this._collector.ensureAllItemsAreAttachedToGrid(a);this._collector.ensureAllItemsCanBeAttachedToGrid(a);a=this._collector.filterCollection(a);a=this._collector.sortCollection(a);for(var b=0;b<a.length;b++){this._guid.markNextAppendedItem(a[b]);this._append(a[b])}this._sizesResolverManager.stopCachingTransaction();this._gridSizesUpdater.scheduleGridSizesUpdate()};Gridifier.Operations.Append.prototype._append=function(a){if(this._settings.isDefaultAppend()){this._appender.append(a)}else if(this._settings.isReversedAppend()){this._reversedAppender.reversedAppend(a)}};Gridifier.Operations.Append.prototype.executeInsertBefore=function(a,b){var c=this._connections.get();if(c.length==0){this.execute(a);return}var d=[];c=this._connectionsSorter.sortConnectionsPerReappend(c);if(typeof b=="undefined"||b==null){var b=c[0].item}else{var b=this._collector.toDOMCollection(b)[0];if(typeof b=="undefined"||b==null)var b=c[0].item}var e=null;var f=false;for(var g=0;g<c.length;g++){if(this._guid.getItemGUID(c[g].item)==this._guid.getItemGUID(b)){f=true;e=c[g].itemGUID;d=d.concat(c.splice(g,c.length-g));break}}if(!f){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.APPENDER.WRONG_INSERT_BEFORE_TARGET_ITEM,b);return}this._connections.reinitRanges();this._guid.reinitMaxGUID(e-1);if(this._settings.isDefaultAppend())this._appender.recreateConnectorsPerAllConnectedItems();else if(this._settings.isReversedAppend())this._reversedAppender.recreateConnectorsPerAllConnectedItems();this.execute(a);if(this._settings.isDisabledSortDispersion()){this._connections.restore(d);this._connections.remapAllItemGUIDSInSortedConnections(d)}else if(this._settings.isCustomAllEmptySpaceSortDispersion()){this._connections.restoreOnCustomSortDispersionMode(d);this._connections.remapAllItemGUIDS()}this._sizesTransformer.retransformFrom(d[0])};Gridifier.Operations.Append.prototype.executeInsertAfter=function(a,b){var c=this._connections.get();if(c.length==0){this.execute(a);return}var d=[];c=this._connectionsSorter.sortConnectionsPerReappend(c);if(typeof b=="undefined"||b==null){var b=c[c.length-1].item}else{var b=this._collector.toDOMCollection(b)[0];if(typeof b=="undefined"||b==null)var b=c[c.length-1].item}var e=null;var f=false;for(var g=0;g<c.length;g++){if(this._guid.getItemGUID(c[g].item)==this._guid.getItemGUID(b)){f=true;e=c[g].itemGUID;d=d.concat(c.splice(g+1,c.length-g-1));break}}if(!f){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.APPENDER.WRONG_INSERT_AFTER_TARGET_ITEM,b);return}this._connections.reinitRanges();this._guid.reinitMaxGUID(e+1);if(this._settings.isDefaultAppend())this._appender.recreateConnectorsPerAllConnectedItems();else if(this._settings.isReversedAppend())this._reversedAppender.recreateConnectorsPerAllConnectedItems();this.execute(a);if(this._settings.isDisabledSortDispersion()){this._connections.restore(d);this._connections.remapAllItemGUIDSInSortedConnections(d)}else if(this._settings.isCustomAllEmptySpaceSortDispersion()){this._connections.restoreOnCustomSortDispersionMode(d);this._connections.remapAllItemGUIDS()}if(d.length>0)this._sizesTransformer.retransformFrom(d[0])};Gridifier.Operations.Prepend=function(a,b,c,d,e,f,g){var h=this;this._gridSizesUpdater=null;this._collector=null;this._guid=null;this._settings=null;this._prepender=null;this._reversedPrepender=null;this._sizesResolverManager=null;this._css={};this._construct=function(){h._gridSizesUpdater=a;h._collector=b;h._guid=c;h._settings=d;h._prepender=e;h._reversedPrepender=f;h._sizesResolverManager=g};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){h._unbindEvents()};this._construct();return this};Gridifier.Operations.Prepend.prototype.execute=function(a){var a=this._collector.toDOMCollection(a);this._sizesResolverManager.startCachingTransaction();this._collector.ensureAllItemsAreAttachedToGrid(a);this._collector.ensureAllItemsCanBeAttachedToGrid(a);a=this._collector.filterCollection(a);a=this._collector.sortCollection(a);for(var b=0;b<a.length;b++){this._guid.markNextPrependedItem(a[b]);this._prepend(a[b])}this._sizesResolverManager.stopCachingTransaction();this._gridSizesUpdater.scheduleGridSizesUpdate()};Gridifier.Operations.Prepend.prototype._prepend=function(a){if(this._settings.isDefaultPrepend()){this._prepender.prepend(a)}else if(this._settings.isReversedPrepend()){this._reversedPrepender.reversedPrepend(a)}};Gridifier.Operations.Queue=function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this;this._gridSizesUpdater=null;this._collector=null;this._connections=null;this._connectionsSorter=null;this._guid=null;this._settings=null;this._prepender=null;this._reversedPrepender=null;this._appender=null;this._reversedAppender=null;this._sizesTransformer=null;this._sizesResolverManager=null;this._operationsQueue=null;this._queuedOperations=[];this._isWaitingForTransformerQueueRelease=false;this._prependOperation=null;this._appendOperation=null;this._css={};this._construct=function(){m._gridSizesUpdater=a;m._collector=b;m._connections=c;m._connectionsSorter=d;m._guid=e;m._settings=f;m._prepender=g;m._reversedPrepender=h;m._appender=i;m._reversedAppender=j;m._sizesTransformer=k;m._sizesResolverManager=l;m._prependOperation=new Gridifier.Operations.Prepend(m._gridSizesUpdater,m._collector,m._guid,m._settings,m._prepender,m._reversedPrepender,m._sizesResolverManager);m._appendOperation=new Gridifier.Operations.Append(m._gridSizesUpdater,m._collector,m._connections,m._connectionsSorter,m._guid,m._settings,m._appender,m._reversedAppender,m._sizesTransformer,m._sizesResolverManager)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){m._unbindEvents()};this._construct();return this};Gridifier.Operations.Queue.QUEUED_OPERATION_TYPES={PREPEND:0,APPEND:1,INSERT_BEFORE:2,INSERT_AFTER:3};Gridifier.Operations.Queue.PROCESS_QUEUED_OPERATIONS_TIMEOUT=100;Gridifier.Operations.Queue.DEFAULT_BATCH_TIMEOUT=100;Gridifier.Operations.Queue.prototype.schedulePrependOperation=function(a,b,c){var d=this;var e=function(a){setTimeout(function(){if(d._sizesTransformer.isTransformerQueueEmpty()){d._executePrependOperation.call(d,a)}else{d._queuedOperations.push({queuedOperationType:Gridifier.Operations.Queue.QUEUED_OPERATION_TYPES.PREPEND,items:a});if(d._isWaitingForTransformerQueueRelease)return;setTimeout(function(){d._isWaitingForTransformerQueueRelease=true;d._processQueuedOperations.call(d)},Gridifier.Operations.Queue.PROCESS_QUEUED_OPERATIONS_TIMEOUT)}},0)};if(typeof b=="undefined"){e.call(d,a);return}var c=c||Gridifier.Operations.Queue.DEFAULT_BATCH_TIMEOUT;var f=this._packItemsToBatches(a,b);for(var g=0;g<f.length;g++){(function(a,b){setTimeout(function(){e.call(d,a)},c*b)})(f[g],g)}};Gridifier.Operations.Queue.prototype.scheduleAppendOperation=function(a,b,c){var d=this;var e=function(a){setTimeout(function(){if(d._sizesTransformer.isTransformerQueueEmpty()){d._executeAppendOperation.call(d,a)}else{d._queuedOperations.push({queuedOperationType:Gridifier.Operations.Queue.QUEUED_OPERATION_TYPES.APPEND,items:a});if(d._isWaitingForTransformerQueueRelease)return;setTimeout(function(){d._isWaitingForTransformerQueueRelease=true;d._processQueuedOperations.call(d)},Gridifier.Operations.Queue.PROCESS_QUEUED_OPERATIONS_TIMEOUT)}},0)};if(typeof b=="undefined"){e.call(d,a);return}var c=c||Gridifier.Operations.Queue.DEFAULT_BATCH_TIMEOUT;var f=this._packItemsToBatches(a,b);for(var g=0;g<f.length;g++){(function(a,b){setTimeout(function(){e.call(d,a)},c*b)})(f[g],g)}};Gridifier.Operations.Queue.prototype.scheduleInsertBeforeOperation=function(a,b,c,d){var e=this;var f=function(a,b){setTimeout(function(){if(e._sizesTransformer.isTransformerQueueEmpty()){e._executeInsertBeforeOperation.call(e,a,b)}else{e._queuedOperations.push({queuedOperationType:Gridifier.Operations.Queue.QUEUED_OPERATION_TYPES.INSERT_BEFORE,items:a,beforeItem:b});if(e._isWaitingForTransformerQueueRelease)return;setTimeout(function(){e._isWaitingForTransformerQueueRelease=true;e._processQueuedOperations.call(e)},Gridifier.Operations.Queue.PROCESS_QUEUED_OPERATIONS_TIMEOUT)}},0)};if(typeof c=="undefined"){f.call(e,a,b);return}var d=d||Gridifier.Operations.Queue.DEFAULT_BATCH_TIMEOUT;var g=this._packItemsToBatches(a,c);for(var h=0;h<g.length;h++){(function(a,c){setTimeout(function(){f.call(e,a,b)},d*c)})(g[h],h)}};Gridifier.Operations.Queue.prototype.scheduleInsertAfterOperation=function(a,b,c,d){var e=this;var f=function(a,b){setTimeout(function(){if(e._sizesTransformer.isTransformerQueueEmpty()){e._executeInsertAfterOperation.call(e,a,b)}else{e._queuedOperations.push({queuedOperationType:Gridifier.Operations.Queue.QUEUED_OPERATION_TYPES.INSERT_AFTER,items:a,afterItem:b});if(e._isWaitingForTransformerQueueRelease)return;setTimeout(function(){e._isWaitingForTransformerQueueRelease=true;e._processQueuedOperations.call(e)},Gridifier.Operations.Queue.PROCESS_QUEUED_OPERATIONS_TIMEOUT)}},0)};if(typeof c=="undefined"){f.call(e,a,b);return}var d=d||Gridifier.Operations.Queue.DEFAULT_BATCH_TIMEOUT;var g=this._packItemsToBatches(a,c);for(var h=0;h<g.length;h++){(function(a,c){setTimeout(function(){f.call(e,a,b)},d*c)})(g[h],h)}};Gridifier.Operations.Queue.prototype._packItemsToBatches=function(a,b){var a=this._collector.toDOMCollection(a);var c=[];var d=0;var e=[];var f=false;for(var g=0;g<a.length;g++){e.push(a[g]);f=false;d++;if(d==b){c.push(e);e=[];f=true;d=0}}if(!f)c.push(e);return c};Gridifier.Operations.Queue.prototype._processQueuedOperations=function(){var a=this;var b=true;for(var c=0;c<this._queuedOperations.length;c++){if(!this._sizesTransformer.isTransformerQueueEmpty()){setTimeout(function(){a._processQueuedOperations.call(a)},Gridifier.Operations.Queue.PROCESS_QUEUED_OPERATIONS_TIMEOUT);b=false;break}var d=Gridifier.Operations.Queue.QUEUED_OPERATION_TYPES;if(this._queuedOperations[c].queuedOperationType==d.APPEND){this._executeAppendOperation(this._queuedOperations[c].items)}else if(this._queuedOperations[c].queuedOperationType==d.PREPEND){this._executePrependOperation(this._queuedOperations[c].items)}else if(this._queuedOperations[c].queuedOperationType==d.INSERT_BEFORE){this._executeInsertBeforeOperation(this._queuedOperations[c].items,this._queuedOperations[c].beforeItem)}else if(this._queuedOperations[c].queuedOperationType==d.INSERT_AFTER){this._executeInsertAfterOperation(this._queuedOperations[c].items,this._queuedOperations[c].afterItem)}else{var e=this._queuedOperations[c].queuedOperationType;throw new Error("Unknown queued operation type = '"+e+"'")}this._queuedOperations.shift();c--}if(b)this._isWaitingForTransformerQueueRelease=false};Gridifier.Operations.Queue.prototype._executePrependOperation=function(a){this._prependOperation.execute(a)};Gridifier.Operations.Queue.prototype._executeAppendOperation=function(a){this._appendOperation.execute(a)};Gridifier.Operations.Queue.prototype._executeInsertBeforeOperation=function(a,b){this._appendOperation.executeInsertBefore(a,b)};Gridifier.Operations.Queue.prototype._executeInsertAfterOperation=function(a,b){this._appendOperation.executeInsertAfter(a,b)};Gridifier.Renderer=function(a,b,c,d){var e=this;this._gridifier=null;this._connections=null;this._settings=null;this._normalizer=null;this._transformedItemMarker=null;this._rendererSchedulator=null;this._rendererConnections=null;this._css={};this._construct=function(){e._gridifier=a;e._connections=b;e._settings=c;e._normalizer=d;e._transformedItemMarker=new Gridifier.SizesTransformer.TransformedItemMarker;e._rendererSchedulator=new Gridifier.Renderer.Schedulator(e._gridifier,e._settings,e);e._rendererConnections=new Gridifier.Renderer.Connections(e._settings)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){e._unbindEvents()};this._construct();return this};Gridifier.Renderer.prototype.showConnections=function(a){var b=this;if(!Dom.isArray(a))var a=[a];for(var c=0;c<a.length;c++){if(this._rendererConnections.isConnectionItemRendered(a[c]))continue;var d=this._rendererConnections.getCssLeftPropertyValuePerConnection(a[c]);var e=this._rendererConnections.getCssTopPropertyValuePerConnection(a[c]);this._rendererConnections.markConnectionItemAsRendered(a[c]);this._rendererSchedulator.reinit();this._rendererSchedulator.scheduleShow(a[c],d,e)}};Gridifier.Renderer.prototype.hideConnections=function(a){var b=this;if(!Dom.isArray(a))var a=[a];for(var c=0;c<a.length;c++){var d=this._rendererConnections.getCssLeftPropertyValuePerConnection(a[c]);var e=this._rendererConnections.getCssTopPropertyValuePerConnection(a[c]);this._rendererConnections.unmarkConnectionItemAsRendered(a[c]);this._rendererSchedulator.reinit();this._rendererSchedulator.scheduleHide(a[c],d,e)}};Gridifier.Renderer.prototype.renderTransformedConnections=function(a){for(var b=0;b<a.length;b++){var c=this._rendererConnections.getCssLeftPropertyValuePerConnection(a[b]);var d=this._rendererConnections.getCssTopPropertyValuePerConnection(a[b]);this._rendererSchedulator.reinit();if(this._transformedItemMarker.isTransformedItem(a[b].item)){var e=this._transformedItemMarker.getTransformedItemTargetRawSizes(a[b].item);this._rendererSchedulator.scheduleRenderTransformed(a[b],c,d,e.targetRawWidth,e.targetRawHeight);this._transformedItemMarker.unmarkItemAsTransformed(a[b].item)}else if(this._transformedItemMarker.isDependedItem(a[b].item)){this._rendererSchedulator.scheduleRenderDepended(a[b],c,d);this._transformedItemMarker.unmarkItemAsDepended(a[b].item)}}};Gridifier.Renderer.prototype.renderConnections=function(a,b){var b=b||false;for(var c=0;c<a.length;c++){if(b){var d=false;for(var e=0;e<b.length;e++){if(a[c].itemGUID==b[e].itemGUID){d=true;break}}if(d)continue}var f=this._rendererConnections.getCssLeftPropertyValuePerConnection(a[c]);var g=this._rendererConnections.getCssTopPropertyValuePerConnection(a[c]);this._rendererSchedulator.reinit();this._rendererSchedulator.scheduleRender(a[c],f,g)}};Gridifier.Renderer.Connections=function(a){var b=this;this._settings=null;this._css={};this._construct=function(){b._settings=a};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.Renderer.Connections.CONNECTION_RENDERED_ITEM_DATA_CLASS="gridifier-connection-rendered";Gridifier.Renderer.Connections.prototype.isConnectionItemRendered=function(a){return Dom.css.hasClass(a.item,Gridifier.Renderer.Connections.CONNECTION_RENDERED_ITEM_DATA_CLASS)};Gridifier.Renderer.Connections.prototype.markConnectionItemAsRendered=function(a){Dom.css.addClass(a.item,Gridifier.Renderer.Connections.CONNECTION_RENDERED_ITEM_DATA_CLASS)};Gridifier.Renderer.Connections.prototype.unmarkConnectionItemAsRendered=function(a){Dom.css.removeClass(a.item,Gridifier.Renderer.Connections.CONNECTION_RENDERED_ITEM_DATA_CLASS)};Gridifier.Renderer.Connections.prototype.getCssLeftPropertyValuePerConnection=function(a){if(this._settings.isVerticalGrid()){var b=a.x1+"px"}else if(this._settings.isHorizontalGrid()){if(this._settings.isDefaultIntersectionStrategy()){var b=a.x1+"px"}else if(this._settings.isNoIntersectionsStrategy()){var b=a.x1+a.horizontalOffset+"px"}}return b};Gridifier.Renderer.Connections.prototype.getCssTopPropertyValuePerConnection=function(a){if(this._settings.isVerticalGrid()){if(this._settings.isDefaultIntersectionStrategy()){var b=a.y1+"px"}else if(this._settings.isNoIntersectionsStrategy()){var b=a.y1+a.verticalOffset+"px"}}else if(this._settings.isHorizontalGrid()){var b=a.y1+"px"}return b};Gridifier.Renderer.Schedulator=function(a,b,c){var d=this;this._gridifier=null;this._settings=null;this._renderer=null;this._scheduledConnectionsToProcessData=null;this._processScheduledConnectionsTimeout=null;this._css={};this._construct=function(){d._gridifier=a;d._settings=b;d._renderer=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.Renderer.Schedulator.PROCESS_SCHEDULED_CONNECTIONS_TIMEOUT=20;Gridifier.Renderer.Schedulator.SCHEDULED_CONNECTIONS_PROCESSING_TYPES={SHOW:0,HIDE:1,RENDER:2,RENDER_TRANSFORMED:3,RENDER_DEPENDED:4};Gridifier.Renderer.Schedulator.prototype.reinit=function(){if(this._scheduledConnectionsToProcessData==null){this._scheduledConnectionsToProcessData=[]}else{clearTimeout(this._processScheduledConnectionsTimeout);this._processScheduledConnectionsTimeout=null}};Gridifier.Renderer.Schedulator.prototype.scheduleShow=function(a,b,c){this._scheduledConnectionsToProcessData.push({connection:a,processingType:Gridifier.Renderer.Schedulator.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.SHOW,left:b,top:c});this._schedule()};Gridifier.Renderer.Schedulator.prototype.scheduleHide=function(a,b,c){this._scheduledConnectionsToProcessData.push({connection:a,processingType:Gridifier.Renderer.Schedulator.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.HIDE,left:b,top:c});this._schedule()};Gridifier.Renderer.Schedulator.prototype.scheduleRender=function(a,b,c){this._scheduledConnectionsToProcessData.push({connection:a,processingType:Gridifier.Renderer.Schedulator.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.RENDER,left:b,top:c});this._schedule()};Gridifier.Renderer.Schedulator.prototype.scheduleRenderTransformed=function(a,b,c,d,e){this._scheduledConnectionsToProcessData.push({connection:a,processingType:Gridifier.Renderer.Schedulator.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.RENDER_TRANSFORMED,left:b,top:c,targetWidth:d,targetHeight:e});this._schedule()};Gridifier.Renderer.Schedulator.prototype.scheduleRenderDepended=function(a,b,c){this._scheduledConnectionsToProcessData.push({connection:a,processingType:Gridifier.Renderer.Schedulator.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.RENDER_DEPENDED,left:b,top:c});
this._schedule()};Gridifier.Renderer.Schedulator.prototype._schedule=function(){var a=this;this._processScheduledConnectionsTimeout=setTimeout(function(){a._processScheduledConnections.call(a)},Gridifier.Renderer.Schedulator.PROCESS_SCHEDULED_CONNECTIONS_TIMEOUT)};Gridifier.Renderer.Schedulator.prototype._processScheduledConnections=function(){var a=Gridifier.Renderer.Schedulator;for(var b=0;b<this._scheduledConnectionsToProcessData.length;b++){var c=this._scheduledConnectionsToProcessData[b].connection;var d=this._scheduledConnectionsToProcessData[b].processingType;var e=this._scheduledConnectionsToProcessData[b].left;var f=this._scheduledConnectionsToProcessData[b].top;if(d==a.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.SHOW){Dom.css.set(c.item,{position:"absolute",left:e,top:f});var g=this._settings.getToggle();g.show(c.item,this._gridifier.getGrid())}else if(d==a.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.HIDE){Dom.css.set(c.disconnectedItemClone,{position:"absolute",left:e,top:f});var g=this._settings.getToggle();g.hide(c.item,c.disconnectedItemClone,this._gridifier.getGrid())}else if(d==a.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.RENDER){var h=this._settings.getCoordsChanger();h(c.item,e,f)}else if(d==a.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.RENDER_TRANSFORMED){var i=this._scheduledConnectionsToProcessData[b].targetWidth;var j=this._scheduledConnectionsToProcessData[b].targetHeight;var k=this._settings.getSizesChanger();k(c.item,i,j);var h=this._settings.getCoordsChanger();h(c.item,e,f)}else if(d==a.SCHEDULED_CONNECTIONS_PROCESSING_TYPES.RENDER_DEPENDED){var h=this._settings.getCoordsChanger();h(c.item,e,f)}}this._gridifier.scheduleGridSizesUpdate();this._scheduledConnectionsToProcessData=null;this._processScheduledConnectionsTimeout=null};Gridifier.ApiSettingsParser=function(a,b){var c=this;this._settingsCore=null;this._settings=null;this._css={};this._construct=function(){c._settingsCore=a;c._settings=b};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.ApiSettingsParser.prototype.parseToggleOptions=function(a){if(!this._settings.hasOwnProperty("toggle")){a.setToggleFunction("scale");return}if(typeof this._settings.toggle!="object"){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_TOGGLE_PARAM_VALUE,this._settings.toggle)}for(var b in this._settings.toggle){var c=this._settings.toggle[b];if(typeof c!="object"||typeof c.show=="undefined"||typeof c.hide=="undefined"){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_ONE_OF_TOGGLE_PARAMS,c)}a.addToggleFunction(b,toggleFunctionData)}a.setToggleFunction("scale")};Gridifier.ApiSettingsParser.prototype.parseSortOptions=function(a){if(!this._settings.hasOwnProperty("sort")){a.setSortFunction("default");return}if(typeof this._settings.sort=="function"){a.addSortFunction("clientDefault",this._settings.sort);a.setSortFunction("clientDefault");return}else if(typeof this._settings.sort=="object"){for(var b in this._settings.sort){var c=this._settings.sort[b];if(typeof c!="function"){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_ONE_OF_SORT_FUNCTION_TYPES,c)}a.addSortFunction(b,c)}a.setSortFunction("default");return}else{new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_SORT_PARAM_VALUE,this._settings.sort)}};Gridifier.ApiSettingsParser.prototype.parseFilterOptions=function(a){if(!this._settings.hasOwnProperty("filter")){a.setFilterFunction("all");return}if(typeof this._settings.filter=="function"){a.addFilterFunction("clientDefault",this._settings.filter);a.setFilterFunction("clientDefault");return}else if(typeof this._settings.filter=="object"){for(var b in this._settings.filter){var c=this._settings.filter[b];if(typeof c!="function"){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_ONE_OF_FILTER_FUNCTION_TYPES,c)}a.addFilterFunction(b,c)}a.setFilterFunction("all");return}else{new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_FILTER_PARAM_VALUE,this._settings.filter)}};Gridifier.ApiSettingsParser.prototype.parseCoordsChangerOptions=function(a){if(!this._settings.hasOwnProperty("coordsChanger")){a.setCoordsChangerFunction("simultaneousCSS3Transition");return}if(typeof this._settings.coordsChanger=="function"){a.addCoordsChangerFunction("clientDefault",this._settings.coordsChanger);a.setCoordsChangerFunction("clientDefault");return}else if(typeof this._settings.coordsChanger=="object"){for(var b in this._settings.coordsChanger){var c=this._settings.coordsChanger[b];if(typeof c!="function"){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_ONE_OF_COORDS_CHANGER_FUNCTION_TYPES,c)}a.addCoordsChangerFunction(b,c)}a.setCoordsChangerFunction("simultaneousCSS3Transition");return}else{new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_COORDS_CHANGER_PARAM_VALUE,this._settings.coordsChanger)}};Gridifier.ApiSettingsParser.prototype.parseSizesChangerOptions=function(a){if(!this._settings.hasOwnProperty("sizesChanger")){a.setSizesChangerFunction("default");return}if(typeof this._settings.sizesChanger=="function"){a.addSizesChangerFunction("clientDefault",this._settings.sizesChanger);a.setSizesChangerFunction("clientDefault");return}else if(typeof this._settings.sizesChanger=="object"){for(var b in this._settings.sizesChanger){var c=this._settings.sizesChanger[b];if(typeof c!="function"){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_ONE_OF_SIZES_CHANGER_FUNCTION_TYPES,c)}a.addSizesChangerFunction(b,c)}a.setSizesChangerFunction("default");return}else{new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_SIZES_CHANGER_PARAM_VALUE,this._settings.sizesChanger)}};Gridifier.CoreSettingsParser=function(a,b){var c=this;this._settingsCore=null;this._settings=null;this._css={};this._construct=function(){c._settingsCore=a;c._settings=b};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.CoreSettingsParser.prototype.parseGridType=function(){if(!this._settings.hasOwnProperty("gridType")){var a=Gridifier.GRID_TYPES.VERTICAL_GRID;return a}if(this._settings.gridType!=Gridifier.GRID_TYPES.VERTICAL_GRID&&this._settings.gridType!=Gridifier.GRID_TYPES.HORIZONTAL_GRID){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_GRID_TYPE,this._settings.gridType)}var a=this._settings.gridType;return a};Gridifier.CoreSettingsParser.prototype.parsePrependType=function(){if(!this._settings.hasOwnProperty("prependType")){var a=Gridifier.PREPEND_TYPES.DEFAULT_PREPEND;return a}if(this._settings.prependType!=Gridifier.PREPEND_TYPES.DEFAULT_PREPEND&&this._settings.prependType!=Gridifier.PREPEND_TYPES.REVERSED_PREPEND&&this._settings.prependType!=Gridifier.PREPEND_TYPES.MIRRORED_PREPEND){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_PREPEND_TYPE,this._settings.prependType)}var a=this._settings.prependType;return a};Gridifier.CoreSettingsParser.prototype.parseAppendType=function(){if(!this._settings.hasOwnProperty("appendType")){var a=Gridifier.APPEND_TYPES.DEFAULT_APPEND;return a}if(this._settings.appendType!=Gridifier.APPEND_TYPES.DEFAULT_APPEND&&this._settings.appendType!=Gridifier.APPEND_TYPES.REVERSED_APPEND){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_APPEND_TYPE,this._settings.appendType)}var a=this._settings.appendType;return a};Gridifier.CoreSettingsParser.prototype.parseIntersectionStrategy=function(){if(!this._settings.hasOwnProperty("intersectionStrategy")){var a=Gridifier.INTERSECTION_STRATEGIES.DEFAULT;return a}if(this._settings.intersectionStrategy!=Gridifier.INTERSECTION_STRATEGIES.DEFAULT&&this._settings.intersectionStrategy!=Gridifier.INTERSECTION_STRATEGIES.NO_INTERSECTIONS){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_INTERSECTION_STRATEGY,this._settings.intersectionStrategy)}var a=this._settings.intersectionStrategy;return a};Gridifier.CoreSettingsParser.prototype.parseIntersectionStrategyAlignmentType=function(){var a=Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES;if(!this._settings.hasOwnProperty("alignmentType")){if(this._settingsCore.isVerticalGrid())var b=a.FOR_VERTICAL_GRID.TOP;else if(this._settingsCore.isHorizontalGrid())var b=a.FOR_HORIZONTAL_GRID.LEFT;return b}if(this._settingsCore.isVerticalGrid()){var c=[a.FOR_VERTICAL_GRID.TOP,a.FOR_VERTICAL_GRID.CENTER,a.FOR_VERTICAL_GRID.BOTTOM]}else if(this._settingsCore.isHorizontalGrid()){var c=[a.FOR_HORIZONTAL_GRID.LEFT,a.FOR_HORIZONTAL_GRID.CENTER,a.FOR_HORIZONTAL_GRID.RIGHT]}var d=false;for(var e=0;e<c.length;e++){if(c[e]==this._settings.alignmentType)d=true}if(d){var b=this._settings.alignmentType;return b}new Gridifier.Error(Gridifier.Error.ERROR_TYPES.INVALID_ALIGNMENT_TYPE,this._settings.alignmentType)};Gridifier.CoreSettingsParser.prototype.parseSortDispersionMode=function(){if(!this._settings.hasOwnProperty("sortDispersionMode")){var a=Gridifier.SORT_DISPERSION_MODES.DISABLED;return a}if(this._settings.sortDispersionMode!=Gridifier.SORT_DISPERSION_MODES.DISABLED&&this._settings.sortDispersionMode!=Gridifier.SORT_DISPERSION_MODES.CUSTOM&&this._settings.sortDispersionMode!=Gridifier.SORT_DISPERSION_MODES.CUSTOM_ALL_EMPTY_SPACE){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_SORT_DISPERSION_MODE,this._settings.sortDispersionMode)}var a=this._settings.sortDispersionMode;return a};Gridifier.CoreSettingsParser.prototype.parseSortDispersionValue=function(){if(!this._settingsCore.isCustomSortDispersion())return"";if(!this._settings.hasOwnProperty("sortDispersionValue")){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.MISSING_SORT_DISPERSION_VALUE)}var a=new RegExp(/[\d]+(px)/);if(!a.test(this._settings.sortDispersionValue)){new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SETTINGS.INVALID_SORT_DISPERSION_VALUE,this._settings.sortDispersionValue)}var b=this._settings.sortDispersionValue;return b};Gridifier.CoreSettingsParser.prototype.parseGridItemMarkingStrategy=function(){if(!this._settings.hasOwnProperty(Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_CLASS)&&!this._settings.hasOwnProperty(Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_DATA_ATTR)){return{gridItemMarkingStrategyType:Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_DATA_ATTR,gridItemMarkingValue:Gridifier.GRID_ITEM_MARKING_DEFAULTS.DATA_ATTR}}if(this._settings.hasOwnProperty(Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_CLASS)){return{gridItemMarkingStrategyType:Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_CLASS,gridItemMarkingValue:this._settings[Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_CLASS]}}else if(this._settings.hasOwnProperty(Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_DATA_ATTR)){return{gridItemMarkingStrategyType:Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_DATA_ATTR,gridItemMarkingValue:this._settings[Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_DATA_ATTR]}}};Gridifier.CoreSettingsParser.prototype.parseDragifierSettings=function(){if(this._settings.hasOwnProperty("dragifier")&&this._settings.dragifier){var a=true;if(typeof this._settings.dragifier=="boolean"){if(this._settingsCore.isByClassGridItemMarkingStrategy()){var b="."+this._settingsCore.getGridItemMarkingValue()}else if(this._settingsCore.isByDataAttrGridItemMarkingStrategy()){var b="["+this._settingsCore.getGridItemMarkingValue()+"]"}}else{var b=this._settings.dragifier}return{shouldEnableDragifierOnInit:a,dragifierItemSelector:b}}var a=false;if(this._settingsCore.isByClassGridItemMarkingStrategy()){var b="."+this._settingsCore.getGridItemMarkingValue()}else if(this._settingsCore.isByDataAttrGridItemMarkingStrategy()){var b="["+this._settingsCore.getGridItemMarkingValue()+"]"}return{shouldEnableDragifierOnInit:a,dragifierItemSelector:b}};Gridifier.Settings=function(a,b,c){var d=this;this._settings=null;this._eventEmitter=null;this._sizesResolverManager=null;this._coreSettingsParser=null;this._apiSettingsParser=null;this._gridType=null;this._animationDuration=900;this._prependType=null;this._appendType=null;this._intersectionStrategy=null;this._alignmentType=null;this._sortDispersionMode=null;this._sortDispersionValue=null;this._toggleApi=null;this._sortApi=null;this._filterApi=null;this._coordsChangerApi=null;this._sizesChangerApi=null;this._gridItemMarkingStrategyType=null;this._gridItemMarkingValue=null;this._shouldEnableDragifierOnInit=false;this._dragifierItemSelector=null;this._css={};this._construct=function(){d._settings=a;d._eventEmitter=b;d._sizesResolverManager=c;d._coreSettingsParser=new Gridifier.CoreSettingsParser(d,d._settings);d._apiSettingsParser=new Gridifier.ApiSettingsParser(d,d._settings);d._toggleApi=new Gridifier.Api.Toggle(d,d._eventEmitter,d._sizesResolverManager);d._sortApi=new Gridifier.Api.Sort(d,d._eventEmitter);d._filterApi=new Gridifier.Api.Filter(d,d._eventEmitter);d._coordsChangerApi=new Gridifier.Api.CoordsChanger(d,d._eventEmitter);d._sizesChangerApi=new Gridifier.Api.SizesChanger(d,d._eventEmitter);d._parse()};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.Settings.prototype._parse=function(){this._gridType=this._coreSettingsParser.parseGridType();this._prependType=this._coreSettingsParser.parsePrependType();this._appendType=this._coreSettingsParser.parseAppendType();this._intersectionStrategy=this._coreSettingsParser.parseIntersectionStrategy();this._alignmentType=this._coreSettingsParser.parseIntersectionStrategyAlignmentType();this._sortDispersionMode=this._coreSettingsParser.parseSortDispersionMode();this._sortDispersionValue=this._coreSettingsParser.parseSortDispersionValue();this._apiSettingsParser.parseToggleOptions(this._toggleApi);this._apiSettingsParser.parseSortOptions(this._sortApi);this._apiSettingsParser.parseFilterOptions(this._filterApi);this._apiSettingsParser.parseCoordsChangerOptions(this._coordsChangerApi);this._apiSettingsParser.parseSizesChangerOptions(this._sizesChangerApi);var a=this._coreSettingsParser.parseGridItemMarkingStrategy();this._gridItemMarkingStrategyType=a.gridItemMarkingStrategyType;this._gridItemMarkingValue=a.gridItemMarkingValue;var b=this._coreSettingsParser.parseDragifierSettings();this._shouldEnableDragifierOnInit=b.shouldEnableDragifierOnInit;this._dragifierItemSelector=b.dragifierItemSelector};Gridifier.Settings.prototype.getAnimationMsDuration=function(){return this._animationDuration};Gridifier.Settings.prototype.isVerticalGrid=function(){return this._gridType==Gridifier.GRID_TYPES.VERTICAL_GRID};Gridifier.Settings.prototype.isHorizontalGrid=function(){return this._gridType==Gridifier.GRID_TYPES.HORIZONTAL_GRID};Gridifier.Settings.prototype.isDefaultPrepend=function(){return this._prependType==Gridifier.PREPEND_TYPES.DEFAULT_PREPEND};Gridifier.Settings.prototype.isReversedPrepend=function(){return this._prependType==Gridifier.PREPEND_TYPES.REVERSED_PREPEND};Gridifier.Settings.prototype.isMirroredPrepend=function(){return this._prependType==Gridifier.PREPEND_TYPES.MIRRORED_PREPEND};Gridifier.Settings.prototype.isDefaultAppend=function(){return this._appendType==Gridifier.APPEND_TYPES.DEFAULT_APPEND};Gridifier.Settings.prototype.isReversedAppend=function(){return this._appendType==Gridifier.APPEND_TYPES.REVERSED_APPEND};Gridifier.Settings.prototype.isDefaultIntersectionStrategy=function(){return this._intersectionStrategy==Gridifier.INTERSECTION_STRATEGIES.DEFAULT};Gridifier.Settings.prototype.isNoIntersectionsStrategy=function(){return this._intersectionStrategy==Gridifier.INTERSECTION_STRATEGIES.NO_INTERSECTIONS};Gridifier.Settings.prototype.isVerticalGridTopAlignmentType=function(){return this._alignmentType==Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES.FOR_VERTICAL_GRID.TOP};Gridifier.Settings.prototype.isVerticalGridCenterAlignmentType=function(){return this._alignmentType==Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES.FOR_VERTICAL_GRID.CENTER};Gridifier.Settings.prototype.isVerticalGridBottomAlignmentType=function(){return this._alignmentType==Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES.FOR_VERTICAL_GRID.BOTTOM};Gridifier.Settings.prototype.isHorizontalGridLeftAlignmentType=function(){return this._alignmentType==Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES.FOR_HORIZONTAL_GRID.LEFT};Gridifier.Settings.prototype.isHorizontalGridCenterAlignmentType=function(){return this._alignmentType==Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES.FOR_HORIZONTAL_GRID.CENTER};Gridifier.Settings.prototype.isHorizontalGridRightAlignmentType=function(){return this._alignmentType==Gridifier.INTERSECTION_STRATEGY_ALIGNMENT_TYPES.FOR_HORIZONTAL_GRID.RIGHT};Gridifier.Settings.prototype.isDisabledSortDispersion=function(){return this._sortDispersionMode==Gridifier.SORT_DISPERSION_MODES.DISABLED};Gridifier.Settings.prototype.isCustomSortDispersion=function(){return this._sortDispersionMode==Gridifier.SORT_DISPERSION_MODES.CUSTOM};Gridifier.Settings.prototype.isCustomAllEmptySpaceSortDispersion=function(){return this._sortDispersionMode==Gridifier.SORT_DISPERSION_MODES.CUSTOM_ALL_EMPTY_SPACE};Gridifier.Settings.prototype.getSortDispersionValue=function(){return this._sortDispersionValue};Gridifier.Settings.prototype.setToggle=function(a){this._toggleApi.setToggleFunction(a)};Gridifier.Settings.prototype.setFilter=function(a){this._filterApi.setFilterFunction(a)};Gridifier.Settings.prototype.setSort=function(a){this._sortApi.setSortFunction(a)};Gridifier.Settings.prototype.getToggle=function(){return this._toggleApi.getToggleFunction()};Gridifier.Settings.prototype.getSort=function(){return this._sortApi.getSortFunction()};Gridifier.Settings.prototype.getFilter=function(){return this._filterApi.getFilterFunction()};Gridifier.Settings.prototype.setCoordsChanger=function(a){this._coordsChangerApi.setCoordsChangerFunction(a)};Gridifier.Settings.prototype.setSizesChanger=function(a){this._sizesChangerApi.setSizesChangerFunction(a)};Gridifier.Settings.prototype.getCoordsChanger=function(){return this._coordsChangerApi.getCoordsChangerFunction()};Gridifier.Settings.prototype.getSizesChanger=function(){return this._sizesChangerApi.getSizesChangerFunction()};Gridifier.Settings.prototype.isByClassGridItemMarkingStrategy=function(){return this._gridItemMarkingStrategyType==Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_CLASS};Gridifier.Settings.prototype.isByDataAttrGridItemMarkingStrategy=function(){return this._gridItemMarkingStrategyType==Gridifier.GRID_ITEM_MARKING_STRATEGIES.BY_DATA_ATTR};Gridifier.Settings.prototype.getGridItemMarkingType=function(){return this._gridItemMarkingValue};Gridifier.Settings.prototype.getGridItemMarkingValue=function(){return this._gridItemMarkingValue};Gridifier.Settings.prototype.shouldEnableDragifierOnInit=function(){return this._shouldEnableDragifierOnInit};Gridifier.Settings.prototype.getDragifierItemSelector=function(){return this._dragifierItemSelector};Gridifier.SizesTransformer.EmptySpaceNormalizer=function(a,b,c){var d=this;this._connections=null;this._connectors=null;this._settings=null;this._css={};this._construct=function(){d._connections=a;d._connectors=b;d._settings=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.SizesTransformer.EmptySpaceNormalizer.prototype.normalizeFreeSpace=function(){if(this._settings.isVerticalGrid())this._applyNoIntersectionsStrategyTopFreeSpaceFixOnPrependedItemTransform();else if(this._settings.isHorizontalGrid())this._applyNoIntersectionsStrategyLeftFreeSpaceFixOnPrependedItemTransform()};Gridifier.SizesTransformer.EmptySpaceNormalizer.prototype._applyNoIntersectionsStrategyTopFreeSpaceFixOnPrependedItemTransform=function(){var a=this._connections.get();for(var b=0;b<a.length;b++){if(a[b].y1==0)return}var c=null;for(var b=0;b<a.length;b++){if(c==null)c=a[b].y1;else{if(a[b].y1<c)c=a[b].y1}}var d=c;for(var b=0;b<a.length;b++){a[b].y1-=d;a[b].y2-=d}};Gridifier.SizesTransformer.EmptySpaceNormalizer.prototype._applyNoIntersectionsStrategyLeftFreeSpaceFixOnPrependedItemTransform=function(){};Gridifier.SizesTransformer.ItemNewPxSizesFinder=function(a,b,c){var d=this;d._gridifier=null;d._connections=null;d._sizesResolverManager=null;this._css={};this._construct=function(){d._gridifier=a;d._connections=b;d._sizesResolverManager=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.SizesTransformer.ItemNewPxSizesFinder.prototype.calculateNewPxSizesPerAllTransformedItems=function(a){for(var b=0;b<a.length;b++){var c=this._calculateNewPxSizesPerConnectionItem(a[b].connectionToTransform.item,a[b].widthToTransform,a[b].heightToTransform);a[b].pxWidthToTransform=c.width;a[b].pxHeightToTransform=c.height}return a};Gridifier.SizesTransformer.ItemNewPxSizesFinder.prototype._calculateNewPxSizesPerConnectionItem=function(a,b,c){var d=a.cloneNode();this._sizesResolverManager.unmarkAsCached(d);Dom.css.set(d,{position:"absolute",top:"0px",left:"-90000px",visibility:"hidden",width:b,height:c});this._gridifier.getGrid().appendChild(d);var e={width:this._sizesResolverManager.outerWidth(d,true),height:this._sizesResolverManager.outerHeight(d,true)};this._gridifier.getGrid().removeChild(d);return e};Gridifier.SizesTransformer.ItemNewRawSizesFinder=function(a){var b=this;this._sizesResolverManager=null;this._css={};this._construct=function(){b._sizesResolverManager=a};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.SizesTransformer.ItemNewRawSizesFinder.TOGGLE_SIZES_TOGGLED_ITEM_SIZES_DATA_ATTR="data-toggle-sizes-item-sizes-are-toggled";Gridifier.SizesTransformer.ItemNewRawSizesFinder.TOGGLE_SIZES_ORIGINAL_WIDTH_DATA_ATTR="data-toggle-sizes-original-width";Gridifier.SizesTransformer.ItemNewRawSizesFinder.TOGGLE_SIZES_ORIGINAL_HEIGHT_DATA_ATTR="data-toggle-sizes-original-height";Gridifier.SizesTransformer.ItemNewRawSizesFinder.EMPTY_DATA_ATTR_VALUE="gridifier-data";Gridifier.SizesTransformer.ItemNewRawSizesFinder.prototype.initConnectionTransform=function(a,b,c){var d={};var e={width:0,height:1};var f=this;var g=function(b,c){var d=new RegExp(/^\*(\d*\.?\d*)$/);var g=new RegExp(/^\/(\d*\.?\d*)$/);var h=new RegExp(/(^\d*\.?\d*)(px|%)$/);var i=new RegExp(/^\d*\.?\d*$/);if(typeof b!="undefined"&&typeof b!="boolean"&&typeof b!=null){if(d.test(b)){var j=f._getItemRawSize(a.item,c,e);var k=h.exec(j);var l=d.exec(b)[1];return k[1]*l+k[2]}if(g.test(b)){var j=f._getItemRawSize(a.item,c,e);var k=h.exec(j);var m=g.exec(b)[1];return k[1]/m+k[2]}if(h.test(b))return b;if(i.test(b))return b+"px";new Gridifier.Error(Gridifier.Error.ERROR_TYPES.SIZES_TRANSFORMER.WRONG_TARGET_TRANSFORMATION_SIZES,b)}return f._getItemRawSize(a.item,c,e)};d.targetWidth=g(b,e.width);d.targetHeight=g(c,e.height);return d};Gridifier.SizesTransformer.ItemNewRawSizesFinder.prototype._getItemRawSize=function(a,b,c){var d=SizesResolver.getComputedCSSWithMaybePercentageSizes(a);if(b==c.width){if(SizesResolver.hasPercentageCSSValue("width",a,d))return SizesResolver.getPercentageCSSValue("width",a,d);else return this._sizesResolverManager.outerWidth(a)+"px"}else if(b==c.height){if(SizesResolver.hasPercentageCSSValue("height",a,d))return SizesResolver.getPercentageCSSValue("height",a,d);else return this._sizesResolverManager.outerHeight(a)+"px"}};Gridifier.SizesTransformer.ItemNewRawSizesFinder.prototype.areConnectionSizesToggled=function(a){var b=Gridifier.SizesTransformer.ItemNewRawSizesFinder;if(Dom.hasAttribute(a.item,b.TOGGLE_SIZES_TOGGLED_ITEM_SIZES_DATA_ATTR))return true;return false};Gridifier.SizesTransformer.ItemNewRawSizesFinder.prototype.getConnectionSizesPerUntoggle=function(a){var b=Gridifier.SizesTransformer.ItemNewRawSizesFinder;var c={};c.targetWidth=a.item.getAttribute(b.TOGGLE_SIZES_ORIGINAL_WIDTH_DATA_ATTR);c.targetHeight=a.item.getAttribute(b.TOGGLE_SIZES_ORIGINAL_HEIGHT_DATA_ATTR);return c};Gridifier.SizesTransformer.ItemNewRawSizesFinder.prototype.markConnectionPerToggle=function(a){var b=Gridifier.SizesTransformer.ItemNewRawSizesFinder;a.item.setAttribute(b.TOGGLE_SIZES_TOGGLED_ITEM_SIZES_DATA_ATTR,b.EMPTY_DATA_ATTR_VALUE);var c={width:0,height:1};var d=this._getItemRawSize(a.item,c.width,c);var e=this._getItemRawSize(a.item,c.height,c);a.item.setAttribute(b.TOGGLE_SIZES_ORIGINAL_WIDTH_DATA_ATTR,d);a.item.setAttribute(b.TOGGLE_SIZES_ORIGINAL_HEIGHT_DATA_ATTR,e)};Gridifier.SizesTransformer.ItemNewRawSizesFinder.prototype.unmarkConnectionPerToggle=function(a){var b=Gridifier.SizesTransformer.ItemNewRawSizesFinder;a.item.removeAttribute(b.TOGGLE_SIZES_TOGGLED_ITEM_SIZES_DATA_ATTR);a.item.removeAttribute(b.TOGGLE_SIZES_ORIGINAL_WIDTH_DATA_ATTR);a.item.removeAttribute(b.TOGGLE_SIZES_ORIGINAL_HEIGHT_DATA_ATTR)};Gridifier.SizesTransformer.ItemsReappender=function(a,b,c,d,e,f,g,h,i,j,k){var l=this;this._gridifier=null;this._appender=null;this._reversedAppender=null;this._connections=null;this._connectors=null;this._connectorsCleaner=null;this._connectorsSelector=null;this._transformerConnectors=null;this._settings=null;this._guid=null;this._transformedItemMarker=null;this._reappendQueue=null;this._batchSize=12;this._reappendNextQueuedItemsBatchTimeout=null;this._reappendedQueueData=null;this._reappendStartViewportWidth=null;this._reappendStartViewportHeight=null;this._css={};this._construct=function(){l._gridifier=a;l._appender=b;l._reversedAppender=c;l._connections=d;l._connectors=e;l._connectorsCleaner=f;l._connectorsSelector=g;l._transformerConnectors=h;l._settings=i;l._guid=j;l._transformedItemMarker=k};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){l._unbindEvents()};this._construct();return this};Gridifier.SizesTransformer.ItemsReappender.prototype.isReversedAppendShouldBeUsedPerItemInsert=function(a){if(this._settings.isDefaultAppend())return false;else if(this._settings.isReversedAppend())return true};Gridifier.SizesTransformer.ItemsReappender.prototype.createReappendQueue=function(a,b){this._reappendQueue=[];this._reappendedQueueData=[];for(var c=0;c<b.length;c++){this._reappendQueue.push({itemToReappend:a[c],connectionToReappend:b[c]})}};Gridifier.SizesTransformer.ItemsReappender.prototype.isReappendQueueEmpty=function(){return this._reappendNextQueuedItemsBatchTimeout==null?true:false};Gridifier.SizesTransformer.ItemsReappender.prototype.stopReappendingQueuedItems=function(){clearTimeout(this._reappendNextQueuedItemsBatchTimeout);this._reappendNextQueuedItemsBatchTimeout=null;return{reappendQueue:this._reappendQueue,reappendedQueueData:this._reappendedQueueData}};Gridifier.SizesTransformer.ItemsReappender.prototype.getQueuedConnectionsPerTransform=function(){var a=[];for(var b=0;b<this._reappendQueue.length;b++){a.push(this._reappendQueue[b].connectionToReappend)}return a};Gridifier.SizesTransformer.ItemsReappender.prototype.startReappendingQueuedItems=function(){this._reappendStartViewportWidth=$(window).width();this._reappendStartViewportHeight=$(window).height();this._reappendNextQueuedItemsBatch()};Gridifier.SizesTransformer.ItemsReappender.prototype._reappendNextQueuedItemsBatch=function(){var a=this._batchSize;if(a>this._reappendQueue.length)a=this._reappendQueue.length;var b=[];if($(window).width()!=this._reappendStartViewportWidth)return;for(var c=0;c<a;c++){var d=this._reappendQueue[c].itemToReappend;if(this.isReversedAppendShouldBeUsedPerItemInsert(d))var e=Gridifier.APPEND_TYPES.REVERSED_APPEND;else var e=Gridifier.APPEND_TYPES.DEFAULT_APPEND;this._reappendItem(e,d);if(this._settings.isVerticalGrid())this._connectorsCleaner.deleteAllIntersectedFromBottomConnectors();else if(this._settings.isHorizontalGrid());b.push(this._guid.getItemGUID(d))}var f=this._connections.getConnectionsByItemGUIDS(b);this._gridifier.getRenderer().renderTransformedConnections(f);this._reappendedQueueData=this._reappendedQueueData.concat(this._reappendQueue.splice(0,a));if(this._reappendQueue.length==0){this._reappendNextQueuedItemsBatchTimeout=null;return}var g=this;this._reappendNextQueuedItemsBatchTimeout=setTimeout(function(){g._reappendNextQueuedItemsBatch.call(g)},25)};Gridifier.SizesTransformer.ItemsReappender.prototype._reappendItem=function(a,b){if(a==Gridifier.APPEND_TYPES.REVERSED_APPEND){this._reversedAppender.reversedAppend(b)}else if(a==Gridifier.APPEND_TYPES.DEFAULT_APPEND){this._appender.append(b)}};Gridifier.SizesTransformer.ItemsToReappendFinder=function(a,b,c){var d=this;d._connections=null;d._connectionsSorter=null;d._settings=null;this._css={};this._construct=function(){d._connections=a;d._connectionsSorter=b;d._settings=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.SizesTransformer.ItemsToReappendFinder.prototype.findAllOnSizesTransform=function(a,b){var c=this._connections.get();for(var d=0;d<c.length;d++){if(c[d][Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT])continue;if(this._settings.isDisabledSortDispersion()&&this._settings.isDefaultIntersectionStrategy()){if(c[d].itemGUID>=b.itemGUID){a.push(c[d]);c.splice(d,1);d--}}else if(this._settings.isCustomSortDispersion()||this._settings.isCustomAllEmptySpaceSortDispersion()||this._settings.isNoIntersectionsStrategy()){if(this._settings.isVerticalGrid()){var e=c[d].y2>=b.y1}else if(this._settings.isHorizontalGrid()){var e=c[d].x2>=b.x1}if(e){a.push(c[d]);c.splice(d,1);d--}}}var f=this._connectionsSorter.sortConnectionsPerReappend(a);var g=[];for(var d=0;d<f.length;d++){g.push(f[d].item)}return{itemsToReappend:g,connectionsToReappend:a,firstConnectionToReappend:f[0]}};Gridifier.SizesTransformer.Core=function(a,b,c,d,e,f,g,h,i,j,k){var l=this;this._gridifier=null;this._settings=null;this._connectors=null;this._connections=null;this._connectionsSorter=null;this._guid=null;this._appender=null;this._reversedAppender=null;this._normalizer=null;this._operation=null;this._sizesResolverManager=null;this._connectorsCleaner=null;this._connectorsSelector=null;this._transformerConnectors=null;this._transformedConnectionsSorter=null;this._itemNewPxSizesFinder=null;this._transformedItemMarker=null;this._itemsToReappendFinder=null;this._itemsReappender=null;this._emptySpaceNormalizer=null;this._css={};this._construct=function(){l._gridifier=a;l._settings=b;l._connectors=c;l._connections=d;l._connectionsSorter=e;l._guid=f;l._appender=g;l._reversedAppender=h;l._normalizer=i;l._operation=j;l._sizesResolverManager=k;if(l._settings.isVerticalGrid()){l._connectorsCleaner=new Gridifier.VerticalGrid.ConnectorsCleaner(l._connectors,l._connections,l._settings)}else if(l._settings.isHorizontalGrid()){l._connectorsCleaner=new Gridifier.HorizontalGrid.ConnectorsCleaner(l._connectors,l._connections,l._settings)}l._connectorsSelector=new Gridifier.VerticalGrid.ConnectorsSelector(l._guid);l._transformedConnectionsSorter=new Gridifier.SizesTransformer.TransformedConnectionsSorter(l._connectionsSorter);l._itemNewPxSizesFinder=new Gridifier.SizesTransformer.ItemNewPxSizesFinder(l._gridifier,l._connections,l._sizesResolverManager);l._transformedItemMarker=new Gridifier.SizesTransformer.TransformedItemMarker;l._itemsToReappendFinder=new Gridifier.SizesTransformer.ItemsToReappendFinder(l._connections,l._connectionsSorter,l._settings);l._transformerConnectors=new Gridifier.TransformerConnectors(l._gridifier,l._settings,l._connectors,l._connections,l._guid,l._appender,l._reversedAppender,l._normalizer,l,l._connectorsCleaner,l._transformedItemMarker,l._operation);l._itemsReappender=new Gridifier.SizesTransformer.ItemsReappender(l._gridifier,l._appender,l._reversedAppender,l._connections,l._connectors,l._connectorsCleaner,l._connectorsSelector,l._transformerConnectors,l._settings,l._guid,l._transformedItemMarker);l._transformerConnectors.setItemsReappenderInstance(l._itemsReappender);l._emptySpaceNormalizer=new Gridifier.SizesTransformer.EmptySpaceNormalizer(l._connections,l._connectors,l._settings)
};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){l._unbindEvents()};this._construct();return this};Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT="restrictConnectionCollect";Gridifier.SizesTransformer.Core.prototype.isTransformerQueueEmpty=function(){return this._itemsReappender.isReappendQueueEmpty()};Gridifier.SizesTransformer.Core.prototype.getQueuedConnectionsPerTransform=function(){return this._itemsReappender.getQueuedConnectionsPerTransform()};Gridifier.SizesTransformer.Core.prototype.transformConnectionSizes=function(a){a=this._transformedConnectionsSorter.sortTransformedConnections(a);a=this._itemNewPxSizesFinder.calculateNewPxSizesPerAllTransformedItems(a);var b=function(){this._transformedItemMarker.markEachConnectionItemWithTransformData(a);var b=[];if(!this._itemsReappender.isReappendQueueEmpty()){var c=this._itemsReappender.stopReappendingQueuedItems();for(var d=0;d<c.reappendQueue.length;d++){var e=c.reappendQueue[d].connectionToReappend;if(e[Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT])continue;b.push(e)}}var f=this._itemsToReappendFinder.findAllOnSizesTransform(b,a[0].connectionToTransform);var g=f.itemsToReappend;var b=f.connectionsToReappend;var h=f.firstConnectionToReappend;this._transformedItemMarker.markAllTransformDependedItems(g);this._transformerConnectors.recreateConnectorsPerFirstItemReappendOnTransform(g[0],h);this._itemsReappender.createReappendQueue(g,b);this._itemsReappender.startReappendingQueuedItems()};var c=this;setTimeout(function(){b.call(c)},0)};Gridifier.SizesTransformer.Core.prototype.stopRetransformAllConnectionsQueue=function(){var a=this._connections.get();if(!this._itemsReappender.isReappendQueueEmpty()){var b=this._itemsReappender.stopReappendingQueuedItems();var c=[];for(var d=0;d<b.reappendedQueueData.length;d++)c.push(b.reappendedQueueData[d].connectionToReappend);this._connections.syncConnectionParams(c);for(var d=0;d<b.reappendQueue.length;d++)a.push(b.reappendQueue[d].connectionToReappend)}};Gridifier.SizesTransformer.Core.prototype.retransformAllConnections=function(){this.stopRetransformAllConnectionsQueue();var a=this._connections.get();if(a.length==0)return;var b=function(){a=this._connectionsSorter.sortConnectionsPerReappend(a);var b=[];var c=[];var d=[];for(var e=0;e<a.length;e++){if(!a[e][Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT]){b.push(a[e].item);d.push(a[e])}else{c.push(a[e])}}var f=null;if(c.length==0){f=a[0];a.splice(0,a.length)}else{for(var e=0;e<a.length;e++){var g=true;for(var h=0;h<c.length;h++){if(c[h].itemGUID==a[e].itemGUID){g=false;break}}if(g){f=a[e];break}}a.splice(0,a.length);for(var e=0;e<c.length;e++)a.push(c[e])}this._transformedItemMarker.markAllTransformDependedItems(b);this._transformerConnectors.recreateConnectorsPerFirstItemReappendOnTransform(f.item,f);this._itemsReappender.createReappendQueue(b,d);this._itemsReappender.startReappendingQueuedItems()};var c=this._syncAllScheduledToTransformItemSizes(a);if(!c){b.call(this)}else{var d=this;setTimeout(function(){b.call(d)},0)}};Gridifier.SizesTransformer.Core.prototype._syncAllScheduledToTransformItemSizes=function(a){var b=[];for(var c=0;c<a.length;c++){if(this._transformedItemMarker.isTransformedItem(a[c].item)){var d=this._transformedItemMarker.getTransformedItemTargetRawSizes(a[c].item);b.push({connectionToTransform:a[c],widthToTransform:d.targetRawWidth,heightToTransform:d.targetRawHeight})}}if(b.length==0)return false;b=this._itemNewPxSizesFinder.calculateNewPxSizesPerAllTransformedItems(b);this._transformedItemMarker.markEachConnectionItemWithTransformData(b);return true};Gridifier.SizesTransformer.Core.prototype.retransformFrom=function(a){var b=[];if(!this._itemsReappender.isReappendQueueEmpty()){var c=this._itemsReappender.stopReappendingQueuedItems();for(var d=0;d<c.reappendQueue.length;d++){var e=c.reappendQueue[d].connectionToReappend;if(e[Gridifier.SizesTransformer.RESTRICT_CONNECTION_COLLECT])continue;b.push(e)}}var f=this._itemsToReappendFinder.findAllOnSizesTransform(b,a);var g=f.itemsToReappend;var b=f.connectionsToReappend;var h=f.firstConnectionToReappend;this._transformedItemMarker.markAllTransformDependedItems(g);this._transformerConnectors.recreateConnectorsPerFirstItemReappendOnTransform(g[0],h);this._itemsReappender.createReappendQueue(g,b);this._itemsReappender.startReappendingQueuedItems()};Gridifier.SizesTransformer.TransformedConnectionsSorter=function(a){var b=this;b._connectionsSorter=null;this._css={};this._construct=function(){b._connectionsSorter=a};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.SizesTransformer.TransformedConnectionsSorter.prototype.sortTransformedConnections=function(a){var b=this;var c=[];for(var d=0;d<a.length;d++)c.push(a[d].connectionToTransform);var e=1;var f=this._connectionsSorter.sortConnectionsPerReappend(c);for(var d=0;d<f.length;d++){for(var g=0;g<a.length;g++){if(f[d].itemGUID==a[g].connectionToTransform.itemGUID){a[g].sortNumber=e;e++;break}}}a.sort(function(a,b){if(a.sortNumber>b.sortNumber)return 1;return-1});return a};Gridifier.SizesTransformer.TransformedItemMarker=function(){var a=this;this._css={};this._construct=function(){};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){a._unbindEvents()};this._construct();return this};Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_DATA_ATTR="data-transformed-item";Gridifier.SizesTransformer.TransformedItemMarker.DEPENDED_ITEM_DATA_ATTR="data-depended-item";Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMER_EMPTY_DATA_ATTR_VALUE="gridifier-data";Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_RAW_TARGET_WIDTH_DATA_ATTR="data-transformed-item-raw-target-width";Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_RAW_TARGET_HEIGHT_DATA_ATTR="data-transformed-item-raw-target-height";Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_PX_TARGET_WIDTH_DATA_ATTR="data-transformed-item-px-target-width";Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_PX_TARGET_HEIGHT_DATA_ATTR="data-transformed-item-px-target-height";Gridifier.SizesTransformer.TransformedItemMarker.prototype.markEachConnectionItemWithTransformData=function(a){var b=Gridifier.SizesTransformer.TransformedItemMarker;for(var c=0;c<a.length;c++){var d=a[c].connectionToTransform.item;d.setAttribute(b.TRANSFORMED_ITEM_DATA_ATTR,b.TRANSFORMER_EMPTY_DATA_ATTR_VALUE);d.setAttribute(b.TRANSFORMED_ITEM_RAW_TARGET_WIDTH_DATA_ATTR,a[c].widthToTransform);d.setAttribute(b.TRANSFORMED_ITEM_RAW_TARGET_HEIGHT_DATA_ATTR,a[c].heightToTransform);d.setAttribute(b.TRANSFORMED_ITEM_PX_TARGET_WIDTH_DATA_ATTR,a[c].pxWidthToTransform);d.setAttribute(b.TRANSFORMED_ITEM_PX_TARGET_HEIGHT_DATA_ATTR,a[c].pxHeightToTransform)}};Gridifier.SizesTransformer.TransformedItemMarker.prototype.isTransformedItem=function(a){return Dom.hasAttribute(a,Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_DATA_ATTR)};Gridifier.SizesTransformer.TransformedItemMarker.prototype.unmarkItemAsTransformed=function(a){a.removeAttribute(Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_DATA_ATTR);a.removeAttribute(Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_RAW_TARGET_WIDTH_DATA_ATTR);a.removeAttribute(Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_RAW_TARGET_HEIGHT_DATA_ATTR);a.removeAttribute(Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_PX_TARGET_WIDTH_DATA_ATTR);a.removeAttribute(Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMED_ITEM_PX_TARGET_HEIGHT_DATA_ATTR)};Gridifier.SizesTransformer.TransformedItemMarker.prototype.getTransformedItemTargetRawSizes=function(a){var b=Gridifier.SizesTransformer.TransformedItemMarker;return{targetRawWidth:a.getAttribute(b.TRANSFORMED_ITEM_RAW_TARGET_WIDTH_DATA_ATTR),targetRawHeight:a.getAttribute(b.TRANSFORMED_ITEM_RAW_TARGET_HEIGHT_DATA_ATTR)}};Gridifier.SizesTransformer.TransformedItemMarker.prototype.getTransformedItemTargetPxSizes=function(a){var b=Gridifier.SizesTransformer.TransformedItemMarker;return{targetPxWidth:parseFloat(a.getAttribute(b.TRANSFORMED_ITEM_PX_TARGET_WIDTH_DATA_ATTR)),targetPxHeight:parseFloat(a.getAttribute(b.TRANSFORMED_ITEM_PX_TARGET_HEIGHT_DATA_ATTR))}};Gridifier.SizesTransformer.TransformedItemMarker.prototype.markAllTransformDependedItems=function(a){for(var b=0;b<a.length;b++){if(this.isTransformedItem(a[b]))continue;a[b].setAttribute(Gridifier.SizesTransformer.TransformedItemMarker.DEPENDED_ITEM_DATA_ATTR,Gridifier.SizesTransformer.TransformedItemMarker.TRANSFORMER_EMPTY_DATA_ATTR_VALUE)}};Gridifier.SizesTransformer.TransformedItemMarker.prototype.isDependedItem=function(a){return Dom.hasAttribute(a,Gridifier.SizesTransformer.TransformedItemMarker.DEPENDED_ITEM_DATA_ATTR)};Gridifier.SizesTransformer.TransformedItemMarker.prototype.unmarkItemAsDepended=function(a){a.removeAttribute(Gridifier.SizesTransformer.TransformedItemMarker.DEPENDED_ITEM_DATA_ATTR)};Gridifier.TransformerOperations.OptionsParser=function(a,b){var c=this;this._collector=null;this._sizesResolverManager=null;this._css={};this._construct=function(){c._collector=a;c._sizesResolverManager=b};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.TransformerOperations.OptionsParser.prototype.parseItemsToTransform=function(a){var b=[];if(Dom.isArray(a)){for(var c=0;c<a.length;c++){b.push(a[c][0])}}else{b.push(a)}b=this._collector.toDOMCollection(b);this._sizesResolverManager.startCachingTransaction();this._collector.ensureAllItemsAreAttachedToGrid(b);this._collector.ensureAllItemsCanBeAttachedToGrid(b);return b};Gridifier.TransformerOperations.OptionsParser.prototype.parseSizesToTransform=function(a,b,c){var d=[];if(Dom.isArray(a)){for(var e=0;e<a.length;e++){d.push([a[e][1],a[e][2]])}}else{d.push([b,c])}return d};Gridifier.TransformerOperations.Toggle=function(a,b,c,d,e){var f=this;this._collector=null;this._connections=null;this._guid=null;this._sizesTransformer=null;this._sizesResolverManager=null;this._optionsParser=null;this._css={};this._construct=function(){f._collector=a;f._connections=b;f._guid=c;f._sizesTransformer=d;f._sizesResolverManager=e;f._optionsParser=new Gridifier.TransformerOperations.OptionsParser(f._collector,f._sizesResolverManager)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){f._unbindEvents()};this._construct();return this};Gridifier.TransformerOperations.Toggle.prototype.execute=function(a,b,c){var d=this._optionsParser.parseItemsToTransform(a);var e=this._optionsParser.parseSizesToTransform(a,b,c);var f=this._parseTransformationData(d,e);this._sizesTransformer.transformConnectionSizes(f);this._sizesResolverManager.stopCachingTransaction()};Gridifier.TransformerOperations.Toggle.prototype._parseTransformationData=function(a,b){var c=new Gridifier.SizesTransformer.ItemNewRawSizesFinder(this._sizesResolverManager);var d=[];for(var e=0;e<a.length;e++){var f=this._connections.findConnectionByItem(a[e]);var g=null;if(c.areConnectionSizesToggled(f)){g=c.getConnectionSizesPerUntoggle(f);c.unmarkConnectionPerToggle(f)}else{c.markConnectionPerToggle(f);g=c.initConnectionTransform(f,b[e][0],b[e][1])}d.push({connectionToTransform:f,widthToTransform:g.targetWidth,heightToTransform:g.targetHeight})}return d};Gridifier.TransformerOperations.Transform=function(a,b,c,d,e){var f=this;this._collector=null;this._connections=null;this._guid=null;this._sizesTransformer=null;this._sizesResolverManager=null;this._optionsParser=null;this._css={};this._construct=function(){f._collector=a;f._connections=b;f._guid=c;f._sizesTransformer=d;f._sizesResolverManager=e;f._optionsParser=new Gridifier.TransformerOperations.OptionsParser(f._collector,f._sizesResolverManager)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){f._unbindEvents()};this._construct();return this};Gridifier.TransformerOperations.Transform.prototype.execute=function(a,b,c){var d=this._optionsParser.parseItemsToTransform(a);var e=this._optionsParser.parseSizesToTransform(a,b,c);var f=this._parseTransformationData(d,e);this._sizesTransformer.transformConnectionSizes(f);this._sizesResolverManager.stopCachingTransaction()};Gridifier.TransformerOperations.Transform.prototype._parseTransformationData=function(a,b){var c=new Gridifier.SizesTransformer.ItemNewRawSizesFinder(this._sizesResolverManager);var d=[];for(var e=0;e<a.length;e++){var f=this._connections.findConnectionByItem(a[e]);var g=null;g=c.initConnectionTransform(f,b[e][0],b[e][1]);d.push({connectionToTransform:f,widthToTransform:g.targetWidth,heightToTransform:g.targetHeight})}return d};Gridifier.TransformerOperations.Transform.prototype.executeRetransformAllSizes=function(){this._sizesTransformer.retransformAllConnections()};Gridifier.VerticalGrid.Appender=function(a,b,c,d,e,f,g,h,i){var j=this;this._gridifier=null;this._settings=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectorsCleaner=null;this._connectorsShifter=null;this._connectorsSelector=null;this._connectorsSorter=null;this._itemCoordsExtractor=null;this._connectionsIntersector=null;this._guid=null;this._renderer=null;this._normalizer=null;this._operation=null;this._css={};this._construct=function(){j._gridifier=a;j._settings=b;j._sizesResolverManager=c;j._connectors=d;j._connections=e;j._connectorsCleaner=new Gridifier.VerticalGrid.ConnectorsCleaner(j._connectors,j._connections,j._settings);j._connectorsShifter=new Gridifier.ConnectorsShifter(j._gridifier,j._connections,j._settings);j._connectorsSelector=new Gridifier.VerticalGrid.ConnectorsSelector(j._guid);j._connectorsSorter=new Gridifier.VerticalGrid.ConnectorsSorter;j._itemCoordsExtractor=new Gridifier.VerticalGrid.ItemCoordsExtractor(j._gridifier,j._sizesResolverManager);j._connectionsIntersector=new Gridifier.VerticalGrid.ConnectionsIntersector(j._connections);j._guid=f;j._renderer=g;j._normalizer=h;j._operation=i};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){j._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.Appender.prototype.append=function(a){this._initConnectors();var b=this._createConnectionPerItem(a);this._connections.attachConnectionToRanges(b);this._connectorsCleaner.deleteAllTooHighConnectorsFromMostBottomConnector();this._connectorsCleaner.deleteAllIntersectedFromBottomConnectors();if(this._settings.isDefaultIntersectionStrategy())this._renderer.showConnections(b);else if(this._settings.isNoIntersectionsStrategy()){var c=this._connections.getLastRowVerticallyExpandedConnections();for(var d=0;d<c.length;d++){if(c[d].itemGUID==b.itemGUID){c.splice(d,1);d--}}this._renderer.renderConnections(c);this._renderer.showConnections(b)}};Gridifier.VerticalGrid.Appender.prototype._initConnectors=function(){if(this._operation.isInitialOperation(Gridifier.OPERATIONS.APPEND)){this.createInitialConnector();return}if(!this._operation.isCurrentOperationSameAsPrevious(Gridifier.OPERATIONS.APPEND)){this.recreateConnectorsPerAllConnectedItems();this._connectorsCleaner.deleteAllIntersectedFromBottomConnectors();this._connectorsCleaner.deleteAllTooHighConnectorsFromMostBottomConnector()}};Gridifier.VerticalGrid.Appender.prototype.createInitialConnector=function(){this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.LEFT.TOP,parseFloat(this._gridifier.getGridX2()),0)};Gridifier.VerticalGrid.Appender.prototype.recreateConnectorsPerAllConnectedItems=function(){this._connectors.flush();var a=this._connections.get();for(var b=0;b<a.length;b++){this._addItemConnectors(a[b],a[b].itemGUID)}if(this._connectors.count()==0)this.createInitialConnector()};Gridifier.VerticalGrid.Appender.prototype._addItemConnectors=function(a,b){if(a.x1-1>=0){this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.LEFT.TOP,parseFloat(a.x1-1),parseFloat(a.y1),Dom.toInt(b))}this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.BOTTOM.RIGHT,parseFloat(a.x2),parseFloat(a.y2+1),Dom.toInt(b))};Gridifier.VerticalGrid.Appender.prototype._createConnectionPerItem=function(a){var b=this._filterConnectorsPerNextConnection();var c=this._findItemConnectionCoords(a,b);var d=this._connections.add(a,c);if(this._settings.isNoIntersectionsStrategy()){this._connections.expandVerticallyAllRowConnectionsToMostTall(d)}this._addItemConnectors(c,this._guid.getItemGUID(a));return d};Gridifier.VerticalGrid.Appender.prototype._filterConnectorsPerNextConnection=function(){var a=this._connectors.getClone();if(this._settings.isDefaultIntersectionStrategy()){this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllConnectors();a=this._connectorsShifter.getAllConnectors()}else if(this._settings.isNoIntersectionsStrategy()){var b=Gridifier.Connectors.SIDES.BOTTOM.RIGHT;this._connectorsSelector.attachConnectors(a);this._connectorsSelector.selectOnlyMostBottomConnectorFromSide(b);a=this._connectorsSelector.getSelectedConnectors();this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllWithSpecifiedSideToRightGridCorner(b);a=this._connectorsShifter.getAllConnectors()}this._connectorsSorter.attachConnectors(a);this._connectorsSorter.sortConnectorsForAppend(Gridifier.APPEND_TYPES.DEFAULT_APPEND);return this._connectorsSorter.getConnectors()};Gridifier.VerticalGrid.Appender.prototype._findItemConnectionCoords=function(a,b){var c=null;for(var d=0;d<b.length;d++){var e=this._itemCoordsExtractor.connectorToAppendedItemCoords(a,b[d]);if(e.x1<this._normalizer.normalizeLowRounding(0)){continue}var f=this._connectionsIntersector.findAllMaybeIntersectableConnectionsOnAppend(b[d]);if(this._connectionsIntersector.isIntersectingAnyConnection(f,e)){continue}c=e;var g=this._connections.getAllConnectionsBelowY(e.y2);if(this._connections.isAnyConnectionItemGUIDSmallerThan(g,a)){continue}if(this._settings.isNoIntersectionsStrategy()){if(this._connections.isIntersectingMoreThanOneConnectionItemVertically(c)){c=null}}if(c!=null){break}}return c};Gridifier.VerticalGrid.Connections=function(a,b,c,d){var e=this;this._gridifier=null;this._guid=null;this._settings=null;this._sizesResolverManager=null;this._itemCoordsExtractor=null;this._sizesTransformer=null;this._connectionsCore=null;this._connectionsVerticalIntersector=null;this._connections=[];this._ranges=null;this._sorter=null;this._css={};this._construct=function(){e._gridifier=a;e._guid=b;e._settings=c;e._sizesResolverManager=d;e._ranges=new Gridifier.VerticalGrid.ConnectionsRanges(e);e._ranges.init();e._sorter=new Gridifier.VerticalGrid.ConnectionsSorter(e,e._settings,e._guid);e._itemCoordsExtractor=new Gridifier.VerticalGrid.ItemCoordsExtractor(e._gridifier,e._sizesResolverManager);e._connectionsCore=new Gridifier.Connections(e._gridifier,e,e._guid,e._sorter,e._sizesResolverManager);e._connectionsVerticalIntersector=new Gridifier.VerticalGrid.ConnectionsVerticalIntersector(e,e._settings,e._itemCoordsExtractor)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){e._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.Connections.prototype.setSizesTransformerInstance=function(a){this._sizesTransformer=a;this._connectionsCore.setSizesTransformerInstance(a)};Gridifier.VerticalGrid.Connections.prototype.attachConnectionToRanges=function(a){this._ranges.attachConnection(a,this._connections.length-1)};Gridifier.VerticalGrid.Connections.prototype.reinitRanges=function(){this._ranges.init()};Gridifier.VerticalGrid.Connections.prototype.getAllHorizontallyIntersectedAndUpperConnections=function(a){return this._ranges.getAllConnectionsFromIntersectedAndUpperRanges(a.y)};Gridifier.VerticalGrid.Connections.prototype.getAllHorizontallyIntersectedConnections=function(a){return this._ranges.getAllConnectionsFromIntersectedRange(a.y)};Gridifier.VerticalGrid.Connections.prototype.getAllHorizontallyIntersectedAndLowerConnections=function(a){return this._ranges.getAllConnectionsFromIntersectedAndLowerRanges(a.y)};Gridifier.VerticalGrid.Connections.prototype.mapAllIntersectedAndLowerConnectionsPerEachConnector=function(a){return this._ranges.mapAllIntersectedAndLowerConnectionsPerEachConnector(a)};Gridifier.VerticalGrid.Connections.prototype.mapAllIntersectedAndUpperConnectionsPerEachConnector=function(a){return this._ranges.mapAllIntersectedAndUpperConnectionsPerEachConnector(a)};Gridifier.VerticalGrid.Connections.prototype.getLastRowVerticallyExpandedConnections=function(){return this._connectionsVerticalIntersector.getLastRowVerticallyExpandedConnections()};Gridifier.VerticalGrid.Connections.prototype.get=function(){return this._connections};Gridifier.VerticalGrid.Connections.prototype.count=function(){return this._connections.length};Gridifier.VerticalGrid.Connections.prototype.restore=function(a){this._connections=this._connections.concat(a)};Gridifier.VerticalGrid.Connections.prototype.restoreOnCustomSortDispersionMode=function(a){var b=this._sorter.sortConnectionsPerReappend(this._connections);var c=b[b.length-1];if(this._settings.isDefaultAppend()){var d=c.x1;var e=c.y1;var f=d-1;for(var g=0;g<a.length;g++){a[g].x1=f;a[g].x2=f;a[g].y1=e;a[g].y2=e;f--}}else if(this._settings.isReversedAppend()){var h=c.x2;var e=c.y1;var f=h+1;for(var g=0;g<a.length;g++){a[g].x1=f;a[g].x2=f;a[g].y1=e;a[g].y2=e;f++}}this.restore(a)};Gridifier.VerticalGrid.Connections.prototype.findConnectionByItem=function(a){return this._connectionsCore.findConnectionByItem(a)};Gridifier.VerticalGrid.Connections.prototype.remapAllItemGUIDS=function(){this._connectionsCore.remapAllItemGUIDS()};Gridifier.VerticalGrid.Connections.prototype.remapAllItemGUIDSInSortedConnections=function(a){this._connectionsCore.remapAllItemGUIDSInSortedConnections(a)};Gridifier.VerticalGrid.Connections.prototype.add=function(a,b){var c=this._connectionsCore.createItemConnection(a,b);this._connections.push(c);return c};Gridifier.VerticalGrid.Connections.prototype.removeConnection=function(a){for(var b=0;b<this._connections.length;b++){if(this._guid.getItemGUID(a.item)==this._guid.getItemGUID(this._connections[b].item)){this._connections.splice(b,1);return}}};Gridifier.VerticalGrid.Connections.prototype.getConnectionsByItemGUIDS=function(a){return this._connectionsCore.getConnectionsByItemGUIDS(a)};Gridifier.VerticalGrid.Connections.prototype.syncConnectionParams=function(a){this._connectionsCore.syncConnectionParams(a)};Gridifier.VerticalGrid.Connections.prototype.getMinConnectionWidth=function(){return this._connectionsCore.getMinConnectionWidth()};Gridifier.VerticalGrid.Connections.prototype.getMinConnectionHeight=function(){return this._connectionsCore.getMinConnectionHeight()};Gridifier.VerticalGrid.Connections.prototype.isAnyConnectionItemGUIDSmallerThan=function(a,b){return this._connectionsCore.isAnyConnectionItemGUIDSmallerThan(a,b)};Gridifier.VerticalGrid.Connections.prototype.isAnyConnectionItemGUIDBiggerThan=function(a,b){return this._connectionsCore.isAnyConnectionItemGUIDBiggerThan(a,b)};Gridifier.VerticalGrid.Connections.prototype.getAllConnectionsBelowY=function(a){var b=[];for(var c=0;c<this._connections.length;c++){if(this._connections[c].y1-1e4>a)b.push(this._connections[c])}return b};Gridifier.VerticalGrid.Connections.prototype.getAllConnectionsAboveY=function(a){var b=[];for(var c=0;c<this._connections.length;c++){if(this._connections[c].y2<a)b.push(this._connections[c])}return b};Gridifier.VerticalGrid.Connections.prototype.getMaxYFromAllConnections=function(){var a=0;for(var b=0;b<this._connections.length;b++){if(this._connections[b].y2>a)a=this._connections[b].y2}return a};Gridifier.VerticalGrid.Connections.prototype.isIntersectingMoreThanOneConnectionItemVertically=function(a){return this._connectionsVerticalIntersector.isIntersectingMoreThanOneConnectionItemVertically(a)};Gridifier.VerticalGrid.Connections.prototype.getMostTallFromAllVerticallyIntersectedConnections=function(a){return this._connectionsVerticalIntersector.getMostTallFromAllVerticallyIntersectedConnections(a)};Gridifier.VerticalGrid.Connections.prototype.getAllVerticallyIntersectedConnections=function(a){return this._connectionsVerticalIntersector.getAllVerticallyIntersectedConnections(a)};Gridifier.VerticalGrid.Connections.prototype.expandVerticallyAllRowConnectionsToMostTall=function(a){this._connectionsVerticalIntersector.expandVerticallyAllRowConnectionsToMostTall(a)};Gridifier.VerticalGrid.Connections.prototype.normalizeVerticalPositionsOfAllConnectionsAfterPrepend=function(a,b){if(a.y1>=0)return false;var c=Math.round(Math.abs(a.y1));a.y2=Math.abs(a.y1-a.y2);a.y1=0;for(var d=0;d<this._connections.length;d++){if(a.itemGUID==this._connections[d].itemGUID)continue;this._connections[d].y1+=c;this._connections[d].y2+=c}for(var d=0;d<b.length;d++)b[d].y+=c;this._ranges.shiftAllRangesBy(c);this._ranges.createPrependedRange(a.y1,a.y2);return true};Gridifier.VerticalGrid.ConnectionsIntersector=function(a){var b=this;this._connections=null;this._intersectorCore=null;this._css={};this._construct=function(){b._connections=a;b._intersectorCore=new Gridifier.ConnectionsIntersector(b._connections)};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ConnectionsIntersector.prototype.isIntersectingAnyConnection=function(a,b){return this._intersectorCore.isIntersectingAnyConnection(a,b)};Gridifier.VerticalGrid.ConnectionsIntersector.prototype.getAllConnectionsWithIntersectedCenter=function(a){return this._intersectorCore.getAllConnectionsWithIntersectedCenter(a)};Gridifier.VerticalGrid.ConnectionsIntersector.prototype.findAllMaybeIntersectableConnectionsOnAppend=function(a){var b=this._connections.get();var c=[];for(var d=0;d<b.length;d++){if(a.y>b[d].y2)continue;c.push(b[d])}return c};Gridifier.VerticalGrid.ConnectionsIntersector.prototype.findAllMaybeIntersectableConnectionsOnPrepend=function(a){var b=this._connections.get();var c=[];for(var d=0;d<b.length;d++){if(a.y<b[d].y1)continue;c.push(b[d])}return c};Gridifier.VerticalGrid.ConnectionsRanges=function(a){var b=this;this._connections=null;this._ranges=null;this._css={};this._construct=function(){b._connections=a};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ConnectionsRanges.RANGE_PX_HEIGHT=500;Gridifier.VerticalGrid.ConnectionsRanges.prototype.init=function(){this._ranges=[];this._ranges.push({y1:-1,y2:Gridifier.VerticalGrid.ConnectionsRanges.RANGE_PX_HEIGHT,connectionIndexes:[]});this._attachAllConnections()};Gridifier.VerticalGrid.ConnectionsRanges.prototype.shiftAllRangesBy=function(a){for(var b=0;b<this._ranges.length;b++){this._ranges[b].y1+=a;this._ranges[b].y2+=a}};Gridifier.VerticalGrid.ConnectionsRanges.prototype.createPrependedRange=function(a,b){this._ranges.unshift({y1:-1,y2:b,connectionIndexes:[]})};Gridifier.VerticalGrid.ConnectionsRanges.prototype._createNextRange=function(){var a=this._ranges[this._ranges.length-1].y2+1;this._ranges.push({y1:a,y2:a+Gridifier.VerticalGrid.ConnectionsRanges.RANGE_PX_HEIGHT,connectionIndexes:[]})};Gridifier.VerticalGrid.ConnectionsRanges.prototype.attachConnection=function(a,b){while(a.y2+1>this._ranges[this._ranges.length-1].y2){this._createNextRange()}var c=false;for(var d=0;d<this._ranges.length;d++){var e=a.y2<this._ranges[d].y1;var f=a.y1>this._ranges[d].y2;if(!e&&!f){this._ranges[d].connectionIndexes.push(b);c=true}}if(!c)throw new Error("Gridifier core error: connection was not connected to any range: "+a.itemGUID)};Gridifier.VerticalGrid.ConnectionsRanges.prototype._attachAllConnections=function(){var a=this._connections.get();for(var b=0;b<a.length;b++)this.attachConnection(a[b],b)};Gridifier.VerticalGrid.ConnectionsRanges.prototype.mapAllIntersectedAndUpperConnectionsPerEachConnector=function(a){var b=this._ranges.length-1;var c=[];for(var d=0;d<a.length;d++){var e=false;if(b==this._ranges.length-1)var f=false;else var f=true;while(!e){if(b>this._ranges.length-1||b<0){b=this._ranges.length-1;break}if(a[d].y>=this._ranges[b].y1&&a[d].y<=this._ranges[b].y2){e=true}else{b--;f=false}}if(!f){c=[];for(var g=b;g>=0;g--)c.push(this._ranges[g].connectionIndexes)}a[d].connectionIndexes=c}return a};Gridifier.VerticalGrid.ConnectionsRanges.prototype.getAllConnectionsFromIntersectedAndLowerRanges=function(a){var b=[];var c=null;for(var d=0;d<this._ranges.length;d++){if(a>=this._ranges[d].y1&&a<=this._ranges[d].y2){c=d;break}}if(c==null)c=0;for(var d=c;d<this._ranges.length;d++){b.push(this._ranges[d].connectionIndexes)}return b};Gridifier.VerticalGrid.ConnectionsRanges.prototype.mapAllIntersectedAndLowerConnectionsPerEachConnector=function(a){var b=0;var c=[];for(var d=0;d<a.length;d++){var e=false;if(b==0)var f=false;else var f=true;while(!e){if(b>this._ranges.length-1||b<0){b=0;break}if(a[d].y>=this._ranges[b].y1&&a[d].y<=this._ranges[b].y2){e=true}else{b++;f=false}}if(!f){c=[];for(var g=b;g<this._ranges.length;g++)c.push(this._ranges[g].connectionIndexes)}a[d].connectionIndexes=c}return a};Gridifier.VerticalGrid.ConnectionsRanges.prototype.getAllConnectionsFromIntersectedRange=function(a){for(var b=0;b<this._ranges.length;b++){if(a>=this._ranges[b].y1&&a<=this._ranges[b].y2)return this._ranges[b].connectionIndexes}var c=function(a,b){for(var c=0;c<a.length;c++){if(a[c]==b)return true}return false};var d=[];for(var b=0;b<this._ranges.length;b++){for(var e=0;e<this._ranges[b].connectionIndexes.length;e++){if(!c(d,this._ranges[b].connectionIndexes[e]))d.push(this._ranges[b].connectionIndexes[e])}}return d};Gridifier.VerticalGrid.ConnectionsRanges.prototype.getAllConnectionsFromIntersectedAndUpperRanges=function(a){var b=[];var c=null;for(var d=this._ranges.length-1;d>=0;d--){if(a>=this._ranges[d].y1&&a<=this._ranges[d].y2){c=d;break}}if(c==null)c=this._ranges.length-1;for(var d=c;d>=0;d--){b.push(this._ranges[d].connectionIndexes)}return b};Gridifier.VerticalGrid.ConnectionsSorter=function(a,b,c){var d=this;this._connections=null;this._settings=null;this._guid=null;this._css={};this._construct=function(){d._connections=a;d._settings=b;d._guid=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ConnectionsSorter.prototype.sortConnectionsPerReappend=function(a){var b=this;if(this._settings.isDisabledSortDispersion()){a.sort(function(a,c){if(b._guid.getItemGUID(a.item)>b._guid.getItemGUID(c.item))return 1;return-1})}else if(this._settings.isCustomSortDispersion()||this._settings.isCustomAllEmptySpaceSortDispersion()){if(this._settings.isDefaultAppend()){a.sort(function(a,b){if(a.y1==b.y1){if(a.x2>b.x2)return-1;else return 1}else{if(a.y1<b.y1)return-1;else return 1}})}else if(this._settings.isReversedAppend()){a.sort(function(a,b){if(a.y1==b.y1){if(a.x1<b.x1)return-1;else return 1}else{if(a.y1<b.y1)return-1;else return 1}})}}return a};Gridifier.VerticalGrid.ConnectionsVerticalIntersector=function(a,b,c){var d=this;this._connections=null;this._settings=null;this._itemCoordsExtractor=null;this._lastRowVerticallyExpandedConnections=[];this._css={};this._construct=function(){d._connections=a;d._settings=b;d._itemCoordsExtractor=c};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ConnectionsVerticalIntersector.prototype.getLastRowVerticallyExpandedConnections=function(){return this._lastRowVerticallyExpandedConnections};Gridifier.VerticalGrid.ConnectionsVerticalIntersector.prototype.isIntersectingMoreThanOneConnectionItemVertically=function(a){var b=this;var c=this._connections.get();var d=[];
var e=function(a){if(d.length==0)return false;for(var b=0;b<d.length;b++){var e=c[d[b]];var f=a.y1<e.y1&&a.y2<e.y1;var g=a.y1>e.y1&&a.y2>e.y2;if(!f&&!g)return true}return false};var f=0;for(var g=0;g<c.length;g++){var h=c[g];var i=a.y1<h.y1&&a.y2<h.y1;var j=a.y1>h.y2&&a.y2>h.y2;if(!i&&!j&&!e(h)){d.push(g);f++}}return f>1};Gridifier.VerticalGrid.ConnectionsVerticalIntersector.prototype.getMostTallFromAllVerticallyIntersectedConnections=function(a){var b=this;var c=this._connections.get();var d=null;for(var e=0;e<c.length;e++){var f=c[e];var g=a.y1<f.y1&&a.y2<f.y1;var h=a.y1>f.y2&&a.y2>f.y2;if(!g&&!h){if(d==null)d=f;else{var i=Math.abs(f.y2-f.y1);var j=Math.abs(d.y2-d.y1);if(i>j)d=f}}}return d};Gridifier.VerticalGrid.ConnectionsVerticalIntersector.prototype.getAllVerticallyIntersectedConnections=function(a){var b=this;var c=this._connections.get();var d=[];for(var e=0;e<c.length;e++){var f=c[e];var g=a.y1<f.y1&&a.y2<f.y1;var h=a.y1>f.y2&&a.y2>f.y2;if(!g&&!h)d.push(f)}return d};Gridifier.VerticalGrid.ConnectionsVerticalIntersector.prototype.expandVerticallyAllRowConnectionsToMostTall=function(a){var b=this.getMostTallFromAllVerticallyIntersectedConnections(a);if(b==null)return;var c=this.getAllVerticallyIntersectedConnections(a);this._lastRowVerticallyExpandedConnections=c;for(var d=0;d<c.length;d++){c[d].y1=b.y1;c[d].y2=b.y2;if(this._settings.isVerticalGridTopAlignmentType())c[d].verticalOffset=0;else if(this._settings.isVerticalGridCenterAlignmentType()){var e=c[d].y1;var f=c[d].y2;var g=this._itemCoordsExtractor.getItemTargetSizes(c[d].item);var h=g.targetHeight-1;c[d].verticalOffset=Math.round(Math.abs(f-e)/2)-Math.round(h/2)}else if(this._settings.isVerticalGridBottomAlignmentType()){var e=c[d].y1;var f=c[d].y2;var g=this._itemCoordsExtractor.getItemTargetSizes(c[d].item);var h=g.targetHeight-1;c[d].verticalOffset=Math.abs(f-e)-h}}};Gridifier.VerticalGrid.ConnectorsCleaner=function(a,b,c){var d=this;this._connectors=null;this._connections=null;this._settings=null;this._connectionItemIntersectionStrategy=null;this._css={};this._construct=function(){d._connectors=a;d._connections=b;d._settings=c;if(d._settings.isDisabledSortDispersion()){d.setConnectorInsideOrBeforeItemIntersectionStrategy()}else if(d._settings.isCustomSortDispersion()||d._settings.isCustomAllEmptySpaceSortDispersion()){d.setConnectorInsideItemIntersectionStrategy()}};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){d._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES={CONNECTOR_INSIDE_CONNECTION_ITEM:0,CONNECTOR_INSIDE_OR_BEFORE_CONNECTION_ITEM:1};Gridifier.VerticalGrid.ConnectorsCleaner.MAX_VALID_VERTICAL_DISTANCE={FROM_MOST_BOTTOM_CONNECTOR:3e3,FROM_MOST_TOP_CONNECTOR:3e3};Gridifier.VerticalGrid.ConnectorsCleaner.prototype.setConnectorInsideItemIntersectionStrategy=function(){var a=Gridifier.VerticalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES;this._connectionItemIntersectionStrategy=a.CONNECTOR_INSIDE_CONNECTION_ITEM};Gridifier.VerticalGrid.ConnectorsCleaner.prototype.setConnectorInsideOrBeforeItemIntersectionStrategy=function(){var a=Gridifier.VerticalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES;this._connectionItemIntersectionStrategy=a.CONNECTOR_INSIDE_OR_BEFORE_CONNECTION_ITEM};Gridifier.VerticalGrid.ConnectorsCleaner.prototype.isConnectorInsideItemIntersectionStrategy=function(){var a=Gridifier.VerticalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES;return this._connectionItemIntersectionStrategy==a.CONNECTOR_INSIDE_CONNECTION_ITEM};Gridifier.VerticalGrid.ConnectorsCleaner.prototype.isConnectorInsideOrBeforeItemIntersectionStrategy=function(){var a=Gridifier.VerticalGrid.ConnectorsCleaner.CONNECTION_ITEM_INTERSECTION_STRATEGIES;return this._connectionItemIntersectionStrategy==a.CONNECTOR_INSIDE_OR_BEFORE_CONNECTION_ITEM};Gridifier.VerticalGrid.ConnectorsCleaner.prototype._isMappedConnectorIntersectingAnyTopConnectionItem=function(a){var b=this._connections.get();for(var c=0;c<a.connectionIndexes.length;c++){for(var d=0;d<a.connectionIndexes[c].length;d++){var e=b[a.connectionIndexes[c][d]];if(this.isConnectorInsideOrBeforeItemIntersectionStrategy())var f=a.y>=e.y1;else if(this.isConnectorInsideItemIntersectionStrategy())var f=a.y>=e.y1&&a.y<=e.y2;if(a.x>=e.x1&&a.x<=e.x2&&f)return true}}return false};Gridifier.VerticalGrid.ConnectorsCleaner.prototype.deleteAllIntersectedFromTopConnectors=function(){var a=this._connectors.get();var b=this._connectors.getClone();b.sort(function(a,b){if(a.y==b.y)return 0;else if(a.y>b.y)return-1;else return 1});b=this._connections.mapAllIntersectedAndUpperConnectionsPerEachConnector(b);for(var c=0;c<b.length;c++){if(this._isMappedConnectorIntersectingAnyTopConnectionItem(b[c]))a[b[c].connectorIndex].isIntersected=true;else a[b[c].connectorIndex].isIntersected=false}for(var c=0;c<a.length;c++){if(a[c].isIntersected){a.splice(c,1);c--}}};Gridifier.VerticalGrid.ConnectorsCleaner.prototype.deleteAllTooLowConnectorsFromMostTopConnector=function(){var a=this._connectors.get();if(a.length==0)return;var b=a[0];for(var c=1;c<a.length;c++){if(a[c].y<b.y)b=a[c]}var d=Gridifier.VerticalGrid.ConnectorsCleaner;var e=b.y+d.MAX_VALID_VERTICAL_DISTANCE.FROM_MOST_TOP_CONNECTOR;for(var c=0;c<a.length;c++){if(a[c].y>e){a.splice(c,1);c--}}};Gridifier.VerticalGrid.ConnectorsCleaner.prototype._isMappedConnectorIntersectingAnyBottomConnectionItem=function(a){var b=this._connections.get();for(var c=0;c<a.connectionIndexes.length;c++){for(var d=0;d<a.connectionIndexes[c].length;d++){var e=b[a.connectionIndexes[c][d]];if(this.isConnectorInsideOrBeforeItemIntersectionStrategy())var f=a.y<=e.y2;else if(this.isConnectorInsideItemIntersectionStrategy())var f=a.y<=e.y2&&a.y>=e.y1;if(a.x>=e.x1&&a.x<=e.x2&&f)return true}}return false};Gridifier.VerticalGrid.ConnectorsCleaner.prototype.deleteAllIntersectedFromBottomConnectors=function(){var a=this._connectors.get();var b=this._connectors.getClone();b.sort(function(a,b){if(a.y==b.y)return 0;else if(a.y<b.y)return-1;else return 1});b=this._connections.mapAllIntersectedAndLowerConnectionsPerEachConnector(b);for(var c=0;c<b.length;c++){if(this._isMappedConnectorIntersectingAnyBottomConnectionItem(b[c]))a[b[c].connectorIndex].isIntersected=true;else a[b[c].connectorIndex].isIntersected=false}for(var c=0;c<a.length;c++){if(a[c].isIntersected){a.splice(c,1);c--}}};Gridifier.VerticalGrid.ConnectorsCleaner.prototype.deleteAllTooHighConnectorsFromMostBottomConnector=function(){var a=this._connectors.get();if(a.length==0)return;var b=a[0];for(var c=1;c<a.length;c++){if(a[c].y>b.y)b=a[c]}var d=Gridifier.VerticalGrid.ConnectorsCleaner;var e=b.y-d.MAX_VALID_VERTICAL_DISTANCE.FROM_MOST_BOTTOM_CONNECTOR;for(var c=0;c<a.length;c++){if(a[c].y<e){a.splice(c,1);c--}}};Gridifier.VerticalGrid.ConnectorsSelector=function(a){var b=this;this._connectors=null;this._guid=null;this._css={};this._construct=function(){b._guid=a};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){b._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ConnectorsSelector.prototype.attachConnectors=function(a){this._connectors=a};Gridifier.VerticalGrid.ConnectorsSelector.prototype.getSelectedConnectors=function(){return this._connectors};Gridifier.VerticalGrid.ConnectorsSelector.prototype.selectOnlyMostBottomConnectorFromSide=function(a){var b=null;var c=null;var d=this._connectors.length;while(d--){if(this._connectors[d].side==a){if(b==null||this._connectors[d].y>c){b=this._connectors[d].itemGUID;c=this._connectors[d].y}}}if(b==null)return;var d=this._connectors.length;while(d--){if(this._connectors[d].side==a&&this._connectors[d].itemGUID!=b)this._connectors.splice(d,1)}};Gridifier.VerticalGrid.ConnectorsSelector.prototype.selectOnlyMostTopConnectorFromSide=function(a){var b=null;var c=null;var d=this._connectors.length;while(d--){if(this._connectors[d].side==a){if(b==null||this._connectors[d].y<c){b=this._connectors[d].itemGUID;c=this._connectors[d].y}}}if(b==null)return;var d=this._connectors.length;while(d--){if(this._connectors[d].side==a&&this._connectors[d].itemGUID!=b)this._connectors.splice(d,1)}};Gridifier.VerticalGrid.ConnectorsSorter=function(){var a=this;this._connectors=null;this._css={};this._construct=function(){};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){a._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ConnectorsSorter.prototype.attachConnectors=function(a){this._connectors=a};Gridifier.VerticalGrid.ConnectorsSorter.prototype.getConnectors=function(){return this._connectors};Gridifier.VerticalGrid.ConnectorsSorter.prototype.sortConnectorsForPrepend=function(a){var b=this;this._connectors.sort(function(b,c){if(b.y==c.y){if(a==Gridifier.PREPEND_TYPES.DEFAULT_PREPEND){if(b.x>c.x)return 1;else return-1}else if(a==Gridifier.PREPEND_TYPES.REVERSED_PREPEND){if(b.x<c.x)return 1;else return-1}}else{if(b.y<c.y)return 1;else return-1}})};Gridifier.VerticalGrid.ConnectorsSorter.prototype.sortConnectorsForAppend=function(a){var b=this;this._connectors.sort(function(b,c){if(b.y==c.y){if(a==Gridifier.APPEND_TYPES.DEFAULT_APPEND){if(b.x>c.x)return-1;else return 1}else if(a==Gridifier.APPEND_TYPES.REVERSED_APPEND){if(b.x<c.x)return-1;else return 1}}else{if(b.y<c.y)return-1;else return 1}})};Gridifier.VerticalGrid.ItemCoordsExtractor=function(a,b){var c=this;this._gridifier=null;this._sizesResolverManager=null;this._transformedItemMarker=null;this._css={};this._construct=function(){c._gridifier=a;c._sizesResolverManager=b;c._transformedItemMarker=new Gridifier.SizesTransformer.TransformedItemMarker};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){c._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ItemCoordsExtractor.prototype._getItemSizesPerAppend=function(a){if(this._transformedItemMarker.isTransformedItem(a)){var b=this._transformedItemMarker.getTransformedItemTargetPxSizes(a);return{targetWidth:parseFloat(b.targetPxWidth),targetHeight:parseFloat(b.targetPxHeight)}}else{return{targetWidth:this._sizesResolverManager.outerWidth(a,true),targetHeight:this._sizesResolverManager.outerHeight(a,true)}}};Gridifier.VerticalGrid.ItemCoordsExtractor.prototype.getItemTargetSizes=function(a){return this._getItemSizesPerAppend(a)};Gridifier.VerticalGrid.ItemCoordsExtractor.prototype.connectorToAppendedItemCoords=function(a,b){var c=this._getItemSizesPerAppend(a);return{x1:parseFloat(b.x-c.targetWidth+1),x2:parseFloat(b.x),y1:parseFloat(b.y),y2:parseFloat(b.y+c.targetHeight-1)}};Gridifier.VerticalGrid.ItemCoordsExtractor.prototype.connectorToReversedAppendedItemCoords=function(a,b){var c=this._getItemSizesPerAppend(a);return{x1:parseFloat(b.x),x2:parseFloat(b.x+c.targetWidth-1),y1:parseFloat(b.y),y2:parseFloat(b.y+c.targetHeight-1)}};Gridifier.VerticalGrid.ItemCoordsExtractor.prototype.connectorToPrependedItemCoords=function(a,b){var c=this._getItemSizesPerAppend(a);return{x1:parseFloat(b.x),x2:parseFloat(b.x+c.targetWidth-1),y1:parseFloat(b.y-c.targetHeight+1),y2:parseFloat(b.y)}};Gridifier.VerticalGrid.ItemCoordsExtractor.prototype.connectorToReversedPrependedItemCoords=function(a,b){var c=this._getItemSizesPerAppend(a);return{x1:parseFloat(b.x-c.targetWidth+1),x2:parseFloat(b.x),y1:parseFloat(b.y-c.targetHeight+1),y2:parseFloat(b.y)}};Gridifier.VerticalGrid.Prepender=function(a,b,c,d,e,f,g,h,i){var j=this;this._gridifier=null;this._settings=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectorsCleaner=null;this._connectorsShifter=null;this._connectorsSelector=null;this._connectorsSorter=null;this._itemCoordsExtractor=null;this._connectionsIntersector=null;this._guid=null;this._renderer=null;this._normalizer=null;this._operation=null;this._css={};this._construct=function(){j._gridifier=a;j._settings=b;j._sizesResolverManager=c;j._connectors=d;j._connections=e;j._connectorsCleaner=new Gridifier.VerticalGrid.ConnectorsCleaner(j._connectors,j._connections,j._settings);j._connectorsShifter=new Gridifier.ConnectorsShifter(j._gridifier,j._connections,j._settings);j._connectorsSelector=new Gridifier.VerticalGrid.ConnectorsSelector(j._guid);j._connectorsSorter=new Gridifier.VerticalGrid.ConnectorsSorter;j._itemCoordsExtractor=new Gridifier.VerticalGrid.ItemCoordsExtractor(j._gridifier,j._sizesResolverManager);j._connectionsIntersector=new Gridifier.VerticalGrid.ConnectionsIntersector(j._connections);j._guid=f;j._renderer=g;j._normalizer=h;j._operation=i};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){j._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.Prepender.prototype.prepend=function(a){this._initConnectors();var b=this._createConnectionPerItem(a);var c=this._connections.normalizeVerticalPositionsOfAllConnectionsAfterPrepend(b,this._connectors.get());this._connections.attachConnectionToRanges(b);this._connectorsCleaner.deleteAllTooLowConnectorsFromMostTopConnector();this._connectorsCleaner.deleteAllIntersectedFromTopConnectors();if(c){this._renderer.renderConnections(this._connections.get(),[b])}if(this._settings.isDefaultIntersectionStrategy())this._renderer.showConnections(b);else if(this._settings.isNoIntersectionsStrategy()){var d=this._connections.getLastRowVerticallyExpandedConnections();for(var e=0;e<d.length;e++){if(d[e].itemGUID==b.itemGUID){d.splice(e,1);e--}}this._renderer.renderConnections(d);this._renderer.showConnections(b)}};Gridifier.VerticalGrid.Prepender.prototype._initConnectors=function(){if(this._operation.isInitialOperation(Gridifier.OPERATIONS.PREPEND)){this.createInitialConnector();return}if(!this._operation.isCurrentOperationSameAsPrevious(Gridifier.OPERATIONS.PREPEND)){this.recreateConnectorsPerAllConnectedItems();this._connectorsCleaner.deleteAllIntersectedFromTopConnectors();this._connectorsCleaner.deleteAllTooLowConnectorsFromMostTopConnector()}};Gridifier.VerticalGrid.Prepender.prototype.createInitialConnector=function(){this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.RIGHT.BOTTOM,0,0)};Gridifier.VerticalGrid.Prepender.prototype.recreateConnectorsPerAllConnectedItems=function(){this._connectors.flush();var a=this._connections.get();for(var b=0;b<a.length;b++){this._addItemConnectors(a[b],a[b].itemGUID)}if(this._connectors.count()==0)this.createInitialConnector()};Gridifier.VerticalGrid.Prepender.prototype._addItemConnectors=function(a,b){if(a.x2+1<=this._gridifier.getGridX2()){this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.RIGHT.BOTTOM,parseFloat(a.x2+1),parseFloat(a.y2),Dom.toInt(b))}this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.TOP.LEFT,parseFloat(a.x1),parseFloat(a.y1-1),Dom.toInt(b))};Gridifier.VerticalGrid.Prepender.prototype._createConnectionPerItem=function(a){var b=this._filterConnectorsPerNextConnection();var c=this._findItemConnectionCoords(a,b);var d=this._connections.add(a,c);if(this._settings.isNoIntersectionsStrategy()){this._connections.expandVerticallyAllRowConnectionsToMostTall(d)}this._addItemConnectors(c,this._guid.getItemGUID(a));return d};Gridifier.VerticalGrid.Prepender.prototype._filterConnectorsPerNextConnection=function(){var a=this._connectors.getClone();if(this._settings.isDefaultIntersectionStrategy()){this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllConnectors();a=this._connectorsShifter.getAllConnectors()}else if(this._settings.isNoIntersectionsStrategy()){var b=Gridifier.Connectors.SIDES.TOP.LEFT;this._connectorsSelector.attachConnectors(a);this._connectorsSelector.selectOnlyMostTopConnectorFromSide(b);a=this._connectorsSelector.getSelectedConnectors();this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllWithSpecifiedSideToLeftGridCorner(b);a=this._connectorsShifter.getAllConnectors()}this._connectorsSorter.attachConnectors(a);this._connectorsSorter.sortConnectorsForPrepend(Gridifier.PREPEND_TYPES.DEFAULT_PREPEND);return this._connectorsSorter.getConnectors()};Gridifier.VerticalGrid.Prepender.prototype._findItemConnectionCoords=function(a,b){var c=null;for(var d=0;d<b.length;d++){var e=this._itemCoordsExtractor.connectorToPrependedItemCoords(a,b[d]);if(e.x2>this._normalizer.normalizeHighRounding(this._gridifier.getGridX2())){continue}var f=this._connectionsIntersector.findAllMaybeIntersectableConnectionsOnPrepend(b[d]);if(this._connectionsIntersector.isIntersectingAnyConnection(f,e)){continue}c=e;var g=this._connections.getAllConnectionsAboveY(e.y1);if(this._connections.isAnyConnectionItemGUIDBiggerThan(g,a)){continue}if(this._settings.isNoIntersectionsStrategy()){if(this._connections.isIntersectingMoreThanOneConnectionItemVertically(c)){c=null}}if(c!=null){break}}return c};Gridifier.VerticalGrid.ReversedAppender=function(a,b,c,d,e,f,g,h,i){var j=this;this._gridifier=null;this._settings=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectorsCleaner=null;this._connectorsShifter=null;this._connectorsSelector=null;this._connectorsSorter=null;this._itemCoordsExtractor=null;this._connectionsIntersector=null;this._guid=null;this._renderer=null;this._normalizer=null;this._operation=null;this._css={};this._construct=function(){j._gridifier=a;j._settings=b;j._sizesResolverManager=c;j._connectors=d;j._connections=e;j._connectorsCleaner=new Gridifier.VerticalGrid.ConnectorsCleaner(j._connectors,j._connections,j._settings);j._connectorsShifter=new Gridifier.ConnectorsShifter(j._gridifier,j._connections,j._settings);j._connectorsSelector=new Gridifier.VerticalGrid.ConnectorsSelector(j._guid);j._connectorsSorter=new Gridifier.VerticalGrid.ConnectorsSorter;j._itemCoordsExtractor=new Gridifier.VerticalGrid.ItemCoordsExtractor(j._gridifier,j._sizesResolverManager);j._connectionsIntersector=new Gridifier.VerticalGrid.ConnectionsIntersector(j._connections);j._guid=f;j._renderer=g;j._normalizer=h;j._operation=i};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){j._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ReversedAppender.prototype.reversedAppend=function(a){this._initConnectors();var b=this._createConnectionPerItem(a);this._connections.attachConnectionToRanges(b);this._connectorsCleaner.deleteAllTooHighConnectorsFromMostBottomConnector();this._connectorsCleaner.deleteAllIntersectedFromBottomConnectors();if(this._settings.isDefaultIntersectionStrategy())this._renderer.showConnections(b);else if(this._settings.isNoIntersectionsStrategy()){var c=this._connections.getLastRowVerticallyExpandedConnections();for(var d=0;d<c.length;d++){if(c[d].itemGUID==b.itemGUID){c.splice(d,1);d--}}this._renderer.renderConnections(c);this._renderer.showConnections(b)}};Gridifier.VerticalGrid.ReversedAppender.prototype._initConnectors=function(){if(this._operation.isInitialOperation(Gridifier.OPERATIONS.REVERSED_APPEND)){this.createInitialConnector();return}if(!this._operation.isCurrentOperationSameAsPrevious(Gridifier.OPERATIONS.REVERSED_APPEND)){this.recreateConnectorsPerAllConnectedItems();this._connectorsCleaner.deleteAllIntersectedFromBottomConnectors();this._connectorsCleaner.deleteAllTooHighConnectorsFromMostBottomConnector()}};Gridifier.VerticalGrid.ReversedAppender.prototype.createInitialConnector=function(){this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.RIGHT.TOP,0,0)};Gridifier.VerticalGrid.ReversedAppender.prototype.recreateConnectorsPerAllConnectedItems=function(){this._connectors.flush();var a=this._connections.get();for(var b=0;b<a.length;b++){this._addItemConnectors(a[b],a[b].itemGUID)}if(this._connectors.count()==0)this.createInitialConnector()};Gridifier.VerticalGrid.ReversedAppender.prototype._addItemConnectors=function(a,b){if(a.x2+1<=this._gridifier.getGridX2()){this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.RIGHT.TOP,parseFloat(a.x2+1),parseFloat(a.y1),Dom.toInt(b))}this._connectors.addAppendConnector(Gridifier.Connectors.SIDES.BOTTOM.LEFT,parseFloat(a.x1),parseFloat(a.y2+1),Dom.toInt(b))};Gridifier.VerticalGrid.ReversedAppender.prototype._createConnectionPerItem=function(a){var b=this._filterConnectorsPerNextConnection();var c=this._findItemConnectionCoords(a,b);var d=this._connections.add(a,c);if(this._settings.isNoIntersectionsStrategy()){this._connections.expandVerticallyAllRowConnectionsToMostTall(d)}this._addItemConnectors(c,this._guid.getItemGUID(a));return d};Gridifier.VerticalGrid.ReversedAppender.prototype._filterConnectorsPerNextConnection=function(){var a=this._connectors.getClone();if(this._settings.isDefaultIntersectionStrategy()){this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllConnectors();a=this._connectorsShifter.getAllConnectors()}else if(this._settings.isNoIntersectionsStrategy()){var b=Gridifier.Connectors.SIDES.BOTTOM.LEFT;this._connectorsSelector.attachConnectors(a);this._connectorsSelector.selectOnlyMostBottomConnectorFromSide(b);a=this._connectorsSelector.getSelectedConnectors();this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllWithSpecifiedSideToLeftGridCorner(b);a=this._connectorsShifter.getAllConnectors()}this._connectorsSorter.attachConnectors(a);this._connectorsSorter.sortConnectorsForAppend(Gridifier.APPEND_TYPES.REVERSED_APPEND);return this._connectorsSorter.getConnectors()};Gridifier.VerticalGrid.ReversedAppender.prototype._findItemConnectionCoords=function(a,b){var c=null;for(var d=0;d<b.length;d++){var e=this._itemCoordsExtractor.connectorToReversedAppendedItemCoords(a,b[d]);if(e.x2>this._normalizer.normalizeHighRounding(this._gridifier.getGridX2())){continue}var f=this._connectionsIntersector.findAllMaybeIntersectableConnectionsOnAppend(b[d]);if(this._connectionsIntersector.isIntersectingAnyConnection(f,e)){continue}c=e;var g=this._connections.getAllConnectionsBelowY(e.y2);if(this._connections.isAnyConnectionItemGUIDSmallerThan(g,a)){continue}if(this._settings.isNoIntersectionsStrategy()){if(this._connections.isIntersectingMoreThanOneConnectionItemVertically(c)){c=null}}if(c!=null){break}}return c};Gridifier.VerticalGrid.ReversedPrepender=function(a,b,c,d,e,f,g,h,i){var j=this;this._gridifier=null;this._settings=null;this._sizesResolverManager=null;this._connectors=null;this._connections=null;this._connectorsCleaner=null;this._connectorsShifter=null;this._connectorsSelector=null;this._connectorsSorter=null;this._itemCoordsExtractor=null;this._connectionsIntersector=null;this._guid=null;this._renderer=null;this._normalizer=null;this._operation=null;this._css={};this._construct=function(){j._gridifier=a;j._settings=b;j._sizesResolverManager=c;j._connectors=d;j._connections=e;j._connectorsCleaner=new Gridifier.VerticalGrid.ConnectorsCleaner(j._connectors,j._connections,j._settings);j._connectorsShifter=new Gridifier.ConnectorsShifter(j._gridifier,j._connections,j._settings);j._connectorsSelector=new Gridifier.VerticalGrid.ConnectorsSelector(j._guid);j._connectorsSorter=new Gridifier.VerticalGrid.ConnectorsSorter;j._itemCoordsExtractor=new Gridifier.VerticalGrid.ItemCoordsExtractor(j._gridifier,j._sizesResolverManager);j._connectionsIntersector=new Gridifier.VerticalGrid.ConnectionsIntersector(j._connections);j._guid=f;j._renderer=g;j._normalizer=h;j._operation=i};this._bindEvents=function(){};this._unbindEvents=function(){};this.destruct=function(){j._unbindEvents()};this._construct();return this};Gridifier.VerticalGrid.ReversedPrepender.prototype.reversedPrepend=function(a){this._initConnectors();var b=this._createConnectionPerItem(a);var c=this._connections.normalizeVerticalPositionsOfAllConnectionsAfterPrepend(b,this._connectors.get());this._connections.attachConnectionToRanges(b);this._connectorsCleaner.deleteAllTooLowConnectorsFromMostTopConnector();this._connectorsCleaner.deleteAllIntersectedFromTopConnectors();if(c){this._renderer.renderConnections(this._connections.get(),[b])}if(this._settings.isDefaultIntersectionStrategy())this._renderer.showConnections(b);else if(this._settings.isNoIntersectionsStrategy()){var d=this._connections.getLastRowVerticallyExpandedConnections();for(var e=0;e<d.length;e++){if(d[e].itemGUID==b.itemGUID){d.splice(e,1);e--}}this._renderer.renderConnections(d);this._renderer.showConnections(b)}};Gridifier.VerticalGrid.ReversedPrepender.prototype._initConnectors=function(){if(this._operation.isInitialOperation(Gridifier.OPERATIONS.REVERSED_PREPEND)){this.createInitialConnector();return}if(!this._operation.isCurrentOperationSameAsPrevious(Gridifier.OPERATIONS.REVERSED_PREPEND)){this.recreateConnectorsPerAllConnectedItems();this._connectorsCleaner.deleteAllIntersectedFromTopConnectors();this._connectorsCleaner.deleteAllTooLowConnectorsFromMostTopConnector()}};Gridifier.VerticalGrid.ReversedPrepender.prototype.createInitialConnector=function(){this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.LEFT.BOTTOM,this._gridifier.getGridX2(),0)};Gridifier.VerticalGrid.ReversedPrepender.prototype.recreateConnectorsPerAllConnectedItems=function(){this._connectors.flush();var a=this._connections.get();for(var b=0;b<a.length;b++){this._addItemConnectors(a[b],a[b].itemGUID)}if(this._connectors.count()==0)this.createInitialConnector()};Gridifier.VerticalGrid.ReversedPrepender.prototype._addItemConnectors=function(a,b){if(a.x1-1>=0){this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.LEFT.BOTTOM,parseFloat(a.x1-1),parseFloat(a.y2),Dom.toInt(b))}this._connectors.addPrependConnector(Gridifier.Connectors.SIDES.TOP.RIGHT,parseFloat(a.x2),parseFloat(a.y1-1),Dom.toInt(b))};Gridifier.VerticalGrid.ReversedPrepender.prototype._createConnectionPerItem=function(a){var b=this._filterConnectorsPerNextConnection();var c=this._findItemConnectionCoords(a,b);var d=this._connections.add(a,c);if(this._settings.isNoIntersectionsStrategy()){this._connections.expandVerticallyAllRowConnectionsToMostTall(d)}this._addItemConnectors(c,this._guid.getItemGUID(a));return d};Gridifier.VerticalGrid.ReversedPrepender.prototype._filterConnectorsPerNextConnection=function(){var a=this._connectors.getClone();if(this._settings.isDefaultIntersectionStrategy()){this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllConnectors();a=this._connectorsShifter.getAllConnectors()}else if(this._settings.isNoIntersectionsStrategy()){var b=Gridifier.Connectors.SIDES.TOP.RIGHT;this._connectorsSelector.attachConnectors(a);this._connectorsSelector.selectOnlyMostTopConnectorFromSide(b);a=this._connectorsSelector.getSelectedConnectors();this._connectorsShifter.attachConnectors(a);this._connectorsShifter.shiftAllWithSpecifiedSideToRightGridCorner(b);a=this._connectorsShifter.getAllConnectors()}this._connectorsSorter.attachConnectors(a);this._connectorsSorter.sortConnectorsForPrepend(Gridifier.PREPEND_TYPES.REVERSED_PREPEND);return this._connectorsSorter.getConnectors()};Gridifier.VerticalGrid.ReversedPrepender.prototype._findItemConnectionCoords=function(a,b){var c=null;for(var d=0;d<b.length;d++){var e=this._itemCoordsExtractor.connectorToReversedPrependedItemCoords(a,b[d]);if(e.x1<this._normalizer.normalizeLowRounding(0)){continue}var f=this._connectionsIntersector.findAllMaybeIntersectableConnectionsOnPrepend(b[d]);if(this._connectionsIntersector.isIntersectingAnyConnection(f,e)){continue}c=e;var g=this._connections.getAllConnectionsAboveY(e.y1);if(this._connections.isAnyConnectionItemGUIDBiggerThan(g,a)){continue}if(this._settings.isNoIntersectionsStrategy()){if(this._connections.isIntersectingMoreThanOneConnectionItemVertically(c)){c=null}}if(c!=null){break}}return c};